(function(){window.API_VERSION_holodilnik='v2.7.2';})();function insIsLocalStorageSupported(){var insider='insider';try{localStorage.setItem(insider,insider);localStorage.removeItem(insider);return true;}catch(e){return false;}}
if(!insIsLocalStorageSupported()&&typeof console.log!=='undefined'){console.log('LocalStorage Support is not supported. API will not initialize.');}
else if(spApi===undefined){var spApi={};spApi.loadScript=function(url,callback){var script=document.createElement('script')
script.type='text/javascript';script.async='async';if(script.readyState){script.onreadystatechange=function(){if(script.readyState=='loaded'||script.readyState=='complete'){script.onreadystatechange=null;if('function'===typeof callback){callback();}}};}else{script.addEventListener('load',function(){if('function'===typeof callback){callback();}});}
script.src=url;document.getElementsByTagName('head')[0].appendChild(script);};var sQuery;var protocol='';function insiderMain(){var NO_JQUERY={};(function(a,b,c){if(!("console"in a)){var d=a.console={};d.log=d.warn=d.error=d.debug=function(){}}if(b===NO_JQUERY){b={fn:{},extend:function(){var a=arguments[0];for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b];for(var e in d){a[e]=d[e]}}return a}}}b.fn.pm=function(){return this};b.pm=a.pm=function(a){e.send(a)};b.pm.bind=a.pm.bind=function(a,b,c,d,f){e.bind(a,b,c,d,f===true)};b.pm.unbind=a.pm.unbind=function(a,b){e.unbind(a,b)};b.pm.origin=a.pm.origin=null;b.pm.poll=a.pm.poll=200;var e={send:function(a){var c=b.extend({},e.defaults,a),d=c.target;if(!c.target){return}if(!c.type){return}var f={data:c.data,type:c.type};if(c.success){f.callback=e._callback(c.success)}if(c.error){f.errback=e._callback(c.error)}if("postMessage"in d&&!c.hash){e._bind();d.postMessage(sQuery.toJSON(f),c.origin||"*")}else{e.hash._bind();e.hash.send(c,f)}},bind:function(a,b,c,d,f){e._replyBind(a,b,c,d,f)},_replyBind:function(c,d,f,g,h){if("postMessage"in a&&!g){e._bind()}else{e.hash._bind()}var i=e.data("listeners.postmessage");if(!i){i={};e.data("listeners.postmessage",i)}var j=i[c];if(!j){j=[];i[c]=j}j.push({fn:d,callback:h,origin:f||b.pm.origin})},unbind:function(a,b){var c=e.data("listeners.postmessage");if(c){if(a){if(b){var d=c[a];if(d){var f=[];for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i.fn!==b){f.push(i)}}c[a]=f}}else{delete c[a]}}else{for(var g in c){delete c[g]}}}},data:function(a,b){if(b===c){return e._data[a]}e._data[a]=b;return b},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){var a=[];for(var b=0;b<32;b++){a[b]=e._CHARS[0|Math.random()*32]}return a.join("")},_callback:function(a){var b=e.data("callbacks.postmessage");if(!b){b={};e.data("callbacks.postmessage",b)}var c=e._random();b[c]=a;return c},_bind:function(){if(!e.data("listening.postmessage")){if(a.addEventListener){a.addEventListener("message",e._dispatch,false)}else if(a.attachEvent){a.attachEvent("onmessage",e._dispatch)}e.data("listening.postmessage",1)}},_dispatch:function(a){try{if(!a.data){return}var b=sQuery.evalJSON(a.data)}catch(c){return}if(!b.type){return}var d=e.data("callbacks.postmessage")||{},f=d[b.type];if(f){f(b.data)}else{var g=e.data("listeners.postmessage")||{};var h=g[b.type]||[];for(var i=0,j=h.length;i<j;i++){var k=h[i];if(k.origin&&k.origin!=="*"&&a.origin!==k.origin){if(b.errback){var l={message:"postmessage origin mismatch",origin:[a.origin,k.origin]};e.send({target:a.source,data:l,type:b.errback})}continue}function m(c){if(b.callback){e.send({target:a.source,data:c,type:b.callback})}}try{if(k.callback){k.fn(b.data,m,a)}else{m(k.fn(b.data,a))}}catch(c){if(b.errback){e.send({target:a.source,data:c,type:b.errback})}else{throw c}}}}}};e.hash={send:function(b,c){var d=b.target,f=b.url;if(!f){return}f=e.hash._url(f);var g,h=e.hash._url(a.location.href);if(a==d.parent){g="parent"}else{try{for(var i=0,j=parent.frames.length;i<j;i++){var k=parent.frames[i];if(k==a){g=i;break}}}catch(l){g=a.name}}if(g==null){return}var m={"x-requested-with":"postmessage",source:{name:g,url:h},postmessage:c};var n="#x-postmessage-id="+e._random();d.location=f+n+encodeURIComponent(sQuery.toJSON(m))},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:"#x-postmessage-id=".length+32,_bind:function(){if(!e.data("polling.postmessage")){setInterval(function(){var b=""+a.location.hash,c=e.hash._regex.exec(b);if(c){var d=c[1];if(e.hash._last!==d){e.hash._last=d;e.hash._dispatch(b.substring(e.hash._regex_len))}}},b.pm.poll||200);e.data("polling.postmessage",1)}},_dispatch:function(b){if(!b){return}try{b=sQuery.evalJSON(decodeURIComponent(b));if(!(b["x-requested-with"]==="postmessage"&&b.source&&b.source.name!=null&&b.source.url&&b.postmessage)){return}}catch(c){return}var d=b.postmessage,f=e.data("callbacks.postmessage")||{},g=f[d.type];if(g){g(d.data)}else{var h;if(b.source.name==="parent"){h=a.parent}else{h=a.frames[b.source.name]}var i=e.data("listeners.postmessage")||{};var j=i[d.type]||[];for(var k=0,l=j.length;k<l;k++){var m=j[k];if(m.origin){var n=/https?\:\/\/[^\/]*/.exec(b.source.url)[0];if(m.origin!=="*"&&n!==m.origin){if(d.errback){var o={message:"postmessage origin mismatch",origin:[n,m.origin]};e.send({target:h,data:o,type:d.errback,hash:true,url:b.source.url})}continue}}function p(a){if(d.callback){e.send({target:h,data:a,type:d.callback,hash:true,url:b.source.url})}}try{if(m.callback){m.fn(d.data,p)}else{p(m.fn(d.data))}}catch(c){if(d.errback){e.send({target:h,data:c,type:d.errback,hash:true,url:b.source.url})}else{throw c}}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}};b.extend(e,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:false}})})(this,typeof sQuery==="undefined"?NO_JQUERY:sQuery);(function(a){a.cookie=function(b,c,d){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(c))||c===null||c===undefined)){d=a.extend({},d);if(c===null||c===undefined){d.expires=-1}if(typeof d.expires==="number"){var e=d.expires,f=d.expires=new Date;f.setDate(f.getDate()+e)}c=String(c);return document.cookie=[encodeURIComponent(b),"=",d.raw?c:encodeURIComponent(c),d.expires?"; expires="+d.expires.toUTCString():"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",";"+(window.location.href.split('/')[0]==="https:"?" SameSite=None; Secure":"")].join("")}d=c||{};var g=d.raw?function(a){return a}:decodeURIComponent;var h=document.cookie.split("; ");for(var i=0,j;j="undefined"!==typeof h[i]&&h[i].split("=");i++){if(g(j[0])===b)return g(j[1]||"")}return null}})(sQuery);(function($){'use strict';var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON==='object'&&JSON.stringify?JSON.stringify:function(o){if(o===null){return'null';}var pairs,k,name,val,type=$.type(o);if(type==='undefined'){return undefined;}if(type==='number'||type==='boolean'){return String(o);}if(type==='string'){return $.quoteString(o);}if(typeof o.toJSON==='function'){return $.toJSON(o.toJSON());}if(type==='date'){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month='0'+month;}
if(day<10){day='0'+day;}if(hours<10){hours='0'+hours;}if(minutes<10){minutes='0'+minutes;}if(seconds<10){seconds='0'+seconds;}if(milli<100){milli='0'+milli;}if(milli<10){milli='0'+milli;}return'"'+year+'-'+month+'-'+day+'T'+
hours+':'+minutes+':'+seconds+'.'+milli+'Z"';}pairs=[];if($.isArray(o)){for(k=0;k<o.length;k++){pairs.push($.toJSON(o[k])||'null');}
return'['+pairs.join(',')+']';}if(typeof o==='object'){for(k in o){if(hasOwn.call(o,k)){type=typeof k;if(type==='number'){name='"'+k+'"';}else if(type==='string'){name=$.quoteString(k);}else{continue;}type=typeof o[k];if(type!=='function'&&type!=='undefined'){val=$.toJSON(o[k]);pairs.push(name+':'+val);}}}return'{'+pairs.join(',')+'}';}};$.evalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(str){return eval('('+str+')');};$.secureEvalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered)){return eval('('+str+')');}throw new SyntaxError('Error parsing JSON, source is not valid.');};$.quoteString=function(str){if(str.match(escape)){return'"'+str.replace(escape,function(a){var c=meta[a];if(typeof c==='string'){return c;}c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}return'"'+str+'"';};}(sQuery));(function(s,l,d,t){var m=d(s),q=d(l),a=d.fancybox=function(){a.open.apply(this,arguments)},u=!1,k=l.createTouch!==t,o=function(a){return"string"===d.type(a)},n=function(b,c){c&&o(b)&&0<b.indexOf("%")&&(b=a.getViewport()[c]/100*parseInt(b,10));return Math.round(b)+"px"};d.extend(a,{version:"2.0.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,autoSize:!0,autoResize:!k,autoCenter:!k,fitToView:!0,aspectRatio:!1,topRatio:0.5,fixed:!1,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3E3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},keys:{next:[13,32,34,39,40],prev:[8,33,37,38],close:[27]},tpl:{wrap:'<div class="sp-fancybox-wrap"><div class="sp-fancybox-skin"><div class="sp-fancybox-outer"><div class="sp-fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe class="sp-fancybox-iframe" name="fancybox-frame{rnd}" frameborder="0" hspace="0"'+
(d.browser.msie?' allowtransparency="true"':"")+"></iframe>",swf:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="wmode" value="transparent" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{href}" /><embed src="{href}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="100%" height="100%" wmode="transparent"></embed></object>',error:'<p class="sp-fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<div title="Close" class="sp-fancybox-item sp-fancybox-close"></div>',next:'<a title="Next" class="sp-fancybox-nav sp-fancybox-next"><span></span></a>',prev:'<a title="Previous" class="sp-fancybox-nav sp-fancybox-prev"><span></span></a>'},openEffect:"fade",openSpeed:300,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:300,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:300,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:300,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:{speedIn:0,speedOut:300,opacity:0.8,css:{cursor:"pointer"},closeClick:!0},title:{type:"float"}}},group:{},opts:{},coming:null,current:null,isOpen:!1,isOpened:!1,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(b,c){a.close(!0);b&&!d.isArray(b)&&(b=b instanceof d?d(b).get():[b]);a.isActive=!0;a.opts=d.extend(!0,{},a.defaults,c);d.isPlainObject(c)&&c.keys!==t&&(a.opts.keys=c.keys?d.extend({},a.defaults.keys,c.keys):!1);a.group=b;a._start(a.opts.index||0)},cancel:function(){a.coming&&!1===a.trigger("onCancel")||(a.coming=null,a.hideLoading(),a.ajaxLoad&&a.ajaxLoad.abort(),a.ajaxLoad=null,a.imgPreload&&(a.imgPreload.onload=a.imgPreload.onabort=a.imgPreload.onerror=null))},close:function(b){a.cancel();a.current&&!1!==a.trigger("beforeClose")&&(a.unbindEvents(),!a.isOpen||b&&!0===b[0]?(d(".sp-fancybox-wrap").stop().trigger("onReset").remove(),a._afterZoomOut()):(a.isOpen=a.isOpened=!1,d(".sp-fancybox-item, .sp-fancybox-nav").remove(),a.wrap.stop(!0).removeClass("sp-fancybox-opened"),a.inner.css("overflow","hidden"),a.transitions[a.current.closeMethod]()))},play:function(b){var c=function(){clearTimeout(a.player.timer)},e=function(){c();a.current&&a.player.isActive&&(a.player.timer=setTimeout(a.next,a.current.playSpeed))},f=function(){c();d("body").unbind(".player");a.player.isActive=!1;a.trigger("onPlayEnd")};if(a.player.isActive||b&&!1===b[0])f();else if(a.current&&(a.current.loop||a.current.index<a.group.length-1))a.player.isActive=!0,d("body").bind({"afterShow.player onUpdate.player":e,"onCancel.player beforeClose.player":f,"beforeLoad.player":c}),e(),a.trigger("onPlayStart")},next:function(){a.current&&a.jumpto(a.current.index+1)},prev:function(){a.current&&a.jumpto(a.current.index-1)},jumpto:function(b){a.current&&(b=parseInt(b,10),1<a.group.length&&a.current.loop&&(b>=a.group.length?b=0:0>b&&(b=a.group.length-1)),a.group[b]!==t&&(a.cancel(),a._start(b)))},reposition:function(b,c){var e;a.isOpen&&(e=a._getPosition(c),b&&"scroll"===b.type?(delete e.position,a.wrap.stop(!0,!0).animate(e,200)):a.wrap.css(e))},update:function(b){a.isOpen&&(u||setTimeout(function(){var c=a.current,e=!b||b&&"orientationchange"===b.type;if(u&&(u=!1,c)){if(!b||"scroll"!==b.type||e)c.autoSize&&"iframe"!==c.type&&(a.inner.height("auto"),c.height=a.inner.height()),(c.autoResize||e)&&a._setDimension(),c.canGrow&&"iframe"!==c.type&&a.inner.height("auto");(c.autoCenter||e)&&a.reposition(b);a.trigger("onUpdate")}},200),u=!0)},toggle:function(){a.isOpen&&(a.current.fitToView=!a.current.fitToView,a.update())},hideLoading:function(){q.unbind("keypress.fb");d("#sp-fancybox-loading").remove()},showLoading:function(){a.hideLoading();q.bind("keypress.fb",function(b){27===b.keyCode&&(b.preventDefault(),a.cancel())});d('<div id="sp-fancybox-loading"><div></div></div>').click(a.cancel).appendTo("body")},getViewport:function(){return{x:m.scrollLeft(),y:m.scrollTop(),w:k&&s.innerWidth?s.innerWidth:m.width(),h:k&&s.innerHeight?s.innerHeight:m.height()}},unbindEvents:function(){if(a.wrap!=null&&typeof a.wrap!="undefined"&&typeof a.wrap.unbind!="undefined"){a.wrap.unbind(".fb");}},bindEvents:function(){var b=a.current,c=b.keys;b&&(m.bind("resize.fb orientationchange.fb"+(b.autoCenter&&!b.fixed?" scroll.fb":""),a.update),c&&q.bind("keydown.fb",function(b){var f;f=b.target||b.srcElement;if(!b.ctrlKey&&!b.altKey&&!b.shiftKey&&!b.metaKey&&(!f||!f.type&&!d(f).is("[contenteditable]")))f=b.keyCode,-1<d.inArray(f,c.close)?(a.close(),b.preventDefault()):-1<d.inArray(f,c.next)?(a.next(),b.preventDefault()):-1<d.inArray(f,c.prev)&&(a.prev(),b.preventDefault())}),d.fn.mousewheel&&b.mouseWheel&&1<a.group.length&&a.wrap.bind("mousewheel.fb",function(b,c){var d=b.target||null;if(0!==c&&(!d||0===d.clientHeight||d.scrollHeight===d.clientHeight&&d.scrollWidth===d.clientWidth))b.preventDefault(),a[0<c?"prev":"next"]()}))},trigger:function(b,c){var e,f=c||a[-1<d.inArray(b,["onCancel","beforeLoad","afterLoad"])?"coming":"current"];if(f){d.isFunction(f[b])&&(e=f[b].apply(f,Array.prototype.slice.call(arguments,1)));if(!1===e)return!1;f.helpers&&d.each(f.helpers,function(c,e){if(e&&d.isPlainObject(a.helpers[c])&&d.isFunction(a.helpers[c][b]))a.helpers[c][b](e,f)});d.event.trigger(b+".fb")}},isImage:function(a){return o(a)&&a.match(/\.(jpe?g|gif|png|bmp)((\?|#).*)?$/i)},isSWF:function(a){return o(a)&&a.match(/\.(swf)((\?|#).*)?$/i)},_start:function(b){var c={},e=a.group[b]||null,f,g,i;if(e&&(e.nodeType||e instanceof d))f=!0,d.metadata&&(c=d(e).metadata());c=d.extend(!0,{},a.opts,{index:b,element:e},d.isPlainObject(e)?e:c);d.each(["href","title","content","type"],function(b,g){c[g]=a.opts[g]||f&&d(e).attr(g)||c[g]||null});"number"===typeof c.margin&&(c.margin=[c.margin,c.margin,c.margin,c.margin]);c.modal&&d.extend(!0,c,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{css:{cursor:"auto"},closeClick:!1}}});a.coming=c;if(!1===a.trigger("beforeLoad"))a.coming=null;else{g=c.type;b=c.href||e;g||(f&&(g=d(e).data("sp-fancybox-type"),g||(g=(g=e.className.match(/fancybox\.(\w+)/))?g[1]:null)),!g&&o(b)&&(a.isImage(b)?g="image":a.isSWF(b)?g="swf":b.match(/^#/)&&(g="inline")),g||(g=f?"inline":"html"),c.type=g);if("inline"===g||"html"===g){if(c.content||(c.content="inline"===g?d(o(b)?b.replace(/.*(?=#[^\s]+$)/,""):b):e),!c.content||!c.content.length)g=null}else b||(g=null);"ajax"===g&&o(b)&&(i=b.split(/\s+/,2),b=i.shift(),c.selector=i.shift());c.href=b;c.group=a.group;c.isDom=f;switch(g){case"image":a._loadImage();break;case"ajax":a._loadAjax();break;case"inline":case"iframe":case"swf":case"html":a._afterLoad();break;default:a._error("type")}}},_error:function(b){a.hideLoading();d.extend(a.coming,{type:"html",autoSize:!0,minWidth:0,minHeight:0,padding:15,hasError:b,content:a.coming.tpl.error});a._afterLoad()},_loadImage:function(){var b=a.imgPreload=new Image;b.onload=function(){this.onload=this.onerror=null;a.coming.width=this.width;a.coming.height=this.height;a._afterLoad()};b.onerror=function(){this.onload=this.onerror=null;a._error("image")};b.src=a.coming.href;(b.complete===t||!b.complete)&&a.showLoading()},_loadAjax:function(){a.showLoading();a.ajaxLoad=d.ajax(d.extend({},a.coming.ajax,{url:a.coming.href,error:function(b,c){a.coming&&"abort"!==c?a._error("ajax",b):a.hideLoading()},success:function(b,c){"success"===c&&(a.coming.content=b,a._afterLoad())}}))},_preloadImages:function(){var b=a.group,c=a.current,e=b.length,f,g,i,h=Math.min(c.preload,e-1);if(c.preload&&!(2>b.length))for(i=1;i<=h;i+=1)if(f=b[(c.index+i)%e],g=f.href||d(f).attr("href")||f,"image"===f.type||a.isImage(g))(new Image).src=g},_afterLoad:function(){a.hideLoading();!a.coming||!1===a.trigger("afterLoad",a.current)?a.coming=!1:(a.isOpened?(d(".sp-fancybox-item, .sp-fancybox-nav").remove(),a.wrap.stop(!0).removeClass("sp-fancybox-opened"),a.inner.css("overflow","hidden"),a.transitions[a.current.prevMethod]()):(d(".sp-fancybox-wrap").stop().trigger("onReset").remove(),a.trigger("afterClose")),a.unbindEvents(),a.isOpen=!1,a.current=a.coming,a.wrap=d(a.current.tpl.wrap).addClass("fancybox-"+(k?"mobile":"desktop")+" fancybox-type-"+a.current.type+" sp-fancybox-tmp "+a.current.wrapCSS).appendTo("body"),a.skin=d(".sp-fancybox-skin",a.wrap).css("padding",n(a.current.padding)),a.outer=d(".sp-fancybox-outer",a.wrap),a.inner=d(".sp-fancybox-inner",a.wrap),a._setContent())},_setContent:function(){var b=a.current,c=b.content,e=b.type,f=b.minWidth,g=b.minHeight,i=b.maxWidth,h=b.maxHeight;switch(e){case"inline":case"ajax":case"html":b.selector?c=d("<div>").html(c).find(b.selector):c instanceof d&&(c.parent().hasClass("sp-fancybox-inner")&&c.parents(".sp-fancybox-wrap").unbind("onReset"),c=c.show().detach(),d(a.wrap).bind("onReset",function(){c.appendTo("body").hide()}));b.autoSize&&(f=d('<div class="sp-fancybox-wrap '+a.current.wrapCSS+' fancybox-tmp"></div>').appendTo("body").css({minWidth:n(f,"w"),minHeight:n(g,"h"),maxWidth:n(i,"w"),maxHeight:n(h,"h")}).append(c),b.width=f.width(),b.height=f.height(),f.width(a.current.width),f.height()>b.height&&(f.width(b.width+1),b.width=f.width(),b.height=f.height()),c=f.contents().detach(),f.remove());break;case"image":c=b.tpl.image.replace("{href}",b.href);b.aspectRatio=!0;break;case"swf":c=b.tpl.swf.replace(/\{width\}/g,b.width).replace(/\{height\}/g,b.height).replace(/\{href\}/g,b.href);break;case"iframe":c=d(b.tpl.iframe.replace("{rnd}",(new Date).getTime())).attr("scrolling",b.scrolling).attr("src",b.href),b.scrolling=k?"scroll":"auto"}if("image"===e||"swf"===e)b.autoSize=!1,b.scrolling="visible";"iframe"===e&&b.autoSize?(a.showLoading(),a._setDimension(),a.inner.css("overflow",b.scrolling),c.bind({onCancel:function(){d(this).unbind();a._afterZoomOut()},load:function(){a.hideLoading();try{this.contentWindow.document.location&&(a.current.height=d(this).contents().find("body").height())}catch(b){a.current.autoSize=!1}a[a.isOpen?"_afterZoomIn":"_beforeShow"]()}}).appendTo(a.inner)):(a.inner.append(c),a._beforeShow())},_beforeShow:function(){a.coming=null;a.trigger("beforeShow");a._setDimension();a.wrap.hide().removeClass("sp-fancybox-tmp");a.bindEvents();a._preloadImages();a.transitions[a.isOpened?a.current.nextMethod:a.current.openMethod]()},_setDimension:function(){var b=a.wrap,c=a.inner,e=a.current,f=a.getViewport(),g=e.margin,i=2*e.padding,h=e.width,j=e.height,r=e.maxWidth+i,k=e.maxHeight+i,l=e.minWidth+i,m=e.minHeight+i,p;f.w-=g[1]+g[3];f.h-=g[0]+g[2];o(h)&&0<h.indexOf("%")&&(h=(f.w-i)*parseFloat(h)/100);o(j)&&0<j.indexOf("%")&&(j=(f.h-i)*parseFloat(j)/100);g=h/j;h+=i;j+=i;e.fitToView&&(r=Math.min(f.w,r),k=Math.min(f.h,k));if(e.aspectRatio){if(h>r&&(h=r,j=(h-i)/g+i),j>k&&(j=k,h=(j-i)*g+i),h<l&&(h=l,j=(h-i)/g+i),j<m)j=m,h=(j-i)*g+i}else h=Math.max(l,Math.min(h,r)),j=Math.max(m,Math.min(j,k));h=Math.round(h);j=Math.round(j);d(b.add(c)).width("auto").height("auto");c.width(h-i).height(j-i);b.width(h);p=b.height();if(h>r||p>k)for(;(h>r||p>k)&&h>l&&p>m;)j-=10,e.aspectRatio?(h=Math.round((j-i)*g+i),h<l&&(h=l,j=(h-i)/g+i)):h-=10,c.width(h-i).height(j-i),b.width(h),p=b.height();e.dim={width:n(h),height:n(p)};e.canGrow=e.autoSize&&j>m&&j<k;e.canShrink=!1;e.canExpand=!1;if(h-i<e.width||j-i<e.height)e.canExpand=!0;else if((h>f.w||p>f.h)&&h>l&&j>m)e.canShrink=!0;a.innerSpace=p-i-
c.height()},_getPosition:function(b){var c=a.current,e=a.getViewport(),f=c.margin,d=a.wrap.width()+f[1]+f[3],i=a.wrap.height()+f[0]+f[2],h={position:"absolute",top:f[0]+e.y,left:f[3]+e.x};c.autoCenter&&c.fixed&&!b&&i<=e.h&&d<=e.w&&(h={position:"fixed",top:f[0],left:f[3]});h.top=n(Math.max(h.top,h.top+(e.h-i)*c.topRatio));h.left=n(Math.max(h.left,h.left+0.5*(e.w-d)));return h},_afterZoomIn:function(){var b=a.current,c=b?b.scrolling:"no";if(b&&(a.isOpen=a.isOpened=!0,a.wrap.addClass("sp-fancybox-opened"),a.inner.css("overflow","yes"===c?"scroll":"no"===c?"hidden":c),a.trigger("afterShow"),a.update(),(b.closeClick||b.nextClick)&&a.inner.css("cursor","pointer").bind("click.fb",function(c){if(!d(c.target).is("a")&&!d(c.target).parent().is("a"))a[b.closeClick?"close":"next"]()}),b.closeBtn&&d(b.tpl.closeBtn).appendTo(a.skin).bind("click.fb",a.close),b.arrows&&1<a.group.length&&((b.loop||0<b.index)&&d(b.tpl.prev).appendTo(a.outer).bind("click.fb",a.prev),(b.loop||b.index<a.group.length-1)&&d(b.tpl.next).appendTo(a.outer).bind("click.fb",a.next)),a.opts.autoPlay&&!a.player.isActive))a.opts.autoPlay=!1,a.play()},_afterZoomOut:function(){var b=a.current;a.wrap.trigger("onReset").remove();d.extend(a,{group:{},opts:{},current:null,isActive:!1,isOpened:!1,isOpen:!1,wrap:null,skin:null,outer:null,inner:null});a.trigger("afterClose",b)}});a.transitions={getOrigPosition:function(){var b=a.current,c=b.element,e=b.padding,f=d(b.orig),g={},i=50,h=50;!f.length&&b.isDom&&d(c).is(":visible")&&(f=d(c).find("img:first"),f.length||(f=d(c)));f.length?(g=f.offset(),f.is("img")&&(i=f.outerWidth(),h=f.outerHeight())):(b=a.getViewport(),g.top=b.y+0.5*(b.h-h),g.left=b.x+0.5*(b.w-i));return g={top:n(g.top-e),left:n(g.left-e),width:n(i+2*e),height:n(h+2*e)}},step:function(b,c){var e=c.prop,d,g;if("width"===e||"height"===e)d=Math.ceil(b-2*a.current.padding),"height"===e&&(g=(b-c.start)/(c.end-c.start),c.start>c.end&&(g=1-g),d-=a.innerSpace*g),a.inner[e](d)},zoomIn:function(){var b=a.wrap,c=a.current,e=c.openEffect,f="elastic"===e,g=d.extend({},c.dim,a._getPosition(f)),i=d.extend({opacity:1},g);delete i.position;f?(g=this.getOrigPosition(),c.openOpacity&&(g.opacity=0),a.outer.add(a.inner).width("auto").height("auto")):"fade"===e&&(g.opacity=0);b.css(g).show().animate(i,{duration:"none"===e?0:c.openSpeed,easing:c.openEasing,step:f?this.step:null,complete:a._afterZoomIn})},zoomOut:function(){var b=a.wrap,c=a.current,d=c.openEffect,f="elastic"===d,g={opacity:0};f&&("fixed"===b.css("position")&&b.css(a._getPosition(!0)),g=this.getOrigPosition(),c.closeOpacity&&(g.opacity=0));b.animate(g,{duration:"none"===d?0:c.closeSpeed,easing:c.closeEasing,step:f?this.step:null,complete:a._afterZoomOut})},changeIn:function(){var b=a.wrap,c=a.current,d=c.nextEffect,f="elastic"===d,g=a._getPosition(f),i={opacity:1};g.opacity=0;f&&(g.top=n(parseInt(g.top,10)-200),i.top="+=200px");b.css(g).show().animate(i,{duration:"none"===d?0:c.nextSpeed,easing:c.nextEasing,complete:a._afterZoomIn})},changeOut:function(){var b=a.wrap,c=a.current,e=c.prevEffect,f={opacity:0};b.removeClass("sp-fancybox-opened");"elastic"===e&&(f.top="+=200px");b.animate(f,{duration:"none"===e?0:c.prevSpeed,easing:c.prevEasing,complete:function(){d(this).trigger("onReset").remove()}})}};a.helpers.overlay={overlay:null,update:function(){var a,c;this.overlay.width("100%").height("100%");d.browser.msie||k?(a=Math.max(l.documentElement.scrollWidth,l.body.scrollWidth),c=Math.max(l.documentElement.offsetWidth,l.body.offsetWidth),a=a<c?m.width():a):a=q.width();this.overlay.width(a).height(q.height())},beforeShow:function(b){this.overlay||(b=d.extend(!0,{},a.defaults.helpers.overlay,b),this.overlay=d('<div id="sp-fancybox-overlay"></div>').css(b.css).appendTo("body"),b.closeClick&&this.overlay.bind("click.fb",a.close),a.current.fixed&&!k?this.overlay.addClass("overlay-fixed"):(this.update(),this.onUpdate=function(){this.update()}),this.overlay.fadeTo(b.speedIn,b.opacity))},afterClose:function(a){this.overlay&&this.overlay.fadeOut(a.speedOut||0,function(){d(this).remove()});this.overlay=null}};a.helpers.title={beforeShow:function(b){var c;if(c=a.current.title)c=d('<div class="sp-fancybox-title sp-fancybox-title-'+b.type+'-wrap">'+c+"</div>").appendTo("body"),"float"===b.type&&(c.width(c.width()),c.wrapInner('<span class="child"></span>'),a.current.margin[2]+=Math.abs(parseInt(c.css("margin-bottom"),10))),c.appendTo("over"===b.type?a.inner:"outside"===b.type?a.wrap:a.skin)}};d.fn.fancybox=function(b){var c=d(this),e=this.selector||"",f,g=function(g){var h=this,j=f,k;!g.ctrlKey&&!g.altKey&&!g.shiftKey&&!g.metaKey&&!d(h).is(".sp-fancybox-wrap")&&(g.preventDefault(),g=b.groupAttr||"data-fancybox-group",k=d(h).attr(g),k||(g="rel",k=h[g]),k&&""!==k&&"nofollow"!==k&&(h=e.length?d(e):c,h=h.filter("["+g+'="'+k+'"]'),j=h.index(this)),b.index=j,a.open(h,b))},b=b||{};f=b.index||0;e?q.undelegate(e,"click.fb-start").delegate(e,"click.fb-start",g):c.unbind("click.fb-start").bind("click.fb-start",g);return this};d(l).ready(function(){a.defaults.fixed=d.support.fixedPosition||!(d.browser.msie&&6>=d.browser.version)&&!k})})(window,document,sQuery);(function($){var highlight;highlight=$.highlight={conf:{layerId:'spApiOverlayMask',layerClass:'sp-highlight-overlay',appendTarget:'body',highlightedElements:[],closeOnEsc:false,closeOnClick:true,paddingLeft:0,paddingTop:0,padding:0,loadSpeed:'fast',closeSpeed:'fast',scroll:false,scrollSpeed:500,scrollSize:30,prevBackgroundColor:'',nextBackgroundColor:'',zIndex:99999998,opacity:0.8,startOpacity:0,color:'#000',onLoad:null,onClose:null,onBeforeLoad:null,onBeforeClose:null}};function call(fn){if(fn){return fn.call($.mask);}}
var mask,loaded,config,elements;function show(x0,y0,x1,y1,c){var overlay=$('<div class="'+c.layerClass+'"></div>').css({position:'absolute',background:c.color,opacity:c.opacity,filter:'alpha(opacity='+Math.round(c.opacity*100)+')',top:parseInt(y0)+'px',left:parseInt(x0)+'px',width:(parseInt(x1)-parseInt(x0))+'px',height:(parseInt(y1)-parseInt(y0))+'px',zIndex:c.zIndex}).appendTo($(c.appendTarget));$(c.appendTarget).append(overlay);}
$.mask={load:function load(c,el){if(loaded){return this;}
c=c||c;config=c=$.extend($.extend({},highlight.conf),c);if(el&&el.length){if(c.highlightedElements.length){elements=sQuery(c.highlightedElements.join());}else{elements=el;}
if(call(c.onBeforeLoad)===false){return this;}
$.mask.init(c,elements);if(c.scroll===true){$("body, html").animate({scrollTop:$(el).offset().top-c.scrollSize},c.scrollSpeed);}
if(call(c.onLoad)===false){return this;}
loaded="full";}
return this;},init:function init(c,els){$.mask.removeOverlay();var padding=c.padding||0,paddingLeft=c.paddingLeft||0,paddingTop=c.paddingTop||0,bounds=[],xValues=[0],sortedX=[];els.each(function(i,el){var $el=$(el),offset=$el.offset(),x0=offset.left-padding-paddingLeft,y0=offset.top-padding-paddingTop,x1=offset.left+$el.outerWidth()+padding+paddingLeft,y1=offset.top+$el.outerHeight()+padding+paddingTop;bounds.push({topLeft:{x:x0,y:y0},bottomRight:{x:x1,y:y1}});xValues.push(x0);xValues.push(x1);});xValues.push($(document).width());xValues.sort(function(a,b){return a-b;});var last;var i;var j;var bound;for(i=0;i<xValues.length;i++){if(last!=xValues[i]){last=xValues[i];sortedX.push(xValues[i]);}}
bounds.sort(function(a,b){return a.topLeft.y-b.topLeft.y;});for(i=0;i<sortedX.length-1;i++){var x0=sortedX[i],x1=sortedX[i+1],intersecting=[];for(j=0;j<bounds.length;j++){bound=bounds[j];if(bound.topLeft.x<=x0&&bound.bottomRight.x>=x1){intersecting.push([bound.topLeft.y,bound.bottomRight.y]);}}
var yValues=[0];for(j=0;j<intersecting.length;j++){bound=intersecting[j];if(bound[0]>yValues[yValues.length-1]){yValues.push(bound[0]);yValues.push(bound[1]);}else{yValues.pop();yValues.push(bound[1]);}}
yValues.push($(document).height());for(j=0;j<yValues.length-1;j=j+2){show(x0,yValues[j],x1,yValues[j+1],c);}}
mask=$('.'+c.layerClass);if(c.closeOnEsc){$(document).on("keydown.mask",function(e){if(e.keyCode==27){$.mask.close(e);}});}
if(c.closeOnClick){mask.on("click.mask",function(e){$.mask.close(e);});}
$(window).on("resize.mask",function(){$.mask.fit();});$(window).on("scroll.mask",function(){$.mask.fit();});},close:function close(){if(loaded){if(call(config.onBeforeClose)===false){return this;}
mask.fadeOut(config.closeSpeed);mask.off("click.mask");$(document).off("keydown.mask");$(window).off("resize.mask");$(window).off("scroll.mask");if(call(config.onClose)===false){return this;}
loaded=false;}
return this;},closeSlient:function(){if(loaded){mask.fadeOut(config.closeSpeed);mask.off("click.mask");$(document).off("keydown.mask");$(window).off("resize.mask");$(window).off("scroll.mask");loaded=false;}
return this;},fit:function fit(){$.mask.init(config,elements);},removeOverlay:function removeOverlay(){if(mask){mask.off("click.mask");$(document).off("keydown.mask");$(window).off("resize.mask");$(window).off("scroll.mask");mask.remove();}},getMask:function(){return mask;},isLoaded:function(fully){return fully?loaded=='full':loaded;},getConf:function(){return config;},setConf:function(c){c=c||c;config=c=$.extend($.extend({},highlight.conf),c);return c;},getApparent:function(){return elements;}};$.fn.mask=function(conf){$.mask.load(conf);return this;};$.fn.highlight=function(conf){$.mask.load(conf,this);return this;};})(sQuery);partnerName="holodilnik";partner_site={"scheme":"http","host":"www.holodilnik.ru","path":"\/"};partner_site.host=partner_site.host.replace(/^www\./,'');var cookieDomain="."+partner_site.host;var isInIFrame=(window.location!=window.top.location);var panelEdit=false;if(isInIFrame==true){sQuery.cookie('ins-panel',1,{expires:1,path:'/',domain:'.'+partner_site.host});panelEdit=true;}
else{sQuery.cookie('ins-panel',null,{expires:-1,path:'/',domain:'.'+partner_site.host});}
if(typeof disabledEdit!='undefined'&&disabledEdit==true){panelEdit=false;}
function loadPanelView(){var js=undefined;var count=0;pm.bind('apiControl',function(){return'1';});if(panelEdit==true){var checkIframe=setInterval(function(){if(count==5&&js==undefined){clearInterval(checkIframe);window.panelEdit=false;panelEdit=false;spApi.init();return false;}
count++;pm({target:window.top,type:'checkIframe',data:{},success:function(result){if(typeof js==='object'){clearInterval(checkIframe);return false;}
var scriptSource=spApi.apiUrl+'edit/';var prototypeInterval=setInterval(function(){if(typeof Prototype!=='undefined'&&Prototype.Version<'1.7'&&Array.prototype.toJSON){delete Array.prototype.toJSON;delete Array.prototype.toArray;clearInterval(prototypeInterval);}},10);setTimeout(function(){if(typeof prototypeInterval!=='undefined'){clearInterval(prototypeInterval);}},3000);js=result;if(typeof js==='object'){window.ActionBuilderSettings=js.config;var appPath=result.config.app.appPath;if(typeof appPath=='undefined'){appPath=scriptSource+'actionbuilder/frame/app.js';}
var html_doc=document.getElementsByTagName('head')[0];var scriptElement=document.createElement('script');scriptElement.setAttribute('language','javascript');scriptElement.setAttribute('type','text/javascript');scriptElement.setAttribute('src',appPath+'?v='+spApi.genDate);html_doc.appendChild(scriptElement);clearInterval(checkIframe);}else{var scriptElement=document.createElement('script');scriptElement.type='text/javascript';scriptElement.src=scriptSource+js+'?'+new Date().getTime();document.getElementsByTagName('head')[0].appendChild(scriptElement);clearInterval(checkIframe);}}});},100);}}
sQuery(document).ready(function(){loadPanelView();});function getAnalytics(callback){esCountAnalytics(callback);}function esCountAnalytics(callback,campId){if(!spApi.isOnProductPage()){return;}
var uniqueID=(spApi.getCurrentProduct()||{}).id;if(typeof window.spPageVisitCount!="undefined"&&typeof callback!="undefined"){callback(window.spPageVisitCount);return;}
if(typeof spApi.analyticsCallbacks=="undefined"){spApi.analyticsCallbacks=[];if(typeof callback!="undefined")
spApi.analyticsCallbacks.push(callback);}else{if(typeof callback!="undefined")
spApi.analyticsCallbacks.push(callback);return;}
if(typeof uniqueID==='undefined'||uniqueID===''){return;}
var instantView=false;var dailyView=false;var isUniqueView=true;sQuery.each(spApi.notifies,function(i,val){if(val.kkbSettings!=null){sQuery.each(val.kkbSettings,function(kkbIndex,kkbVal){if(kkbIndex=="@instantView"){instantView=true;}
if(kkbIndex=="@dailyView"){dailyView=true;}});}});if(dailyView!=true&&instantView!=true)
return;if(isUniqueView){if(spApi.storageData(uniqueID)){isUniqueView=true;}else{spApi.storageData(uniqueID,uniqueID,{expires:1/48});isUniqueView=false;}}
sQuery.ajax({url:"//socialproof.api.useinsider.com?t=esCountAnalytics&instantView="+instantView+"&dailyView="+dailyView,data:{uniqueID:uniqueID,partnerName:"holodilnik",isUniqueView:isUniqueView,campId:campId,kkbRandomSettings:spApi.notifies[campId].kkbRandomSettings,multiplySettings:(spApi.notifies[campId]||{}).multiplySettings,addToOriginalSettings:(spApi.notifies[campId]||{}).addToOriginalSettings},type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseAnalyticsData",success:function(e){var isDataAvailable=(dailyView&&e.count.dailyView>-1)||(instantView&&e.count.instantView>-1);if(typeof e=="object"&&isDataAvailable){window.success10=e.count.dailyView<10?e.count.dailyView*3:e.count.dailyView;window.spPageVisitCount=e.count;sQuery.each(spApi.analyticsCallbacks,function(i,funct){funct(e.count);});spApi.analyticsCallbacks=undefined;}}});}
function parseAnalyticsData(e){}
function esLiveFeed(callback){if(!spApi.isOnProductPage()){return;}
if(typeof window.esFeedData!="undefined"&&typeof callback!="undefined"){callback(window.esFeedData);return;}
if(typeof spApi.historyCallbacks=="undefined"){spApi.historyCallbacks=[];if(typeof callback!="undefined")
spApi.historyCallbacks.push(callback);}else{if(typeof callback!="undefined")
spApi.historyCallbacks.push(callback);return;}
var lastPurchaseTime=false;var dailyPurchase=false;var instantPurchase=false;var inBasket=false;sQuery.each(spApi.notifies,function(id,notify){if(lastPurchaseTime==false&&notify.content.indexOf("@lastPurchasedTime")!=-1){lastPurchaseTime=true;}
if(dailyPurchase==false&&notify.content.indexOf("@dailyPurchase")!=-1){dailyPurchase=true;}
if(instantPurchase==false&&notify.content.indexOf("@instantPurchase")!=-1){instantPurchase=true;}
if(inBasket==false&&notify.content.indexOf("@inBasketCount")!=-1){inBasket=true;}});sQuery.each(spApi.notifies,function(id,notify){if(notify.kkbSettings!=null){sQuery.each(notify.kkbSettings,function(property,value){if(dailyPurchase==false&&property=="@dailyPurchase"){dailyPurchase=true;}
if(lastPurchaseTime==false&&property=="@lastPurchaseTime"){lastPurchaseTime=true;}
if(instantPurchase==false&&property=="@instantPurchase"){instantPurchase=true;}
if(inBasket==false&&property=="@inBasketCount"){inBasket=true;}});}});var uniqueID=(spApi.getCurrentProduct()||{}).id;if(typeof uniqueID==='undefined'||uniqueID===''){return;}
sQuery.ajax({url:"//socialproof.api.useinsider.com?t=getKksHistory&lastPurchaseTime="+lastPurchaseTime+"&dailyPurchase="+dailyPurchase+"&instantPurchase="+instantPurchase+"&inCartCount="+inBasket,data:{uniqueID:uniqueID,partnerName:"holodilnik",multiplySettings:(spApi.notifies[window.socialProofVarId]||{}).multiplySettings,addToOriginalSettings:(spApi.notifies[window.socialProofVarId]||{}).addToOriginalSettings,kkbRandomSettings:(spApi.notifies[window.socialProofVarId]||{}).kkbRandomSettings},type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parsehistoryData",success:function(e){window.esFeedData=e;sQuery.each(spApi.historyCallbacks,function(i,funct){funct(e);});spApi.historyCallbacks=undefined;}});function parsehistoryData(e){}
function parseCustomPlusData(e){}
function parseNotifyData(e){}}
protocol='https://';var _json_stringify=JSON.stringify;var Prototype=window.Prototype;var hasPrototype=typeof Prototype!=='undefined'&&Prototype.Version<'1.7'&&Array.prototype.toJSON&&Object.toJSON;JSON.stringify=hasPrototype?function(object){return Object.toJSON(object)}:_json_stringify;sQuery.fn.extend({exists:function(){return this.length>0;},elementLoadComplete:function(callback,customConfig,notFoundCallback){try{var defaults={t:spApi.elementLoadCompleteConfig.timeout,infinite:spApi.elementLoadCompleteConfig.infinite};var config=sQuery.extend(defaults,customConfig);var selector=this.selector;if(typeof selector!=='string'||typeof callback!=='function'){return false;}
if(sQuery(selector).exists()&&!config.infinite){return callback(sQuery(selector));}
if(config.type==='interval'){spApi.waitElementWithInterval({selector:selector,callback:callback,notFoundCallback:notFoundCallback,timeout:config.t});return false;}
var index=spApi.elementLoadCompleteConfig.mutableList.push({selector:selector,callback:callback,infinite:config.infinite,notFoundCallbackTimeout:setTimeout(function(){if(spApi.elementLoadCompleteConfig.mutableList[index-1]instanceof Object){spApi.elementLoadCompleteConfig.mutableList[index-1].invalid=true;}
if(typeof notFoundCallback==='function'){spApi.logger('warning','Selector not found.'+selector);notFoundCallback();}},config.t)});spApi.elementLoadCompleteConfig.mutationCallback=spApi.debounce(function(){var mutableList=spApi.elementLoadCompleteConfig.mutableList;mutableList.forEach(function(mutableObject,index){if(sQuery(mutableObject.selector).exists()&&typeof mutableObject.invalid==='undefined'){spApi.logger('info','Selector has been found, callback is running.'+mutableObject.selector);clearTimeout(mutableObject.notFoundCallbackTimeout);mutableObject.callback(sQuery(mutableObject.selector));if(!mutableObject.infinite){mutableList[index].invalid=false;}}});},50);if(spApi.elementLoadCompleteConfig.inited){return false;}
spApi.elementLoadCompleteConfig.inited=true;var referenceElement=document.body||document;if(window.MutationObserver&&referenceElement){setTimeout(function(){var observer=new MutationObserver(spApi.elementLoadCompleteConfig.mutationCallback);observer.observe(referenceElement,{childList:true,subtree:true});spApi.elementLoadCompleteConfig.disconnect=observer.disconnect.bind(observer);},0);}else{referenceElement.removeEventListener('DOMSubtreeModified',spApi.elementLoadCompleteConfig.mutationCallback);referenceElement.addEventListener('DOMSubtreeModified',spApi.elementLoadCompleteConfig.mutationCallback);}
if(spApi.elementLoadCompleteConfig.autoExpireActivated){setTimeout(spApi.clearElementLoadComplete,spApi.elementLoadCompleteConfig.timeout||(15*1000));}}catch(error){spApi.errLog(error,{logType:'ElementLoadComplete',bugType:'product'});}
return this;}});function setSessionOnlyCookie(cookieName,cookieValue){if(navigator.userAgent.indexOf('MSIE')!==-1||navigator.appVersion.indexOf('Trident/')>0){document.cookie=cookieName+"="+cookieValue+"; path=/";}else{document.cookie=cookieName+'='+cookieValue+';path=/'+';expires='+'0';}}
if(typeof spPanelPreview=="undefined"||spPanelPreview!=true){var disable_camp=false;}
else{var disable_camp=true;}
spApi={loadScript:spApi.loadScript,isAjaxAsync:false,viewedCustomCamps:[],Base64:{encode:function(str){return btoa(unescape(encodeURIComponent(str)));},decode:function(str){return decodeURIComponent(escape(atob(str)));}},consoleLog:[],salesSesId:'MA==',partnerTimeZone:'Europe/Moscow',goalList:[],goalObserverStatus:false,goalLogs:[],dbLog:[],hitSend:false,errLogActive:true,esResultCheck:function(campId,logic,value,aggrName){return spApi.e("(this.gaDimensionQ['"+campId+"_"+aggrName+"'] "+logic+" "+value+")");},paaProducts:[32,39,47],isFirstVersus:false,highlight:function(element,options){return sQuery(element).highlight(options);},debounce:function(func,wait){var timeout;return function(){clearTimeout(timeout);timeout=setTimeout(func.bind(this),wait);};},isset:function(value){return typeof value!=='undefined'&&typeof value!=='unknown';},mask:sQuery.mask,gaDimensionQ:{},getBrowser:function(version,lowerCase){var ua=navigator.userAgent,tem,M=ua.match(/(yabrowser|opera|chrome|crios|safari|firefox|msie|edge|maxthon|trident|ubrowser|ucbrowser(?=\/))\/?\s*(\d+)/i)||[];var done=false;if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];M[0]='IE';M[1]=(tem[1]||-1);done=true;}else if(M[1]==='Chrome'){if(ua.match(/\b(Edge)\/(\d+)/)!=null){tem=ua.match(/\b(Edge)\/(\d+)/);done=true;M[0]='Edge';M[1]=(tem[2]||-1);}else if(ua.match(/\b(YaBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(YaBrowser)\/(\d+)/);done=true;M[0]='Yandex';M[1]=(tem[2]||-1);}else if(ua.match(/\b(OPR)\/(\d+)/)!=null){tem=ua.match(/\b(OPR)\/(\d+)/);done=true;M[0]='Opera';M[1]=(tem[2]||-1);}else if(ua.match(/\b(UBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(UBrowser)\/(\d+)/);done=true;M[0]='UCBrowser';M[1]=(tem[2]||-1);}else if(ua.match(/\b(SamsungBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(SamsungBrowser)\/(\d+)/);done=true;M[0]='Samsung Internet';M[1]=(tem[2]||-1);}}else if(ua.match(/\b(CriOS)\/(\d+)/)!=null){tem=ua.match(/\b(CriOS)\/(\d+)/);done=true;M[0]='Chrome';M[1]=(tem[2]||-1);}
if(ua.match(/\b(coc_coc_browser)\/(\d+)/)!=null||(navigator.vendor&&navigator.vendor=='Coc Coc')){tem=ua.match(/\b(coc_coc_browser)\/(\d+)/)||'';done=true;M[0]='CocCoc';M[1]=(tem[2]||-1);}
if(!done){M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,-1];if((tem=ua.match(/version\/(\d+)/i))!=null)
M.splice(1,1,tem[1]);}
if(typeof version!=='undefined'&&version)
return M[1]||-1;if(M[0]=='MSIE')M[0]='IE';if(typeof lowerCase!=='undefined'&&lowerCase)
M[0]=M[0].toLowerCase();return M[0];},conTrace:function(){if(spApi.debugModeIsOpen()&&typeof console.trace!=='undefined'){console.trace.apply(console,arguments);}},errLog:function(error,data){if(typeof data=="undefined"){data={logType:'Bilinmeyen Hata'};}
data.errorName=error.name;data.errorMessage=error.message;data.errorLineNumber=error.lineNumber||'';data.errorStack=error.stack||'';data.partnerName=partnerName;data.bugType=data.bugType||'product';data.url=window.location.href;data.host=window.location.host;data.referrer=window.document.referrer;data.date=new Date().getTime();data.browser=spApi.getBrowser();data.browserVersion=spApi.getBrowser(true);data.browserLang=navigator.language;data.platform=navigator.platform;data.userAgent=navigator.userAgent;if(typeof spApi.errLogs==='undefined'){spApi.errLogs=[];}
spApi.errLogs.push(data);spApi.conTrace(error,data);if(typeof spApi.consoleLog.push==='function'){spApi.consoleLog.push('ERROR',data);}
var validateIpAddress=function(ipAddress){var ipRegex=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;return ipRegex.test(ipAddress);};if(data.logType==='siteUrlCheckFailed'&&data.host.indexOf('local')<0&&data.host.indexOf('test')<0&&!validateIpAddress(data.host)){}},limitSystemRulesCall:function(){var systemRules=spApi.getPrototype('systemRules');var handler=function handler(fn,ruleName){if(spApi[ruleName].callLimit<500){spApi[ruleName].callLimit+=1;return fn.apply(this,arguments);}else{try{spApi[ruleName].callLimit=0;throw new Error();}catch(error){spApi.errLog(error,{logType:'Possible infinite loop on system rule call ('+ruleName+')',bugType:'System Rules'});}}};systemRules.forEach(function(ruleName){if(typeof spApi[ruleName]==='function'&&typeof spApi[ruleName].callLimit==='undefined'){spApi[ruleName]=handler.bind(this,spApi[ruleName],ruleName);spApi[ruleName].callLimit=0;}}.bind(this));},resetSystemRulesCallLimits:function(){spApi.logger('info','Resetting call limits for system rules');var systemRules=spApi.getPrototype('systemRules');systemRules.forEach(function(ruleName){(spApi[ruleName]||{}).callLimit=0;});},isBrowserSupportEnabled:function(){try{var browser=spApi.getBrowser();var version=Number(spApi.getBrowser(true));if(browser=="IE"&&version<=10){return false;}
return true;}
catch(e){spApi.errLog(e);}},isCookieSupportEnabled:function(){try{if(spApi.cookieSupport){return true;}
if(typeof navigator.cookieEnabled!=='undefined'){return navigator.cookieEnabled;}
document.cookie='scs=1;'+location.protocol==='https:'?'SameSite=None; Secure':'';if(sQuery.cookie("scs")){spApi.cookieSupport=true;return true;}
return false;}catch(e){spApi.errLog(e)}},bindAutoClose:function(campaign,callback){},isLocalStorageSupport:insIsLocalStorageSupported,getParameterFromUrl:function(url,parameter)
{var name=parameter.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);if(results==null)
return"";else
return decodeURIComponent(results[1]);},isOptOut:function(){return sQuery.cookie('INSOPTOUT')!==null;},optOutRequestExists:function(){return spApi.hasParameter('INSOPTOUT');},checkOptOut:function(){if(spApi.optOutRequestExists()&&!spApi.isOptOut()){spApi.worker.asyncPM('insOptOut');sQuery.cookie('INSOPTOUT',1,{expires:360,path:'/',domain:cookieDomain});}
return spApi.isOptOut();},resetAddCartCount:function(){var counter=[];localStorage.setItem('addCartCount',counter);},loaded:false,showActiveCamp:function(){spApi.activeCamp=spApi.getCampOfThePage(spApi.camps);if(spApi.activeCamp){try{var selectedElement=typeof spApi.notifies[spApi.activeCamp.id]==='undefined'?'':spApi.notifies[spApi.activeCamp.id].locationConfig.selectedElement;if(typeof spApi.notifies[spApi.activeCamp.id]!=='undefined'){var locationConfig=spApi.notifies[spApi.activeCamp.id].locationConfig;if(locationConfig.selectedElement){selectedElement=locationConfig.selectedElement;}else if(locationConfig.relativePositioning==='true'&&locationConfig.relativePosition.element){selectedElement=locationConfig.relativePosition.element;}}
var activeCampId=spApi.activeCamp.id;if(spApi.isControlCamp(activeCampId)){selectedElement=spApi.getControlGroupSelectedElement(activeCampId);}
if(selectedElement){sQuery(selectedElement).elementLoadComplete(function(){spApi.showCamp(spApi.activeCamp);},{t:1000},function(){(spApi.getCamp(activeCampId).camp||{}).invalid=true;spApi.logger('info','Campaign reference element not found, next campaign will be showed',activeCampId);spApi.showActiveCamp();});}else{spApi.showCamp(spApi.activeCamp);}}catch(error){spApi.errLog(error);}}},isBannerManagementActive:function(){return typeof spApi.bannerManagementCamps!=='undefined'&&spApi.bannerManagementCamps.length>0;},showCustomCamp:function(customCamp){},clearCustomCamps:function(){},initCustomCamps:function(){},setCampSalesSesId:function(){if(spApi.salesSesId==false){spApi.errLog({name:'Error',message:'salesSessionIdNotExists'},{logType:'salesSesId',bugType:'product',extraData:{salesSesId:spApi.salesSesId}});return;}
var currentCookie='';try{var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;var value=obj.value;if(key.indexOf("sp-camp-")!=-1){currentCookie=obj;if(typeof value!=="undefined"){var campId=(key.replace('sp-camp-','')).replace(/^\s+|\s+$/gm,'');var objData=JSON.parse(unescape(value));var sesExpireTime=30*60;if(value.indexOf("salesSesId")==-1){objData.salesSesId=spApi.Base64.decode(spApi.salesSesId);objData.salesSesTime=spApi.getTime();var data={key:'sp-camp-'+campId,obj:objData,campId:campId};spApi.updateCookie(data,'nolog');}else if((parseInt(objData.salesSesTime)+sesExpireTime)>=spApi.getTime()&&objData.salesSesId==spApi.Base64.decode(spApi.salesSesId)){objData.salesSesTime=spApi.getTime();var data={key:'sp-camp-'+campId,obj:objData,campId:campId};spApi.updateCookie(data,'nolog');}}}});}catch(err){spApi.errLog(err,{logType:'setCampSalesSesId',bugType:'product',extraData:{Cookie:currentCookie,salesSesId:spApi.salesSesId}});}},storeLog:function(table,logData){spApi.worker.asyncPM('storeLog',{table:spApi.getLogTableAlias(table),logData:logData});},removePageOpacity:function(){if(typeof window['insPageShow']==='function'){window['insPageShow']();}},getDataFromDataLayer:function(property,additionalCondition,fallback){var fb=typeof fallback!=='undefined'?fallback:'';var checkCondition=(typeof additionalCondition!=='undefined'&&typeof additionalCondition==='function')?additionalCondition:function(){return true;};return((typeof dataLayer!=='undefined'?dataLayer:[]).filter(function(index){return typeof index[property]!=='undefined'&&checkCondition(index);})[0]||{})[property]||fb;},getDataFromIO:function(type,property,fallback){var fb=typeof fallback!=='undefined'?fallback:'';return(typeof insider_object!=='undefined'&&typeof insider_object[type]!=='undefined'&&typeof insider_object[type][property]!=='undefined')?insider_object[type][property]:fb;},generateProductId:function(parameter){var id=(parameter||location.href).toString().replace(/(<=&|\?)utm_.*/g,'').replace(location.origin,'');var idHash=spApi.hashCode(id.toString()).toString();var idBase64=spApi.Base64.encode(id);return'ins'+idHash+idBase64.substring(idBase64.length-(29-idHash.length));},pluralForm:{get:function(lang,count,form1,form2,form3,form4){if(typeof spApi.pluralForm[lang]==='undefined'){return form1;}
return spApi.pluralForm[lang](count,form1,form2,form3,form4);},en_US:function(count,form1,form2){return Math.abs(count)==1?form1:form2;},ru_RU:function(count,form1,form2,form3){count=Math.abs(count);count%=100;if(count>=5&&count<=20){return form3;}
count%=10;if(count==1){return form1;}
if(count>=2&&count<=4){return form2;}
return form3;},},translations:{"en_US":{"date":{"form1":{"day":"Day","hour":"Hour","minute":"Minute","second":"Second"},"form2":{"day":"Days","hour":"Hours","minute":"Minutes","second":"Seconds"}}},"ru_RU":{"date":{"form1":{"day":"\u0414\u0435\u043d\u044c","hour":"\u0427\u0430\u0441","minute":"\u041c\u0438\u043d\u0443\u0442\u0430","second":"\u0421\u0435\u043a\u0443\u043d\u0434\u0430"},"form2":{"day":"\u0414\u043d\u044f","hour":"\u0427\u0430\u0441\u0430","minute":"\u041c\u0438\u043d\u0443\u0442","second":"\u0421\u0435\u043a\u0443\u043d\u0434\u044b"},"form3":{"day":"\u0414\u043d\u0435\u0439","hour":"\u0427\u0430\u0441\u043e\u0432","minute":"\u041c\u0438\u043d\u0443\u0442","second":"\u0421\u0435\u043a\u0443\u043d\u0434"}}}},isSiteUrlCheckFailed:function(){if(typeof spApi.isSiteUrlFailedLogSent!=='undefined'){return true;}
if(partnerName==='loadactionbuilder'&&spApi.isOnPanel()){return false;}
if(window.location.href.indexOf(partner_site.host)<0){spApi.logger('warning','Check your site information!');disable_camp=true;spApi.isSiteUrlFailedLogSent=true;spApi.errLog({name:'siteUrlCheckFailed'},{logType:'siteUrlCheckFailed',bugType:'partner',extraData:{partnerSiteHost:partner_site.host,scriptUrl:spApi.apiUrl}});return true;}
return false;},inited:false,init:function(noLog){try{spApi.worker.initializeUserId();if(!panelEdit){spApi.limitSystemRulesCall();}
if(spApi.checkOptOut()){spApi.logger('info','Opt Out');return false;}
spApi.logger('info','Insider API initializing..');if(!spApi.isBrowserSupportEnabled()){return false;}
if(!spApi.isLocalStorageSupport()){spApi.logger('info','LocalStorage Support Disabled...');return false;}
if(spApi.isSiteUrlCheckFailed()){return false;}
if(!spApi.isCookieSupportEnabled()){spApi.logger('info','Cookie Support Disabled...');return false;}
if(panelEdit===true){return false;}
if(spApi.localStorageGet('inLanding')==null){spApi.storageData('inLanding',window.location.href,{path:'/',domain:cookieDomain,expires:30});}
if(spApi.localStorageGet('ins-sourceUrl')==null){spApi.storageData('ins-sourceUrl',window.document.referrer,{path:'/',domain:cookieDomain,expires:30});}
spApi.bounceCamp=undefined;spApi.activeCamps=[];spApi.activeWebPushes=[];spApi.activeConversionPushes={'set':[],'update':[],reset:[]};spApi.conditionCheckList=[];spApi.campCallbacks=[];spApi.userBounced=false;spApi.setAddCartCountFired=false;window.spPageVisitCount=undefined;window.esFeedData=undefined;if(noLog!==undefined){spApi.baseInit(noLog);}
else if(spApi.inited===false){function checkClickCapturingClasses(classList){return typeof classList==='string'&&(classList.indexOf('ins-category-sorting')>-1||classList.indexOf('sp-custom-')>-1||classList.indexOf('sp-goal-')>-1||classList.indexOf('insdr-insight-')>-1||classList.indexOf('ins-init-condition-tracking')>-1);}
document.addEventListener('click',function(event){for(var element=event.target;element;){var classes=element.className;if(checkClickCapturingClasses(classes)){sQuery(document).trigger('clickedElement',element);}
element=element.parentElement;}},!0);}
if(spApi.customizationCamps.length===0){spApi.removePageOpacity();}
function completed(){document.removeEventListener('DOMContentLoaded',completed);window.removeEventListener('load',completed);sQuery.ready();}
if(document.readyState==='complete'||(document.readyState!=='loading'&&!document.documentElement.doScroll)){window.setTimeout(sQuery.ready);}else{document.addEventListener('DOMContentLoaded',completed);window.addEventListener('load',completed);}
sQuery(document).ready(function(){if(spApi.inited===true)return false;spApi.inited=true;setTimeout(function(){spApi.baseInit(noLog);},0);});}catch(err){spApi.errLog(err,{logType:'init',bugType:'product',extraData:{param1:noLog}});}},shouldInitializeWebPush:function(){return typeof spApi.getWebPushOfThePage==='function'&&spApi.isWebPushInitialized!==true&&spApi.getBrowser()!=='Safari';},loadNotificationCenter:function(){},baseInit:function(noLog){try{window.sendEsReq=true;if(typeof noLog==='undefined')
window.noLog=true;else
window.noLog=noLog
spApi.couponAsistanceShow=function(callback){if(typeof callback!="undefined"){if(!Boolean(spApi.couponAsistanceShowEvents))
spApi.couponAsistanceShowEvents=[];spApi.couponAsistanceShowEvents.push(callback);}
return this;}
if(typeof spApi.setCustomSegments==='function'){spApi.setCustomSegments(spApi.customSegments);}
spApi.storageData(spApi.Base64.decode('aW5zR1VJRA=='),null);spApi.storageData(spApi.Base64.decode('c3BVSURHbG9iYWw='),null);spApi.triggerCartButton();spApi.initCustomCamps();spApi.setESData();if(spApi.isOnCartPage())
{var initialCartAmount=spApi.getTotalCartAmount()||0;var checkAndUpdateCartCookie=function(){var changedCartAmount=spApi.getTotalCartAmount()||0;var compareWithCookie=changedCartAmount!=parseFloat(spApi.storageData('total-cart-amount')||'0');if((initialCartAmount!=changedCartAmount||compareWithCookie)&&spApi.isOnCartPage()){spApi.updateCartCookies();initialCartAmount=changedCartAmount;sQuery(document).trigger('cartAmountUpdated');if(typeof spApi.cartAbandonmentEmail==='object'){for(var provider in spApi.emailProviders){if(spApi.emailProviders.hasOwnProperty(provider)&&spApi.emailProviders[provider]===true){spApi.cartAbandonmentEmail.set(provider);}}}
spApi.conLog("Cart parameters have changed, updating...");spApi.conLog("Updated cart amount is: "+changedCartAmount);}};checkAndUpdateCartCookie();spApi.cartInterval=setInterval(checkAndUpdateCartCookie,1000);var pProd=spApi.getPaidProducts();var encodedProducts=JSON.stringify(pProd);var date=new Date();var minutes=30;date.setTime(date.getTime()+(minutes*60*1000));spApi.storageData('paid-products',encodedProducts,{expires:date,path:'/',domain:cookieDomain});spApi.updateCartCount(spApi.getCartCount());}
spApi.loadNotificationCenter();spApi.showActiveCamp();if(typeof spApi.getInsightOfThePage=='function'){spApi.getInsightOfThePage();}
if(sQuery.cookie('sp-notes')){spApi.loadInfoCss();}
spApi.noteTimer();spApi.setCouponAsistant();if(spApi.isOnAfterPaymentPage()){spApi.resetAddCartCount();}
if(spApi.isOnCartPage()){total=spApi.getTotalCartAmount();spApi.storageData('total-cart-amount',total,{expires:1});}
if(spApi.isOnAfterPaymentPage()){spApi.setSaLog();}
if(spApi.isOnProductPage()){spApi.spAddToCart();spApi.populateVersusWeb();sQuery.cookie('ins-product-id',(spApi.getCurrentProduct()||{}).id,{expires:365,path:'/',domain:'.'+partner_site.host});}
if(spApi.isOnProductPage()||spApi.isOnCartPage()){spApi.storageData('current-currency',spApi.getCurrency(),{expires:1});}}catch(err){spApi.errLog(err,{logType:'baseInit',bugType:'partner',extraData:{noLog:noLog}});}},sendAdAudience:function(camp){if(camp.productType!=32&&camp.productType!=39&&camp.productType!=47){return;}
var roiProofGroup='';if(camp.productType==32||camp.productType==39){if(['ins-roi-experiment-impression','ins-roi-control-impression'].indexOf(spApi.storageData('paaGroup'))===-1){roiProofGroup=Math.floor(Math.random()*100)<=5?'ins-roi-control-impression':'ins-roi-experiment-impression';var logData={type:'predictiveRoiProof',predictiveRoiLogType:roiProofGroup,campId:camp.id,userID:spApi.storageData('spUID'),logType:roiProofGroup};spApi.storeLog('campLogs',logData);}else{roiProofGroup=spApi.storageData('paaGroup');spApi.conLog('PAA dashboard event already sent for 7 days interval');}
spApi.storageData('paaGroup',roiProofGroup,{path:'/',expires:7,domain:cookieDomain});}
var configuration={callback:'fbSend',callbackParams:{campId:camp.id},cookieType:'facebookAds',logMessage:'For this facebook ads campaign fbsend operation already executed. LS Info: '};if(camp.productType==32){configuration={callback:'gaSend',callbackParams:{type:'sendAdAudience',campId:camp.id},cookieType:'adaudience',logMessage:'For this Google Adwords campaign gaSend operation already executed. LS Info: '};}
var checkAudienceStatus=JSON.parse(spApi.storageData('sp-camp-'+camp.id));if(checkAudienceStatus){spApi.logger('warning',configuration.logMessage+JSON.stringify(checkAudienceStatus),camp.id);}else{var adAudienceLSData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id,table:'campLogs'};if(roiProofGroup){adAudienceLSData.obj.paaRoiSalesLogType=roiProofGroup==='ins-roi-experiment-impression'?'ins-roi-experiment-sale':'ins-roi-control-sale';}
spApi.updateCookie(adAudienceLSData,configuration.cookieType);if(roiProofGroup!=='ins-roi-control-impression'){spApi[configuration.callback](configuration.callbackParams);}}},checkSearchKeyword:function(selectedBrowser){selectedBrowser=selectedBrowser.toLowerCase();var urlOriginRegex=/^http([s]?):\/\/([a-zA-Z0-9-_\.]+)(:[0-9]+)?/;var searchEngine=(document.referrer.match(urlOriginRegex)||[])[2]||'';return searchEngine.indexOf(selectedBrowser)>-1;},checkMemberStatus:function(status){if(status=='logged'){return spApi.esQ.memberStatus.dCount>=1;}
if(status=='notlogged'){return spApi.esQ.memberStatus.dCount<1;}},lastSiteVisitCheck:function(targetCamp,logic,howManyDay){var oldDate=spApi.esQ.lastSiteVisitAggr.value;var today=parseInt(new Date()/1000);return spApi.e('(spApi.dateDifferenceCheck(today,oldDate,\'day\') '+logic+' howManyDay)');},lastPageVisitCheck:function(targetCamp,logic,howManyDay,uid){var oldDate=spApi.esQ['lastPageVisitDateAggr_'+uid].value;var today=parseInt(new Date()/1000);return spApi.e('(parseInt(spApi.dateDifferenceCheck(today,oldDate)) '+logic+' howManyDay)');},isFirstPageVisitCheck:function(targetCamp,logic,howManyDay,uid){var oldDate=spApi.esQ['lastPageVisitDateAggr_'+uid].value;var today=parseInt(new Date()/1000);return spApi.dateDifferenceCheck(today,oldDate,'second')<0;},averagePageTimeCheck:function(targetCamp,variable,logic,tType,uid){var val=spApi.esQ['averagePageTimeAggr__'+uid].value;var _temp=0;switch(tType){case'second':_temp=val*1;break;case'minute':_temp=val/60;case'hour':_temp=(val/60)/60;}
return spApi.e('(variable '+logic+' temp)');},averageSiteTimeCheck:function(targetCamp,variable,logic,tType){var val=spApi.esQ['averageSiteTimeAggr'].value;var _temp=0;switch(tType){case'second':_temp=val*1;break;case'minute':_temp=val/60;break;case'hour':_temp=(val/60)/60;break;}
return spApi.e('( _temp '+logic+' variable )');},checkPageViewCount:function(targetCamp,logic,howMany,uid){var val=spApi.esQ['pageViewCountAggr_'+uid].dCount;return spApi.e('(val '+logic+' '+howMany+')');},checkTotalVisitCount:function(targetCamp,logic,howMany){var val=spApi.esQ['totalVisitAggr'].dCount;return spApi.e('(val '+logic+' '+howMany+')');},checkVisitFrequency:function(targetCamp,logic,howMany,uid){var val=spApi.esQ['visitFrequencyAggr_'+uid].dCount;return spApi.e('(val '+logic+' '+howMany+')');},getPastCartAmount:function(logic,price,sStatus,uid){if(sStatus=='sale'){if(spApi.esQ['success_'+uid].dCount==spApi.esQ['cart_'+uid].dCount){return spApi.e('(spApi.esQ[\'success_\'+uid].value '+logic+' '+price+')');}else{return false;}}else if(sStatus=='not-sale'){if(spApi.esQ['success_'+uid].dCount!=spApi.esQ['cart_'+uid].dCount){return spApi.e('(spApi.esQ[\'cart_\'+uid].value '+logic+' '+price+')');}
else{return false;}}},getPastCartProductCount:function(logic,c,sStatus,uid){if(sStatus=='sale'){if(spApi.esQ['success_'+uid].dCount==spApi.esQ['cart_'+uid].dCount){return spApi.e('(spApi.esQ[\'success_\'+uid].dCount '+logic+' '+c+')');}else{return false;}}else if(sStatus=='not-sale'){if(spApi.esQ['success_'+uid].dCount!=spApi.esQ['cart_'+uid].dCount){return spApi.e('(spApi.esQ[\'cart_\'+uid].value '+logic+' '+c+')');}
else{return false;}}},getPastSuccessAmount:function(logic,price,uid){var val=spApi.esQ['sellAmountAggr_'+uid].value;return spApi.e('(price '+logic+' val)');},getPastSuccessCount:function(logic,c,uid){var val=spApi.esQ['sellAmountAggr_'+uid].dCount;return spApi.e('(price '+logic+' val)');},isDirectAccess:function(){return document.referrer==='';},convertNumberToBoolean:function(n){return n>0;},checkReferrerData:function(searchKey){if(!searchKey){return JSON.parse(spApi.localStorageGet('ins-sourceUrl')||'{}').data||'';}
return(JSON.parse(spApi.localStorageGet('ins-sourceUrl')||'{}').data||'').indexOf(searchKey)>-1;},checkParameterData:function(searchKey){if(!searchKey){return JSON.parse(spApi.localStorageGet('inLanding')||'{}').data||'';}
if(window.inLanding===undefined){if(JSON.parse(spApi.localStorageGet('inLanding')).data.indexOf(searchKey)>-1){window.inLanding=true;return true;}
else{return sQuery.cookie('landingFlag')=='true';}}else{if(spApi.localStorageGet('inLanding')!=null&&sQuery.cookie('landingFlag')==null){if(JSON.parse(spApi.localStorageGet('inLanding')).data.indexOf(searchKey)>-1){sQuery.cookie('landingFlag','true',{path:'/',domain:'.'+partner_site.host});return true;}else{return false;}}else{if(sQuery.cookie('landingFlag')=='true'){return true;}}}},dateDifferenceCheck:function(date1,date2,dType){var result=0;if(date2===0){date2=date1;}
switch(dType){case'hour':result=((date1-date2)/60)/60;break;case'day':result=(((date1-date2)/60)/60)/24;break;case'second':result=(date1-date2);break;}
return result;},checkUserIp:function(ip){if(spApi.storageData('userLocation')!=null){var parseIpData=sQuery.parseJSON(spApi.storageData('userLocation'));return parseIpData.request===ip;}
return false;},checkOS:function(targetOs){var ua=navigator.userAgent;var uaindex;var mobileOS='x';if(ua.match(/iPad/i)||ua.match(/iPhone/i)){mobileOS='Ios';uaindex=ua.indexOf('OS ');}
else if(ua.match(/Android/i)){mobileOS='Android';uaindex=ua.indexOf('Android ');}
if(mobileOS==='iOS'&&uaindex>-1){mobileOSver=ua.substr(uaindex+3,3).replace('_','.');}
else if(mobileOS==='Android'&&uaindex>-1){mobileOSver=ua.substr(uaindex+8,3);}
if((ua.match(/Windows/i)||ua.match(/windows/i))&&mobileOS=='x'){mobileOS='Windows';uaindex=ua.indexOf('OS ');}
if((ua.match(/Mac/i)||ua.match(/mac/i))&&mobileOS=='x'){mobileOS='Mac';uaindex=ua.indexOf('OS ');}
if((ua.match(/Linux/i)||ua.match(/Linux/i))&&mobileOS=='x'){mobileOS='Linux';uaindex=ua.indexOf('OS ');}
return mobileOS===targetOs;},checkBrowser:function(targetBrowser){return targetBrowser===spApi.getBrowser();},checkCampSit:function(sitType,campId){try{var J=JSON.parse(spApi.storageData('sp-camp-'+campId));}catch(err){return false;}
switch(sitType){case'preview':return!!(J!=null&&J['step1-displayed']);break;case'notpreview':return J==null||!J['step1-displayed'];break;case'join':return!!(J!=null&&(J.liked||J.joined));break;case'previewNotjoin':return!!(J!=null&&J['step1-displayed']&&(!J.liked||!J.joined));break;case'closed':return!!(J!=null&&J['closed']);break;case'previewNotClosed':return!!(J!=null&&J['step1-displayed']&&!J['closed']);break;}},checkResolution:function(sign,dataset){var dataset=spApi.e('dataset='+dataset+';');var sHeight=screen.height;var sWidth=screen.width;var res=spApi.e('( '+sWidth+' '+sign+' '+dataset.width+' )&&( '+sHeight+' '+sign+' '+dataset.height+')');return res;},checkLocation:function(country,city){if(spApi.storageData('userLocation')!=null){var userLocation=JSON.parse(spApi.storageData('userLocation'));if(userLocation.country!=null&&userLocation.country!='null'){try{city=JSON.parse(city)}catch(e){spApi.logger('info','City is not a json object');}
var status=false;if(country.indexOf('/')>-1){var countryCodes=country.split('/');sQuery.each(countryCodes,function(index,val){if(val.trim()===userLocation.country){if(typeof city==='object'){sQuery.each(city,function(index,cityVal){if(cityVal==userLocation.geoId||cityVal==userLocation.city){status=true;}});}else if(city==='all'||city==userLocation.geoId||city==userLocation.city){status=true;}}});}else if(country==userLocation.country){if(typeof city==='object'){sQuery.each(city,function(index,cityVal){if(cityVal==userLocation.geoId||cityVal==userLocation.city){status=true;}});}else if(city=='all'||city==userLocation.geoId||city==userLocation.city){status=true;}}
return status;}}},checkAdvancedJs:function(type,param,logic){if(typeof spApiUserData!='undefined'){return spApi.e('(param '+logic+' spApiUserData[0][type])');}},checkCustomDataset:function(cookieKey,segmentName){try{var cookie=sQuery.cookie(cookieKey);if(cookie!=null){var key='customDataSet-'+segmentName;var customSet=JSON.parse(localStorage.getItem(key));if(customSet&&typeof customSet=='object'){return Boolean(customSet.status);}}
return false;}catch(err){spApi.errLog(err,{logType:'checkCustomDataset',bugType:'product'});return false;}},checkPredictiveData:function(data,logic,predictiveType,segment,lteActionId){try{var campId=spApi.userSegments[segment];if(predictiveType==='7cee7253941dc342c78c0d7dc2c075a9'){return spApi.e('true'+logic+!!spApi.assertThresholdExceeded(campId));}else if(predictiveType==='2a74b3af4a83bd052b4f55a81441e4dd'){return spApi.e('true'+logic+!!spApi.assertEngageThresholdExceeded(lteActionId,campId));}
var checkMultipleType=function(dataArray,logic,predictiveType){if(typeof dataArray!=='object'&&dataArray.length===0)
return false;return sQuery(dataArray).filter(function(key,value){return spApi.e('("'+value+'" '+logic+' "'+predictiveType+'")')}).get().length>0;};if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));if(predictiveType==='income'){if(spApi.isset(predictiveData.income)){return spApi.e('("'+data+'" '+logic+' "'+predictiveData.income+'")');}else{return;}}else if(predictiveType==='ltv'){if(spApi.isset(predictiveData.ltv)){return spApi.e('("'+data+'" '+logic+' "'+predictiveData.ltv+'")');}else{return;}}else if(predictiveType==='9e6d8f168a5564107d948e7fac47882b'){if(spApi.isset(predictiveData['dad82a0486d9b8da8a539cece69881fc'])){if(data==='b2c6a86e0bf541a4da75694c04876ae1'){return checkMultipleType(['6cba9b4cefcdb546a05fdc74e1c3cf4d','3dfb33f8044e5b96b3e7707fa43e1531','33bbd47e1d59325b3b334a8e2bb9b311'],'==',predictiveData['dad82a0486d9b8da8a539cece69881fc']);}else if(data==='d0b54512d9d0be45c38ac7c1349dfaed'){return checkMultipleType(['db0e0f27ecaa5b857b928d37f38d82e0','f19f571eaaaf4fd413fde0488a217578','2fabeda266129d3b46d1c8cd033dc72c'],'==',predictiveData['dad82a0486d9b8da8a539cece69881fc']);}else if(data==='91c6cd84c5d2ec4776fa74baac650575'){return checkMultipleType(['44450621366af52f7706a3fe6d427ddd','fc5288e0204b0375d4b313214c2ef419','a5700576bcb0e257411a3315957902c4'],'==',predictiveData['dad82a0486d9b8da8a539cece69881fc']);}
return spApi.e('("'+data+'" == "'+predictiveData['dad82a0486d9b8da8a539cece69881fc']+'")');}}else if(predictiveType==='b6eebe435d434012f76112e686f3ea62'&&spApi.isset(predictiveData[predictiveType])){if(data==='09418efa66982e83d811593f011b51b9'){return checkMultipleType(['8e53c628878999f8338acc9bd944587a','e4462a7552ee85fe848ed3aa11290430','d6c731754f66ece9b538a3d0bc6b0e38'],'==',predictiveData[predictiveType]);}else if(data==='975c91f25c0278a07420d886f70a9915'){return checkMultipleType(['88b87d36e5d91b815dbe5f793292c0bf','c74096524c6a1432bd281186ceab411b','03ea562100711c099d1944e5bfac909c'],'==',predictiveData[predictiveType]);}
return spApi.e('("'+data+'" == "'+predictiveData[predictiveType]+'")');}else if(predictiveType==='877e815cf3bccbae65cc49ebae5e060b'){if(spApi.isset(predictiveData['877e815cf3bccbae65cc49ebae5e060b'])){try{var discountAffinityResult=logic==='!=';sQuery.each(data,function(index,discountAffinityValue){var expression='("'+discountAffinityValue+'"'+logic+'"'+
predictiveData['877e815cf3bccbae65cc49ebae5e060b']+'")';if(logic==='!='){discountAffinityResult=discountAffinityResult&&spApi.e(expression);}else{discountAffinityResult=discountAffinityResult||spApi.e(expression);}});return discountAffinityResult;}catch(e){return false;}}}else if(predictiveType==='b712895958ea29614ca4930d7ecf7dcb'){if(spApi.isset(predictiveData['b712895958ea29614ca4930d7ecf7dcb'])){var localPredictiveConversionRange=predictiveData['b712895958ea29614ca4930d7ecf7dcb'];var currentTimestamp=(new Date()).getTime();var upperTimestamp=(new Date(localPredictiveConversionRange['5c193d31c5171bc34521d1dcffa09d2b'])).getTime();var lowerTimestamp=(new Date(localPredictiveConversionRange['4725a2941b680bc7df5951fa5e1468ed'])).getTime();if(logic==='=='){return lowerTimestamp<=currentTimestamp&&upperTimestamp>=currentTimestamp;}else if(lowerTimestamp>currentTimestamp||upperTimestamp<currentTimestamp){return true;}
return false;}}else if(predictiveType=='6b9e26b6505f8cb8002957d384130af6'){if(spApi.isset(predictiveData['6b9e26b6505f8cb8002957d384130af6'])){return spApi.e('("'+data+'" '+logic+' "'+predictiveData[predictiveType]+'")');}
return false;}else if(predictiveType==='584aa1c697a01060194a7c9339ea3a20'){if(spApi.isset(predictiveData['584aa1c697a01060194a7c9339ea3a20'])){var churnDate=(new Date(predictiveData[predictiveType])).getTime();if(isNaN(churnDate)||churnDate===0){return false;}
if(((new Date()).getTime()-churnDate)<=7*24*60*60*1000){return true;}}
return false;}
if(predictiveType){if(spApi.isset(predictiveData[predictiveType])){return spApi.e('("'+data+'" '+logic+' "'+predictiveData[predictiveType]+'")');}else{return;}}}else{return false;}}catch(err){spApi.errLog(err,{logType:'checkPredictiveData',bugType:'product'});return false;}},checkCrmAttributeData:function(attributeName,logic,value){if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));if(spApi.isset(predictiveData['a01539e61e91c0e1493336ab4303ff91'])){var crmAttribute=predictiveData['a01539e61e91c0e1493336ab4303ff91'][attributeName];var attributeType=spApi.crmAttributes[attributeName];if(typeof crmAttribute!=='undefined'){if(attributeType==='Date'){var formatedValue=value.split('/');var date=new Date(formatedValue[2]+'-'+formatedValue[1]+'-'+formatedValue[0]).getTime();return spApi.e('("'+new Date(crmAttribute.split(' ')[0]).getTime()+'" '+logic+' "'+date+'")');}else if(attributeType==='Number'){return spApi.e('('+parseInt(crmAttribute)+' '+logic+' '+parseInt(value)+')');}else if(attributeType==='String'&&logic.indexOf('indexOf')>-1){return spApi.e('"'+crmAttribute+'"'+logic.replace('()','("'+value+'")'));}
return spApi.e('("'+crmAttribute+'" '+logic+' "'+value+'")');}}}
return false;},checkPredictivePurchaseData:function(data,logic,predictiveType,from,to){try{if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));if(predictiveType=='419d0dade6bf07cea06bc6ff9b3df841'){if(spApi.isset(predictiveData['4f7e23125af862734df3851897a247bc'])){var pData=new Date(predictiveData['4f7e23125af862734df3851897a247bc']).getTime();if(logic==='cef9da3bd4f9bee7b28991bbccdbf355'){from=from*1000;to=to*1000;return spApi.e('('+pData+' >= '+from+' && '+pData+' <= '+to+')');}else{data=(new Date().getTime())-(data*24*60*60*1000);return spApi.e('('+data+' <= '+pData+')');}}}else if(predictiveType=='0d3ef5f5b4e3e56081e74494c9271cfc'){if(spApi.isset(predictiveData['0d7ea3451e3032d9e84eb21b88baafcc'])){if(logic==='cef9da3bd4f9bee7b28991bbccdbf355'){var pData=new Date(predictiveData['0d7ea3451e3032d9e84eb21b88baafcc']).getTime();from=from*1000;to=to*1000;return spApi.e('('+pData+' >= '+from+' && '+pData+' <= '+to+')');}else{var pData=new Date(predictiveData['0d7ea3451e3032d9e84eb21b88baafcc']).getTime();data=(new Date().getTime())-(data*24*60*60*1000);return spApi.e('('+data+' <= '+pData+')');}}}else if(predictiveType==='32a9de716a0783368c0929f96979edba'){if(spApi.isset(predictiveData['60fe22b01357278ea51816e7e451acb7'])){var pData=parseInt(predictiveData['60fe22b01357278ea51816e7e451acb7']);return spApi.e('('+pData+' >= parseInt('+from+') && '+pData+' <= parseInt('+to+'))');}}}
return false;}catch(err){spApi.errLog(err,{logType:'checkPredictivePurchaseData',bugType:'product'});return false;}},checkPredictiveAmountData:function(data,logic,predictiveType,from,to,amount,operator){function setAmountData(purchase_hist,type,data,from,to){var count=0;var sum=0;var avg=0;if(spApi.objKeys(purchase_hist)){sQuery.each(purchase_hist,function(orderDate,price){if(type=='cef9da3bd4f9bee7b28991bbccdbf355'){var fromDate=from*1000;var toDate=to*1000;var pDate=new Date(orderDate).getTime();if(pDate>=fromDate&&pDate<=toDate){sum+=parseInt(price);count++;}}else if(type=='9ed1773978f02ed998531812ec678f6c'){var pDate=new Date(orderDate).getTime();var lastDate=(new Date().getTime())-(data*24*60*60*1000);if(lastDate<=pDate){sum+=parseInt(price);count++;}}else{sum+=parseInt(price);count++;}});}
avg=(count>0)?Math.round(sum/count):avg;return{count:count,sum:sum,avg:avg};}
try{if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));if(typeof predictiveData['17e671ed148721dcc620185d973c3499']!=='undefined'){var result=setAmountData(predictiveData['17e671ed148721dcc620185d973c3499'],logic,data,from,to);if(predictiveType==='efff1c974ab05df8b4c000a118c92fcf'){return spApi.e('('+result.avg+' '+operator+' '+amount+')');}else if(predictiveType==='42948c039f94b67091e27374880f6ddc'){return spApi.e('('+result.sum+' '+operator+' '+amount+')');}else if(predictiveType==='e52cdb4bfc12cb51a7ced4dfe0c4a4c3'){return spApi.e('('+result.count+' '+operator+' '+amount+')');}}}
return false;}catch(err){spApi.errLog(err,{logType:'checkPredictiveAmountData',bugType:'product'});return false;}},newReturningUser:function(logics){try{var result=false;if(logics==='new'){result=(localStorage.getItem('userDateV')===null||JSON.parse(localStorage.getItem('userDateV')).length<=1);}else if(logics==='returning'){result=(JSON.parse(localStorage.getItem('userDateV'))||[]).length>1;}
return result;}catch(err){spApi.errLog(err,{logType:'newReturningUser',bugType:'product'});return false;}},checkAnalyticsSegmentByDateCount:function(pastDayCount,analyticsSegmentId,personalizationId){return false;},checkAnalyticsSegmentByDateRange:function(fromDate,toDate,analyticsSegmentId,personalizationId){return false;},checkBehavioralSegmentsByPurchasedDay:function(lastPurchasedDays,purchaseStatus){try{if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));var returnStatus=false;if(predictiveData.purchased===true){var lastPurchasedDate=new Date(''+predictiveData.last_purchase_date+'');var currentDate=new Date();var timeDiff=Math.abs(currentDate.getTime()-lastPurchasedDate.getTime());var diffDays=Math.ceil(timeDiff/(1000*3600*24));if(purchaseStatus==='true'){returnStatus=diffDays<=lastPurchasedDays;}else if(purchaseStatus==='false'){returnStatus=diffDays>=lastPurchasedDays;}}else{returnStatus=false;}}else{returnStatus=false;}
return returnStatus;}catch(err){spApi.errLog(err,{logType:'checkBehavioralSegmentsByPurchasedDay',bugType:'product'});return false;}},checkBehavioralSegmentsByPurchaseAmount:function(purchaseAmount,logic){try{if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));if(spApi.isset(predictiveData.last_purchase_amount)&&predictiveData.purchased===true){return spApi.e('("'+predictiveData.last_purchase_amount+'" '+logic+' "'+purchaseAmount+'")');}else{return false;}}else{return false;}}catch(err){spApi.errLog(err,{logType:'checkBehavioralSegmentsByPurchaseAmount',bugType:'product'});return false;}},checkProductByCategory:function(daycount,category,persId,actionType){try{var hdata=localStorage.getItem('partnerSegmentData');if(hdata!=null){hdata=JSON.parse(hdata);if(spApi.isset(hdata[persId+'-'+actionType+''])){return spApi.objKeys(hdata[persId+'-'+actionType+'']);}else{return false;}}else{return false;}}catch(err){spApi.errLog(err,{logType:'checkProductByCategory',bugType:'product'});return false;}},checkCustomSegmentRules:function(customSegmentId){return spApi.storageData('cus'+customSegmentId)!==null;},checkAdAudience:function(type,percent,personalizationId,lteActionId){try{var camp=(function(personalizationId){var currentCamp;sQuery.each(spApi.personalizationCamps[personalizationId].variations,function(index,variation){if(variation.ratio==100){currentCamp=spApi.getCamp(variation.varId).camp;}});return currentCamp;})(personalizationId);var result;if(type==='2a74b3af4a83bd052b4f55a81441e4dd'&&lteActionId&&spApi.engageActionList[lteActionId]){return!!spApi.assertEngageThresholdExceeded(lteActionId,camp.id);}else if(result=spApi.assertThresholdExceeded(camp.id)){if(typeof spApi.coeff.runSuccessCallback==='undefined'&&spApi.storageData('thresholdLogSent')===null){spApi.coeff.runSuccessCallback=true;spApi.sendThresholdLog(camp.id);}
return true;}
return false;}catch(err){spApi.errLog(err,{logType:'Ad-Audience Error.',bugType:'partner',extraData:{'function':'checkAudienceLikelihoodPurchase'}});}},checkPredictiveInterestCluster:function(interestClusterId,operator){try{if(spApi.storageData('predictiveData')!=null){var interestClusterData=JSON.parse(spApi.storageData('predictiveData'));return spApi.e('("'+interestClusterId+'" '+operator+' "'+interestClusterData['0e3297bb5285f98b10d1e9a0de82264a']+'")');}else{return false;}}catch(err){spApi.errLog(err,{logType:'Interest Cluster Rule Error',bugType:'partner',extraData:{'function':'checkInterestCluster'}});return false;}},sendThresholdLog:function(campId){var result=spApi.assertThresholdExceeded(campId);if(result&&spApi.storageData('thresholdLogSent')===null){spApi.storageData('thresholdLogSent','1',{path:'/',expires:1,domain:cookieDomain});spApi.coeff.passed=true;spApi.logger('info','Sending threshold logs...');sQuery.ajax({type:'get',url:spApi.apiUrl+'ajax.php?t=sendThresholdLog',data:{userId:spApi.storageData('spUID'),version:result.coeff.v,c:JSON.stringify(result.coeff.f),threshold:result.threshold,score:result.value,isMobile:spApi.isMobileBrowser(),sessionId:spApi.getGAStyleSesId(),campId:campId}});}},assertThresholdExceeded:function(campId){var coeffSession;var coeffWeekly;var self={};var coeff=spApi.coeff;self.setCoeff=function(){self.push(1,Number(coeffSession.cartAmount>0));self.push(2,coeffSession.count.total);self.push(3,coeffSession.theSameProduct);self.push(4,coeffSession.count.cart);self.push(5,coeffSession.mobileBrowser);self.push(6,coeffSession.landing.product);self.push(7,coeffSession.landing.cat);self.push(8,coeffSession.landing.main);self.push(9,coeffSession.landing.cart);self.push(10,(coeffSession.searchKeywords.length>0?1:0));self.push(11,Number(coeffSession.systemHour<=14&&coeffSession.systemHour>=7));self.push(12,Number(coeffSession.systemHour>14&&coeffSession.systemHour<=22));self.push(13,parseFloat(((coeffSession.duration.session/coeffSession.count.total)||0).toFixed(2)));self.push(14,coeffSession.count.cat);self.push(15,coeffSession.count.product);if(coeff.v==='3.0'){var f16Value=spApi.checkPredictiveAmountData(7,'9ed1773978f02ed998531812ec678f6c','e52cdb4bfc12cb51a7ced4dfe0c4a4c3','undefined','undefined',0,'>');var f16=Number(f16Value===true);self.push(16,f16);var f17CurrentDate=new Date();var lastSevenDays=Math.round(f17CurrentDate.setDate(f17CurrentDate.getDate()-7)/1000);var lastOneMonth=Math.round(f17CurrentDate.setDate(f17CurrentDate.getDate()-30)/1000);var f17Value=spApi.checkPredictiveAmountData('','cef9da3bd4f9bee7b28991bbccdbf355','e52cdb4bfc12cb51a7ced4dfe0c4a4c3',lastOneMonth,lastSevenDays,0,'>');var f17=Number(f17Value===true);self.push(17,f17);}
if(coeff.v>='4.0'){var f18=0;if(coeffSession.productPrices.length){f18=coeffSession.totalProductPrices/coeffSession.productPrices.length}
self.push(18,f18);var f19=0;if(coeffSession.duration.product){f19=(coeffSession.duration.longProduct*coeffSession.count.product/coeffSession.duration.product)-1;}
self.push(19,f19);var f20=0;if(coeffSession.count.total){f20=coeffSession.count.cat/coeffSession.count.total;}
self.push(20,f20);var f21=(coeffSession.count.total&&(coeffSession.count.cart/coeffSession.count.total))||0;self.push(21,f21);var f22=(coeffSession.count.total&&(coeffSession.count.product/coeffSession.count.total))||0;self.push(22,f22);self.push(23,coeffWeekly.landing.cat);self.push(24,coeffWeekly.landing.main);self.push(25,coeffWeekly.landing.product);self.push(26,coeffWeekly.landing.cart);self.push(27,coeffWeekly.duration.session);self.push(28,coeffWeekly.count.product);self.push(29,coeffWeekly.count.session);self.push(30,spApi.ThresholdModule.getRecency());self.push(31,spApi.ThresholdModule.isVisitedTodayWithDifferentSession);}};self.run=function(){if(!coeff.v){spApi.logger('warning','There is no coefficient version.',campId);return false;}
if(typeof spApi.coeff.l2pThresholdResult!=='undefined'){spApi.logger('warning','Threshold already calculated:',campId);return spApi.coeff.l2pThresholdResult;}
if(coeff.v>='4.1'){if(spApi.isMobileBrowser()){coeff.f=coeff.fMobile;coeff.i=coeff.iMobile;}else{coeff.f=coeff.fWeb;coeff.i=coeff.iWeb;}}
if(Object.keys(coeff.f).length===0){spApi.logger('warning','There is no coefficients.',campId);return false;}
if(typeof spApi.sessionInit==='undefined'){spApi.getGAStyleSesId();}
spApi.reInitOnChangeCallbacks.push(function(){spApi.coeff.l2pThresholdResult=undefined;spApi.logger('info','spApi.coeff.l2pThresholdResult set to undefined on reInitOnChange');});spApi.ThresholdModule.init();coeffSession=spApi.ThresholdModule.getCoeffSession();coeffWeekly=spApi.ThresholdModule.getCoeffWeekly();self.setCoeff();var value=0;var assert_coeff=true;var c,f,t=spApi.isMobileBrowser()?coeff.tMobile:coeff.t;Object.keys(coeff.f).forEach(function(key){c=parseFloat(coeff.f[key][0])||0;f=parseFloat(coeff.f[key][1])||0;value=value+(c*f);if(c==null||f==null||t==null)
assert_coeff=false;});if(!assert_coeff){spApi.logger('warning','null coefficient values: '+JSON.stringify(spApi.coeff),campId);return false;}
value=value+parseFloat(coeff.i);value=1/(1+Math.pow(Math.E,-1*value));var threshold=parseFloat(t);if(spApi.debugModeIsOpen()){spApi.coeff.score=value;}
spApi.logger('warning','value: '+value+', threshold:'+threshold,campId);spApi.coeff.l2pMid=false;if(value>threshold){spApi.coeff.l2pThresholdResult={coeff:coeff,value:value,threshold:threshold};}else if(value>=threshold*0.8){spApi.coeff.l2pMid=true;spApi.coeff.l2pThresholdResult=false;}else{spApi.coeff.l2pThresholdResult=false;}
return spApi.coeff.l2pThresholdResult;};self.push=function(order,value){return coeff.f[order]=[coeff.f[order][0],value];};return self.run();},assertEngageThresholdExceeded:function(lteActionId,campId){var self={};var coeffSession;var coeffWeekly;var coeff;var lteActionName;var getLTEThresholdResult=function(){return spApi.engageActionList[lteActionId].lteThresholdResult;};var setLTEThresholdResult=function(result){spApi.engageActionList[lteActionId].lteThresholdResult=result;};self.setCoeff=function(){coeff.f[1]*=Number(coeffSession.cartAmount>0);coeff.f[2]*=coeffSession.count.total;coeff.f[3]*=coeffSession.theSameProduct;coeff.f[4]*=coeffSession.count.cart;coeff.f[5]*=coeffSession.mobileBrowser;coeff.f[6]*=coeffSession.landing.product;coeff.f[7]*=coeffSession.landing.cat;coeff.f[8]*=coeffSession.landing.main;coeff.f[9]*=coeffSession.landing.cart;coeff.f[10]*=coeffSession.searchKeywords.length?1:0;coeff.f[11]*=Number(coeffSession.systemHour<=14&&coeffSession.systemHour>=7);coeff.f[12]*=Number(coeffSession.systemHour>14&&coeffSession.systemHour<=22);coeff.f[13]*=parseFloat(((coeffSession.duration.session/coeffSession.count.total)||0).toFixed(2));coeff.f[14]*=coeffSession.count.cat;coeff.f[15]*=coeffSession.count.product;coeff.f[16]*=0;coeff.f[17]*=0;coeff.f[18]*=coeffSession.productPrices.length?(coeffSession.totalProductPrices/coeffSession.productPrices.length):0;coeff.f[19]*=coeffSession.duration.product?((coeffSession.duration.longProduct*coeffSession.count.product/coeffSession.duration.product)-1):0;coeff.f[20]*=coeffSession.count.total?(coeffSession.count.cat/coeffSession.count.total):0;coeff.f[21]*=coeffSession.count.total?(coeffSession.count.cart/coeffSession.count.total):0;coeff.f[22]*=coeffSession.count.total?(coeffSession.count.product/coeffSession.count.total):0;coeff.f[23]*=coeffWeekly.landing.cat;coeff.f[24]*=coeffWeekly.landing.main;coeff.f[25]*=coeffWeekly.landing.product;coeff.f[26]*=coeffWeekly.landing.cart;coeff.f[27]*=coeffWeekly.duration.session;coeff.f[28]*=coeffWeekly.count.product;coeff.f[29]*=coeffWeekly.count.session;coeff.f[30]*=spApi.ThresholdModule.getRecency();coeff.f[31]*=spApi.ThresholdModule.isVisitedTodayWithDifferentSession;coeff.f[32]*=0;};self.sendLikelihoodToEngageThresholdLog=function(){var thresholdLogName='lteThresholdLogSend-id-'+lteActionId;spApi.logger('info',lteActionName+' sending likelihood to engage threshold logs.');if(spApi.storageData(thresholdLogName)){return false;}
spApi.storageData(thresholdLogName,'1',{path:'/',expires:1,domain:cookieDomain});var likelihoodToEngageResult=getLTEThresholdResult();sQuery.ajax({type:'post',url:'https://hit.api.useinsider.com/hit',data:{event:'ccp',event_type:'high_'+lteActionId,date:spApi.getTime(),partner_name:'holodilnik',user_id:spApi.storageData('spUID'),session_id:spApi.getGAStyleSesId(),attributes:{c:JSON.stringify(likelihoodToEngageResult.coeff.f),score:likelihoodToEngageResult.value,threshold:likelihoodToEngageResult.threshold,isMobile:spApi.isMobileBrowser()}}});spApi.gaSend({type:'ccp',campId:campId,actionId:lteActionId});};self.run=function(){var platform=spApi.isMobileBrowser()?'mobile':'web';var lteAction=spApi.engageActionList[lteActionId];if(!lteAction){spApi.logger('warning','LTE is not defined: LTE id:'+lteActionId);return false;}
if(!lteAction[platform]){spApi.logger('warning','LTE metadata is not defined for:'+platform+'. LTE id:'+lteActionId);return false;}
if(lteAction[platform].length===0){spApi.logger('warning','LTE metadata is empty for:'+platform+'. LTE id:'+lteActionId);return false;}
lteActionName=lteAction['name'];if(typeof lteAction['lteThresholdResult']!=='undefined'){spApi.logger('warning','LTE threshold already calculated, LTE: '+lteActionName);return getLTEThresholdResult();}
spApi.reInitOnChangeCallbacks.push(function(){setLTEThresholdResult(undefined);spApi.logger('info',lteActionName+' lteThresholdResult set to undefined on reInitOnChange');});coeff=sQuery.extend(true,{},lteAction[platform]);spApi.ThresholdModule.init(lteActionName);coeffSession=spApi.ThresholdModule.getCoeffSession();coeffWeekly=spApi.ThresholdModule.getCoeffWeekly();self.setCoeff();var clientScore=spApi.ThresholdModule.getClientScore(coeff);spApi.logger('warning','LTE name:'+lteActionName+' value: '+clientScore+', threshold:'+coeff.threshold);if(clientScore>parseFloat(coeff.threshold)){setLTEThresholdResult({coeff:coeff,value:clientScore,threshold:coeff.threshold});self.sendLikelihoodToEngageThresholdLog();}else{setLTEThresholdResult(false);}
return getLTEThresholdResult();};return self.run();},ThresholdModule:new function(){var currentDate;var storageName;var coeffHolder;var coeffSession;var coeffDaily;var coeffWeekly;var defaultCoefficientValues={count:{main:0,product:0,cat:0,cart:0,total:0,session:0,lastSession:0,productSession:0,totalSession:0},landing:{main:0,product:0,cat:0,cart:0,other:0},duration:{session:0,lastSession:0}};var getDateString=function(day){return new Date(new Date().setDate(new Date().getDate()+day)).toDateString();};var validateRule=function(ruleType){switch(ruleType){default:return false;case'main':return spApi.isOnMainPage();case'product':return spApi.isOnProductPage();case'cat':return spApi.isOnCategoryPage();case'cart':return spApi.isOnCartPage();case'camount':return parseFloat(spApi.getTotalCartAmount())||parseFloat(spApi.storageData('total-cart-amount'))||0;case'mobile':return spApi.isMobileBrowser();}};var getCurrentPageType=function(){if(spApi.isOnMainPage()){return'main';}else if(spApi.isOnProductPage()){return'product';}else if(spApi.isOnCategoryPage()){return'cat';}else if(spApi.isOnCartPage()){return'cart';}
return'other';};var coeffHelperFunctions={setIsVisitedTodayWithDifferentSession:function(){if(!spApi.storageData('ins-today-sId')){spApi.storageData('ins-today-sId',spApi.getGAStyleSesId(),{expires:1});}else if(spApi.storageData('ins-today-sId')!==spApi.getGAStyleSesId()){this.isVisitedTodayWithDifferentSession=1;}},setCoeffSessionCartAmountOrCartItemCount:function(){coeffSession.cartAmount=parseFloat(spApi.getCartCount()||spApi.getTotalCartAmount()||spApi.storageData('total-cart-amount')||0);},setCoeffSessionSearchKeywords:function(){coeffSession.searchKeywords=coeffSession.searchKeywords||spApi.getSearchKeyWords()||'';},setCoeffSessionVisitedProductPrices:function(){if(validateRule('product')&&spApi.getCurrentProduct().price){coeffSession.totalProductPrices+=parseFloat(spApi.getCurrentProduct().price);coeffSession.productPrices.push(parseFloat(spApi.getCurrentProduct().price));}},setCoeffSessionVisitedProducts:function(){if(validateRule('product')){var id=spApi.getCurrentProduct().id;if(coeffSession.visitedProducts.indexOf(id)===-1){id!==null&&coeffSession.visitedProducts.push(id);}else{coeffSession.theSameProduct=1;}}},setLandingPageType:function(){if(coeffSession.landing.active){return;}
var pageType=getCurrentPageType();coeffSession.landing.active=pageType;coeffSession.landing[pageType]=1;coeffDaily[currentDate]['landing'][pageType]++;},setPageVisitCountForEachPageType:function(){var coeffSessionCount=coeffSession.count;if(coeffSessionCount.product===0&&coeffSessionCount.total===0){coeffDaily[currentDate].count.product+=coeffDaily[currentDate].count.productSession;coeffDaily[currentDate].count.total+=coeffDaily[currentDate].count.totalSession;}
Object.keys(coeffSessionCount).forEach(function(pageType){if(validateRule(pageType)){coeffSessionCount[pageType]++;}
if(pageType==='total'){coeffSessionCount.total++;}});coeffDaily[currentDate].count.totalSession=coeffSessionCount.total;coeffDaily[currentDate].count.productSession=coeffSessionCount.product;},setTotalSessionDuration:function(){var currentTime=new Date().getTime();if(!coeffSession.duration.fTimeSession){coeffSession.duration.fTimeSession=currentTime;}
var sessionDuration=(currentTime-coeffSession.duration.fTimeSession)/1000;coeffSession.duration.session=Math.round(sessionDuration);},setProductPageDuration:function(){var visitTime=coeffSession.duration.fTimeProduct;if(visitTime!==0){coeffSession.duration.fTimeProduct=0;coeffSession.duration.product+=Math.round((new Date().getTime()-visitTime)/1000);}
if(validateRule('product')&&coeffSession.duration.fTimeProduct===0){coeffSession.duration.fTimeProduct=new Date().getTime();}},setLongestTimeOnProductPageDuration:function(){var visitTime=coeffSession.duration.fTimeLongProduct;if(visitTime){coeffSession.duration.fTimeLongProduct=0;var productTime=Math.round((new Date().getTime()-visitTime)/1000);if(productTime>coeffSession.duration.longProduct){coeffSession.duration.longProduct=productTime;}}
if(validateRule('product')&&coeffSession.duration.fTimeLongProduct===0){coeffSession.duration.fTimeLongProduct=new Date().getTime();}},setWeeklyTotalSessionDuration:function(){var lastSession=coeffDaily[currentDate].duration.lastSession;coeffDaily[currentDate].duration.lastSession=coeffSession.duration.session;if(coeffDaily[currentDate].duration.lastSession===0){coeffDaily[currentDate].duration.session+=lastSession;}},setWeeklySessionCount:function(){var lastSession=coeffDaily[currentDate].count.lastSession;coeffDaily[currentDate].count.lastSession=coeffSession.duration.session>0?1:0;if(coeffDaily[currentDate].count.lastSession===0){coeffDaily[currentDate].count.session+=lastSession;}}};var calculateCoeffSession=function(){var storageCoeffSession=spApi.storageData(storageName.session);if(spApi.sessionInit||!storageCoeffSession){spApi.storageData(storageName.session,coeffHolder.session);return coeffHolder.session;}
return JSON.parse(storageCoeffSession);};var calculateCoeffDaily=function(){var lastSixDays=[];var coeffDailyLocal;var coeffDailyLocalTemporary=JSON.parse(spApi.storageData(storageName.daily));if(coeffDailyLocalTemporary){coeffDailyLocal=coeffDailyLocalTemporary;}else{spApi.storageData(storageName.daily,coeffHolder.daily);coeffDailyLocal=coeffHolder.daily}
for(var i=0;i>-7;i--){lastSixDays.push(getDateString(i));if(typeof coeffDailyLocal[getDateString(i)]==='undefined'){coeffDailyLocal[getDateString(i)]=sQuery.extend(true,{},defaultCoefficientValues);}}
Object.keys(coeffDailyLocal).forEach(function(key){if(lastSixDays.indexOf(key)===-1){delete coeffDailyLocal[key];}});return coeffDailyLocal;};var calculateCoeffWeekly=function(){var coeffWeeklyResult=sQuery.extend(true,{},defaultCoefficientValues);Object.keys(coeffDaily).forEach(function(date){Object.keys(coeffDaily[date]).forEach(function(coefficientMainProperty){Object.keys(coeffDaily[date][coefficientMainProperty]).forEach(function(coefficientSubProperty){coeffWeeklyResult[coefficientMainProperty][coefficientSubProperty]+=coeffDaily[date][coefficientMainProperty][coefficientSubProperty];});});if(date!==currentDate){if(coeffDaily[date].duration.session>0){coeffWeeklyResult.duration.session+=coeffDaily[date].duration.lastSession;}
if(coeffDaily[date].count.total>0){coeffWeeklyResult.count.total+=coeffDaily[date].count.totalSession;}
if(coeffDaily[date].count.product>0){coeffWeeklyResult.count.product+=coeffDaily[date].count.productSession;}}});return coeffWeeklyResult;};this.isVisitedTodayWithDifferentSession=0;this.init=function(storageSuffixName){currentDate=getDateString(0);storageSuffixName=storageSuffixName?'-'+storageSuffixName:'';storageName={session:'insCoeffSession'+storageSuffixName,daily:'insCoeffDaily'+storageSuffixName};coeffHolder={session:{count:{main:0,product:0,cat:0,cart:0,total:0},landing:{active:'',main:0,product:0,cat:0,cart:0,other:0},duration:{session:0,product:0,longProduct:0,fTimeSession:0,fTimeProduct:0,fTimeLongProduct:0},totalProductPrices:0,productPrices:[],systemHour:new Date().getUTCHours(),searchKeywords:'',mobileBrowser:Number(spApi.isMobileBrowser())||0,cartAmount:0,visitedProducts:[],theSameProduct:0},daily:(function(){var daily={};for(var i=0;i>-7;i--){daily[getDateString(i)]=sQuery.extend(true,{},defaultCoefficientValues);}
return daily;}())};coeffSession=calculateCoeffSession();coeffDaily=calculateCoeffDaily();coeffHelperFunctions.setIsVisitedTodayWithDifferentSession();coeffHelperFunctions.setCoeffSessionCartAmountOrCartItemCount();coeffHelperFunctions.setCoeffSessionSearchKeywords();coeffHelperFunctions.setCoeffSessionVisitedProductPrices();coeffHelperFunctions.setCoeffSessionVisitedProducts();coeffHelperFunctions.setLandingPageType();coeffHelperFunctions.setPageVisitCountForEachPageType();coeffHelperFunctions.setTotalSessionDuration();coeffHelperFunctions.setProductPageDuration();coeffHelperFunctions.setLongestTimeOnProductPageDuration();coeffHelperFunctions.setWeeklyTotalSessionDuration();coeffHelperFunctions.setWeeklySessionCount();coeffWeekly=calculateCoeffWeekly();spApi.storageData(storageName.session,coeffSession);spApi.storageData(storageName.daily,coeffDaily,{expires:7});};this.getCoeffSession=function(){return coeffSession;};this.getCoeffWeekly=function(){return coeffWeekly;};this.getClientScore=function(coefficients){var value=0;Object.keys(coefficients.f).forEach(function(key){value=value+parseFloat(coefficients.f[key]);});value=value+parseFloat(coefficients.intercept);return 1/(1+Math.pow(Math.E,-1*value));};this.getRecency=function(){var recency=0;var visitTime=new Date().getTime();if(spApi.sessionInit){coeffSession.lastVisitTime=(spApi.storageData('lastVisitTime')||0);spApi.storageData('lastVisitTime',visitTime,{expires:360});}
if(coeffSession.lastVisitTime>0){var secondsBetweenLast2Session=(visitTime-coeffSession.lastVisitTime)/1000;recency=Math.pow(1-(secondsBetweenLast2Session/56/86400),10);recency=recency<0?0:recency;}
return recency;};},facebookMessenger:{campaigns:[],userRef:Math.random().toString(36).substr(2),apiVersion:'v3.2',appId:'226371781276170'},personalizationSetStatus:false,preferredCurrency:"RUB",supportedCurrencies:{"RUB":{"RUB":"1.00000"}},shownCampLimit:{"status":0,"maxCount":3,"timeSpan":1},genDate:1588470576,apiUrl:protocol+"holodilnik.api.useinsider.com/",staticUrl:protocol+"static.api.useinsider.com/",frameUrl:"https://holodilnik.api.useinsider.com/frame.php",target:sQuery("#partnerTarget"),camps:[{"id":"127","campName":"|-x-|dGVzdDQy","showIn":{"trigger":[281]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"1","targetingCamp":"-1","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586173620","activeDateEnd":"1588765620","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"14","productAlias":"web-versus","isVersus":"1","isSocialProof":"0","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"web","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"130","campName":"|-x-|VmFyaWF0aW9uJTIwLSUyMDM1NzEwNDUz","showIn":{"trigger":[283]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"ru_RU","isVisible":"1","targetingCamp":"-1","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586173920","activeDateEnd":"1588765920","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"14","productAlias":"mobile-versus","isVersus":"0","isSocialProof":"0","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"mobile","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"132","campName":"|-x-|dGVzdDQyNTQ0NA==","showIn":{"trigger":[285]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"ru_RU","isVisible":"1","targetingCamp":"-1","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586174160","activeDateEnd":"1588766160","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"14","productAlias":"mobile-versus","isVersus":"0","isSocialProof":"0","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"mobile","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"134","campName":"|-x-|TFRQJTNBSGlnaA==","showIn":{"segment":[286]},"hideIn":null,"isActive":"1","productType":"32","priority":"0","trigTimeOut":"0","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"1","targetingCamp":"-1","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586379600","activeDateEnd":"1811795400","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"0","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"1","productAlias":"google-audience","isVersus":"0","isSocialProof":"0","dailyDisplay":"","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"all","isLTPCampaign":true,"conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"136","campName":"|-x-|TFRQJTIwWUQlM0FIaWdo","showIn":{"segment":[287]},"hideIn":null,"isActive":"1","productType":"40","priority":"0","trigTimeOut":"0","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"1","targetingCamp":"-1","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586466000","activeDateEnd":"1748723400","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"0","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"1","productAlias":"custom-channels","isVersus":"0","isSocialProof":"0","dailyDisplay":"","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"all","isLTPCampaign":true,"conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"126","campName":"|-x-|dGVzdDQyLUNvbnRyb2wlMjBHcm91cCUyMCUyOGlkJTNBMzIlMjk=","showIn":{"trigger":[281]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"-1","targetingCamp":"0","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586173620","activeDateEnd":"1588765620","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"14","productAlias":"web-versus","isVersus":"1","isSocialProof":"0","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"web","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"128","campName":"|-x-|dGVzdDQyMzQtQ29udHJvbCUyMEdyb3VwJTIwJTI4aWQlM0EzMyUyOQ==","showIn":{"trigger":[283]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"ru_RU","isVisible":"-1","targetingCamp":"0","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586173920","activeDateEnd":"1588765920","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"14","productAlias":"mobile-versus","isVersus":"0","isSocialProof":"0","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"mobile","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"131","campName":"|-x-|dGVzdDQyNTQ0NC1Db250cm9sJTIwR3JvdXAlMjAlMjhpZCUzQTM0JTI5","showIn":{"trigger":[285]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"ru_RU","isVisible":"-1","targetingCamp":"0","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586174160","activeDateEnd":"1588766160","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"14","productAlias":"mobile-versus","isVersus":"0","isSocialProof":"0","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"mobile","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"133","campName":"|-x-|TFRQJTNBSGlnaC1Db250cm9sJTIwR3JvdXAlMjAlMjhpZCUzQTM1JTI5","showIn":{"segment":[286]},"hideIn":null,"isActive":"1","productType":"32","priority":"0","trigTimeOut":"0","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"-1","targetingCamp":"0","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586379600","activeDateEnd":"1811795400","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"0","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"1","productAlias":"google-audience","isVersus":"0","isSocialProof":"0","dailyDisplay":"","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"all","isLTPCampaign":true,"conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"135","campName":"|-x-|TFRQJTIwWUQlM0FIaWdoLUNvbnRyb2wlMjBHcm91cCUyMCUyOGlkJTNBMzYlMjk=","showIn":{"segment":[287]},"hideIn":null,"isActive":"1","productType":"40","priority":"0","trigTimeOut":"0","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"-1","targetingCamp":"0","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1586466000","activeDateEnd":"1748723400","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"0","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","saLogDuration":"336","cookieTime":"1","productAlias":"custom-channels","isVersus":"0","isSocialProof":"0","dailyDisplay":"","isTriggerable":"0","sessionBasedGoal":"0","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"all","isLTPCampaign":true,"conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0}],campaignTriggerManager:{},journeyAttributeList:[],insights:[],webPushes:[],whatsAppCampaigns:[],notificationCenterCamps:[],customSegments:[],personalizationCamps:{"32":{"variations":[{"varId":"127","ratio":"95","type":"n"},{"varId":"126","ratio":"5","type":"cg"}],"name":"|-x-|dGVzdDQy","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"33":{"variations":[{"varId":"130","ratio":"95","type":"n"},{"varId":"128","ratio":"5","type":"cg"}],"name":"|-x-|dGVzdDQyMzQ=","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"34":{"variations":[{"varId":"132","ratio":"95","type":"n"},{"varId":"131","ratio":"5","type":"cg"}],"name":"|-x-|dGVzdDQyNTQ0NA==","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"35":{"variations":[{"varId":"134","ratio":"100","type":"n"},{"varId":"133","ratio":"0","type":"cg"}],"name":"|-x-|TFRQJTNBSGlnaA==","segment":[286],"priority":"0","gaSegmentId":"","goalBuilderList":[]},"36":{"variations":[{"varId":"136","ratio":"100","type":"n"},{"varId":"135","ratio":"0","type":"cg"}],"name":"|-x-|TFRQJTIwWUQlM0FIaWdo","segment":[287],"priority":"0","gaSegmentId":"","goalBuilderList":[]}},rules:{"280":{"id":"280","name":"web-versus - 32","test":"(spApi.getVisitedProducts() || []).length > 0 && !\/MSIE|Trident\/.test(navigator.userAgent.indexOf)","test_backup":"(spApi.getVisitedProducts() || []).length > 0 && !\/MSIE|Trident\/.test(navigator.userAgent.indexOf)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","createdAt":"2020-04-06 11:47:38","updatedAt":"2020-04-28 16:08:33","weatherActive":"0","isRelational":"0"},"282":{"id":"282","name":"mobile-versus - 33","test":"(spApi.getVisitedProducts() || []).length > 0 && !\/MSIE|Trident\/.test(navigator.userAgent.indexOf)","test_backup":"(spApi.getVisitedProducts() || []).length > 0 && !\/MSIE|Trident\/.test(navigator.userAgent.indexOf)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","createdAt":"2020-04-06 11:52:35","updatedAt":"2020-04-28 16:08:33","weatherActive":"0","isRelational":"0"},"284":{"id":"284","name":"mobile-versus - 34","test":"(spApi.getVisitedProducts() || []).length > 0 && !\/MSIE|Trident\/.test(navigator.userAgent.indexOf)","test_backup":"(spApi.getVisitedProducts() || []).length > 0 && !\/MSIE|Trident\/.test(navigator.userAgent.indexOf)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","createdAt":"2020-04-06 11:56:32","updatedAt":"2020-04-28 16:08:33","weatherActive":"0","isRelational":"0"},"281":{"id":"281","name":"triggerRule-1586173658","test":"(eval(spApi.rules[\"280\"].test) === true  &&  spApi.isOnMainPage() === true)","test_backup":"(eval(spApi.rules[\"280\"].test) === true  &&  spApi.isOnMainPage() === true)","targetingTemplate":"0","relationalRule":"280","segmentId":"","docReadyOption":"0","isProcessed":"1","createdAt":"2020-04-06 11:47:38","updatedAt":"2020-04-28 16:08:33","weatherActive":"0","isRelational":"0"},"283":{"id":"283","name":"triggerRule-1586173955","test":"(eval(spApi.rules[\"282\"].test) === true  &&  spApi.isOnMainPage() === true)","test_backup":"(eval(spApi.rules[\"282\"].test) === true  &&  spApi.isOnMainPage() === true)","targetingTemplate":"0","relationalRule":"282","segmentId":"","docReadyOption":"0","isProcessed":"1","createdAt":"2020-04-06 11:52:35","updatedAt":"2020-04-28 16:08:33","weatherActive":"0","isRelational":"0"},"285":{"id":"285","name":"triggerRule-1586174192","test":"(eval(spApi.rules[\"284\"].test) === true  &&  spApi.isOnMainPage() === true)","test_backup":"(eval(spApi.rules[\"284\"].test) === true  &&  spApi.isOnMainPage() === true)","targetingTemplate":"0","relationalRule":"284","segmentId":"","docReadyOption":"0","isProcessed":"1","createdAt":"2020-04-06 11:56:32","updatedAt":"2020-04-28 16:08:33","weatherActive":"0","isRelational":"0"},"286":{"id":"286","name":"segmentRule-1586454739","test":"(spApi.checkAdAudience(\"l2p\", \"h\", 35) === true)","test_backup":"(spApi.checkAdAudience(\"l2p\", \"h\", 35) === true)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","createdAt":"2020-04-09 17:52:19","updatedAt":"2020-04-28 16:08:33","weatherActive":"0","isRelational":"0"},"287":{"id":"287","name":"segmentRule-1586510270","test":"(spApi.checkPredictiveData(\"a52970e66df1beef6d6a4b70f0929728\", \"==\", \"7cee7253941dc342c78c0d7dc2c075a9\", 36) === true)","test_backup":"(spApi.checkPredictiveData(\"a52970e66df1beef6d6a4b70f0929728\", \"==\", \"7cee7253941dc342c78c0d7dc2c075a9\", 36) === true)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","createdAt":"2020-04-10 09:17:50","updatedAt":"2020-04-28 16:08:33","weatherActive":"0","isRelational":"0"}},notifies:{"126":{"notifCpnStatus":0,"cssConfig":{"backgroundColor":"transparent","borderColor":"rgb(51, 51, 51)","borderRadius":"0px","borderWidth":"1px","height":"0","overlay":"none","overlayColor":"rgb(0, 0, 0)","overlayOpacity":"0","width":"0","shadow":"none","paginationType":"bullet","paginationNextPrev":"true","paginationActiveColor":"","paginationPassiveColor":""},"effectConfig":{},"highlightConfig":{},"locationConfig":{"position":"relative","left":"0","top":"0","type":"2","windowHeight":"651","windowWidth":"1903","selectedElement":"body > div:eq(2) > div > div:eq(10)","insertAction":"after","gridActive":"false"},"noteSettings":false,"triggerIsActive":"0","triggerSettings":false,"formConfig":"","mode":"advanced","predictiveFeedSettings":null,"content":"","socialProofSettings":null,"kkbSettings":[],"waitForKKBData":false},"127":{"notifCpnStatus":0,"cssConfig":{"background-color":"rgb(255, 255, 255)","background-image":"none","border-width":"0px","border-style":"none","border-color":"rgb(53, 61, 74)","border-radius":"0px"},"effectConfig":{},"highlightConfig":null,"locationConfig":{"type":"2","mode":"adaptive","position":"fixed","left":"0","top":"4824.587695598602","windowHeight":"674","windowWidth":"1536","windowHref":"https:\/\/www.holodilnik.ru\/","selectedElement":"body > div:eq(2) > div > div:eq(10)","insertAction":"after","frameless":"true","showAlways":"true","gridIsActive":"false","canSortable":"false"},"noteSettings":false,"triggerIsActive":"0","triggerSettings":{"status":"0","effect":"none","positionDirection":"left","image":"none","fixed":"0","showFirst":"false"},"formConfig":"null","mode":"adaptive","predictiveFeedSettings":null,"content":"","socialProofSettings":{},"kkbSettings":[],"waitForKKBData":false},"128":{"notifCpnStatus":0,"cssConfig":{"backgroundColor":"transparent","borderColor":"rgb(51, 51, 51)","borderRadius":"0px","borderWidth":"1px","height":"0","overlay":"none","overlayColor":"rgb(0, 0, 0)","overlayOpacity":"0","width":"0","shadow":"none","paginationType":"bullet","paginationNextPrev":"true","paginationActiveColor":"","paginationPassiveColor":""},"effectConfig":{},"highlightConfig":{},"locationConfig":{"position":"relative","left":"0","top":"0","type":"2","windowHeight":"651","windowWidth":"1903","selectedElement":"body > header > div:eq(1) > div > div:eq(1)","insertAction":"after","gridActive":"false"},"noteSettings":false,"triggerIsActive":"0","triggerSettings":false,"formConfig":"","mode":"advanced","predictiveFeedSettings":null,"content":"","socialProofSettings":null,"kkbSettings":[],"waitForKKBData":false},"130":{"notifCpnStatus":0,"cssConfig":{"background-color":"rgb(255, 255, 255)","background-image":"none","border-width":"0px","border-style":"none","border-color":"rgb(53, 61, 74)","border-radius":"0px"},"effectConfig":{},"highlightConfig":null,"locationConfig":{"type":"2","mode":"adaptive","position":"fixed","left":"0","top":"172.84999704360962","windowHeight":"568","windowWidth":"320","windowHref":"https:\/\/www.holodilnik.ru\/","selectedElement":"body > header > div:eq(1) > div > div:eq(1)","insertAction":"after","frameless":"true","showAlways":"true","gridIsActive":"false","canSortable":"false"},"noteSettings":false,"triggerIsActive":"0","triggerSettings":{"status":"0","effect":"none","positionDirection":"left","image":"none","fixed":"0","showFirst":"false"},"formConfig":"null","mode":"adaptive","predictiveFeedSettings":null,"content":"","socialProofSettings":{},"kkbSettings":[],"waitForKKBData":false},"131":{"notifCpnStatus":0,"cssConfig":{"backgroundColor":"transparent","borderColor":"rgb(51, 51, 51)","borderRadius":"0px","borderWidth":"1px","height":"0","overlay":"none","overlayColor":"rgb(0, 0, 0)","overlayOpacity":"0","width":"0","shadow":"none","paginationType":"bullet","paginationNextPrev":"true","paginationActiveColor":"","paginationPassiveColor":""},"effectConfig":{},"highlightConfig":{},"locationConfig":{"position":"relative","left":"0","top":"0","type":"2","windowHeight":"651","windowWidth":"1903","selectedElement":"body > footer > div:eq(3)","insertAction":"after","gridActive":"false"},"noteSettings":false,"triggerIsActive":"0","triggerSettings":false,"formConfig":"","mode":"advanced","predictiveFeedSettings":null,"content":"","socialProofSettings":null,"kkbSettings":[],"waitForKKBData":false},"132":{"notifCpnStatus":0,"cssConfig":{"background-color":"rgb(255, 255, 255)","background-image":"none","border-width":"0px","border-style":"none","border-color":"rgb(53, 61, 74)","border-radius":"0px"},"effectConfig":{},"highlightConfig":null,"locationConfig":{"type":"2","mode":"adaptive","position":"fixed","left":"0","top":"3475.7500915527344","windowHeight":"568","windowWidth":"320","windowHref":"https:\/\/www.holodilnik.ru\/","selectedElement":"body > footer > div:eq(3)","insertAction":"after","frameless":"true","showAlways":"true","gridIsActive":"false","canSortable":"false"},"noteSettings":false,"triggerIsActive":"0","triggerSettings":{"status":"0","effect":"none","positionDirection":"left","image":"none","fixed":"0","showFirst":"false"},"formConfig":"null","mode":"adaptive","predictiveFeedSettings":null,"content":"","socialProofSettings":{},"kkbSettings":[],"waitForKKBData":false}},customizationCamps:[],bannerManagementCamps:[],journeyCamps:[],journeySegments:[],activeBannerManagementCamps:[],showedBMCampOfPage:[],gaCustomVar:1,gaIsActiveCustom:1,gaServiceIsActive:1,gaNonInteraction:1,userSegments:{},gaDataLayerIsActive:0,gaDataLayerSettings:false,ajsData:{},bounceExcludeList:[""],bounceExcludeLeft:50,bounceExcludeRight:50,defaultVelocity:200,lang:[],spLang:'',conditionCheckList:[],campCallbacks:[],userBounced:false,setAddCartCountFired:false,logsStack:{},_bindedEvents:{},coeff:{"ecommerce":true,"v":"4.2","i":"0","t":"0.5837320414084282","tMobile":"0.5349769644788234","iWeb":"-2.2716421201759154","iMobile":"-1.9970385560062072","fWeb":{"1":["1.5919657987264515"],"2":["0.010160544197443677"],"3":["0.31756529368510866"],"4":["-0.062374560706516494"],"5":["0.0"],"6":["0.3819276817928528"],"7":["0.1052202129857942"],"8":["0.7691225939190434"],"9":["0.11329583655995815"],"10":["1.0358028057099509"],"11":["0.25055985686655047"],"12":["0.19803663026890694"],"13":["-9.042430638168868E-5"],"14":["0.008372332792436746"],"15":["0.0"],"16":["0.0"],"17":["0.0"],"18":["2.524289263551576E-6"],"19":["0.08099575366537108"],"20":["1.8924086999866534"],"21":["3.019501776290466"],"22":["1.43678780142423"],"23":["0.123349820619376"],"24":["0.4149268508251298"],"25":["0.0"],"26":["0.701403941130987"],"27":["9.490627905006484E-5"],"28":["0.031126354475531172"],"29":["0.016769700746755736"],"30":["-0.8892601689023738"],"31":["0.40350070082556033"],"32":["0.0"]},"fMobile":{"1":["1.5328763777462384"],"2":["0.0034471287045672143"],"3":["0.1445260528194018"],"4":["0.01432344603101376"],"5":["0.0"],"6":["0.13992286188876094"],"7":["0.0"],"8":["0.803372715962613"],"9":["0.17291711888838346"],"10":["0.8552541071568576"],"11":["0.1709323384687693"],"12":["-0.04432233813356157"],"13":["6.326453703782463E-4"],"14":["0.022483242494373907"],"15":["0.005044644255885356"],"16":["0.0"],"17":["0.0"],"18":["2.2382782073328777E-6"],"19":["0.08097901493647698"],"20":["1.2733070613654027"],"21":["2.8893266208494386"],"22":["1.4058410656012725"],"23":["0.1657206897317093"],"24":["0.26812824505245114"],"25":["-0.04233403173911757"],"26":["0.5836954128000086"],"27":["2.0616470635554583E-4"],"28":["0.03796676290896008"],"29":["0.02236543907104921"],"30":["-0.6136091090945016"],"31":["0.12436753367358962"],"32":["0.0"]}},customUserAttributes:[],productAttributes:[],crmAttributes:{},engageActionList:[],customChannelsTag:{"136":{"tagType":"Body","tagCode":"<script>yaCounter42.reachGoal(\"LTP:High\")<\/script>"}},adwordsApiTags:[],siteUrl:'http://www.holodilnik.ru/',listenerApiUrl:'https://listener.api.useinsider.com/v1/',urlParamSep:1,decryptCampName:function(campName){if(campName.indexOf('|-x-|')===0){return decodeURIComponent(window.atob(campName.substring(5)));}
return campName;},loadFramelessScripts:function(scripts){var scriptVersions={'insCountdown.min.js':'?v=1.0.3','insAnimation.min.js':'?v=1.0.1','webStory.min.js':'?v=1.0.5','inStory.min.js':'?v=1.1.7','jquery-ui.js':'?v=1.0.0'};var _arr=sQuery.map(scripts,function(script){var version=scriptVersions[script]||'';return sQuery.ajax({dataType:'script',cache:true,url:spApi.staticUrl+'js/libraries/'+script+version});});_arr.push(sQuery.Deferred(function(deferred){sQuery(deferred.resolve);}));return sQuery.when.apply(sQuery,_arr);},loadJsonFile:function(fileName,callback){try{var callbackName='jsonpCallback'+(Math.random().toString(16)+'000000000').substr(2,8);this[callbackName]=function(){};sQuery.ajax({url:spApi.apiUrl+'ajax.php?t=getJSONFile',data:{file:fileName,callback:callbackName},contentType:'application/json',dataType:'jsonp',jsonpCallback:callbackName,success:function(data){if(typeof callback==='function'){callback(data);}}});}catch(err){spApi.errLog(err,{logType:'Load Frameless Json File Error',bugType:'product',extraData:{'function':'loadFramlessJsonFile'}});}},postMessageEventIsValid:function(event){return/.api.useinsider.com$/.test(event.origin);},getUrl:function(){return window.location.href;},getAllCamps:function(){return spApi.getPrototype('allCamps');},getLogTableAlias:function(tableName){return spApi.getPrototype('logTables')[tableName];},allStorageData:function(){var pairs=[];try{var allData={};for(var i=0;i<window.localStorage.length;i++){var dataKey=window.localStorage.key(i);allData[dataKey]=window.localStorage.getItem(dataKey);}
sQuery.each(allData,function(key,val){try{var obj=JSON.parse(val);if(typeof obj.data==='object'){obj.data=JSON.stringify(obj.data);}
if(typeof obj['_expires']!=='undefined'&&obj['_expires']>Date.now()){pairs.push({'key':key,'value':obj['data']});}}
catch(e){pairs.push({'key':key,'value':val});}});}catch(err){spApi.errLog(err,{logType:'All Storage Data Error',bugType:'partner',extraData:{'function':'storageData'}});}
return pairs;},storageData:function(name,content,expireDate,callback){try{content=content!=null&&typeof content==='object'?JSON.stringify(content):content;if(typeof content==='undefined'){var currDate=new Date().getTime();var storageContent=spApi.localStorageGet(name);try{storageContent=JSON.parse(storageContent);if(typeof storageContent.data==='object'){storageContent.data=JSON.stringify(storageContent.data);}
if(storageContent!=null&&storageContent._expires>currDate){return storageContent.data;}else{var obj={action:'delete',name:name};spApi.worker.asyncPM('storageData',obj,callback);localStorage.removeItem(name);return null;}}
catch(e){return storageContent;}}else if(content==null){var obj={action:'delete',name:name};spApi.worker.asyncPM('storageData',obj,callback);localStorage.removeItem(name);return null;}else{var expires=typeof expireDate!=='undefined'?expireDate.expires:1;if(typeof expires==='object'){expires=expires.getTime();}else{var dateObj=new Date().getTime();dateObj+=1000*60*60*24*Number(expires)+10000;expires=dateObj;}
var stObj=new Object();stObj.data=typeof content==='object'?JSON.stringify(content):content;stObj._expires=expires;spApi.localStorageSet(sQuery.trim(name),JSON.stringify(stObj));if(typeof window.insdrSV==='undefined'){var version=sQuery.cookie('insdrSV')!=null?Number(sQuery.cookie('insdrSV')):0;version++;spApi.localStorageSet('insdrSV',version);sQuery.cookie('insdrSV',version,{expires:365,path:'/',domain:cookieDomain});window.insdrSV=version;}
var obj={action:'write',name:name,content:JSON.stringify(stObj)};spApi.worker.asyncPM('storageData',obj,callback);}}catch(err){spApi.errLog(err,{logType:'Data Storage Error',bugType:'partner',extraData:{'function':'storageData'}});}},_systemRuleError:function(name,func,err){var errLogStr=JSON.stringify(spApi.errLogs)||'';if(errLogStr.indexOf('"ruleName":"'+name+'"')!=-1)return;spApi.errLog(err,{logType:'System Rule Error',bugType:'partner',extraData:{ruleName:name,ruleContent:func.toString()}});},getPaidProducts:function(){try{var funcString="(function(){\nfunction formPrice(str){str=(str||'').toString();var price=0;price=str.replace(\/[^0-9.,]\/g,'');if(price.slice(-3).indexOf(',')!==-1){price=parseFloat(str.replace(\/[^0-9,]\/g,'').replace(',','.'))||0;}else if(price.slice(-3).indexOf('.')!==-1){price=parseFloat(str.replace(\/[^0-9.]\/g,''))||0;}else{price=parseFloat(str.replace(\/[^0-9]\/g,''))||0;}\nreturn price;}\nvar paidProductList={};var indexToProductId={};sQuery('.table-responsive tr:not(:first)').each(function(key,productRow){var quantity=parseInt(sQuery('.am input',productRow).val()||1);var price=formPrice(sQuery('td.prc',productRow).text());var id=formPrice((sQuery('.am input',productRow).attr('id')||1)).toString();var name=(sQuery.trim(sQuery('td:not(:first) a:first',productRow).text()));price=parseFloat(price.toFixed(2))||0;if(price!==0&&name!==''&&id!=='1'){if(!indexToProductId.hasOwnProperty(id)){indexToProductId[id]=key;}\nif(paidProductList.hasOwnProperty(id)){paidProductList[id].quantity+=quantity;}else{paidProductList[id]={id:id,name:name,price:price,originalPrice:price,img:(sQuery('td.prpic img',productRow).prop('src')||'').split('?')[0],url:sQuery('td.prpic a',productRow).prop('href')||'',quantity:quantity,time:spApi.getTime()};}}});paidProductList=Object.values(paidProductList);paidProductList.sort(function(first,after){return indexToProductId[first.id]-indexToProductId[after.id];});return paidProductList;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getPaidProducts',funcString,err);}},getCurrentProduct:function(){try{var funcString="(function(){\nfunction formPrice(str){return parseFloat((str||'').replace(\/[^0-9,]\/g,'').replace(\/,\/g,'.'))||0;}\nvar price=formPrice(sQuery('span.big:first').text())||formPrice((window.ad_product||{}).price);var product={id:(window.ad_product||{}).id||sQuery('.button_product a').attr('data-product-id')||'',name:(window.ad_product||{}).name||sQuery.trim(sQuery('.container h1:first').text()),price:price,originalPrice:formPrice(sQuery('.price_old:first').text())||price,img:(sQuery('.swiper-slide').attr('data-src')||sQuery('.swiper-slide img:first').prop('src')||'').split('?')[0],url:spApi.getUrl(),cats:spApi.getProductCategories(),quantity:sQuery('.plus1click').exists()?1:0,};if(spApi.hasParameter(window.btoa('insPriceAlert-holodilnik-5043'))){product.price=parseFloat((product.price*0.90).toFixed(0));}\nif(spApi.hasParameter(window.btoa('insStockPush-holodilnik-5043'))){product.quantity=0;}\nreturn product;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCurrentProduct',funcString,err);}},getTotalCartAmount:function(){try{var funcString="(function(){\nvar total=0;if(spApi.isOnCartPage()){sQuery.each(spApi.getPaidProducts(),function(key,product){total+=product.quantity*product.price;});}else{sQuery.each((JSON.parse(spApi.storageData('ins-cart-product-list'))||{}).productList||[],function(key,storagedItem){total+=storagedItem.price*storagedItem.quantity;});}\nreturn parseFloat(total.toFixed(2))||0;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getTotalCartAmount',funcString,err);}},isOnCartPage:function(){try{var funcString="(function(){\nreturn(spApi.hasParameter('\/basket')||spApi.hasParameter('usercp\/orders\/'))&&!spApi.hasParameter('step');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCartPage',funcString,err);}},isOnAfterPaymentPage:function(){try{var funcString="(function(){\nvar orderID=spApi.getOrderId();return(((spApi.hasParameter('orders\/new\/?step=final')||spApi.hasParameter('order\/?step=final'))&&(parseFloat(spApi.storageData('total-cart-amount'))||0)!==0)&&spApi.localStorageGet('ins-last-order-id')!==orderID&&orderID!=='0'&&orderID!=='')||spApi.afterVisibility||false;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnAfterPaymentPage',funcString,err);}},isOnProductPage:function(){try{var funcString="(function(){\nreturn sQuery('.card-product-page').exists()&&sQuery('.button_product').exists();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnProductPage',funcString,err);}},getProductCategories:function(){try{var funcString="(function(){\nfunction firstLetterToUppercase(str){return(str||'').toString().split(\/-| |\\\\n\/g).map(function(word){return word.charAt(0).toUpperCase()+word.slice(1).toLowerCase();}).join(' ');}\nvar categories=[];sQuery('.breadcrumb .breadcrumb-item:not(:first)').each(function(key,category){categories.push(sQuery.trim(firstLetterToUppercase(sQuery(category).text())));});return categories;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getProductCategories',funcString,err);}},spAddToCart:function(){try{var funcString="(function(){\nfunction setProductStorage(product,flag){spApi.storeCartProductInformation(product,{count:parseInt(product.quantity),increase:flag});spApi.storageData('total-cart-amount',spApi.getTotalCartAmount());}\nif(typeof spApi.addToCartListener==='undefined'){spApi.addToCartListener=true;var spAddToCartHandler={};spAddToCartHandler.addCartButton=sQuery('button.add-to-cart:visible').off('click.insAddToCartClick').on('click.insAddToCartClick',function(){spApi.setProductCategory();if(typeof(spApi.setCartTargetingRules)!=='undefined'){spApi.setCartTargetingRules();}});}\nreturn{addToBasket:function(productId,callback,payload){if(spApi.isOnProductPage()&&productId===spApi.getCurrentProduct().id){sQuery('button.add-to-cart:visible:first').click();}else{if(typeof(payload||{}).product==='undefined'){spApi.conLog('Addtobasket i\u00e7in payload\\'da product parametresi gerekli.');}else{sQuery.get('https:\/\/www.holodilnik.ru\/ajax\/cart.php?prodId='+productId+'&info=',function(productResponse){var html=document.createElement('div');html.innerHTML=productResponse;var payloadProduct=(payload||{}).product||{};var product={id:productId||payloadProduct.item_id||payloadProduct.id,name:payloadProduct.name,price:(typeof payloadProduct.price==='number'&&payloadProduct.price)||payloadProduct.price[spApi.getCurrency()||spApi.preferredCurrency()],originalPrice:(typeof payloadProduct.originalPrice==='number'&&payloadProduct.originalPrice)||payloadProduct.original_price[spApi.getCurrency()||spApi.preferredCurrency()],img:payloadProduct.image_url||payloadProduct.img,quantity:1,url:payloadProduct.url,time:spApi.getTime()};if(spApi.isOnCartPage()){window.location.reload();}\nsetProductStorage(product,true);});}}\n(callback||function(){});}};})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('spAddToCart',funcString,err);}},getOrderId:function(){try{var funcString="(function(){\nreturn window.ad_order||(((spApi.getDataFromDataLayer('ecommerce')).purchase||{}).actionField||{}).id||sQuery('table tr[valign=\"top\"] b:first').text();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getOrderId',funcString,err);}},useCouponButton:function(){try{var funcString="(function(){\nvar couponButton={};couponButton.button='.recount-box .btn-light';couponButton.couponInput='.recount-box .input-group > input';couponButton.couponInputText='sQuery(\".recount-box .input-group > input\").val()';couponButton.buttonClick='sQuery(\".recount-box .btn-light\").click()';return couponButton;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('useCouponButton',funcString,err);}},rsvpLocate:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('rsvpLocate',funcString,err);}},isOnMainPage:function(){try{var funcString="(function(){\nreturn window.location.pathname==='\/';})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnMainPage',funcString,err);}},isUserLoggedIn:function(){try{var funcString="(function(){\nreturn(sQuery('.item-lk a').attr('href')||'').slice(-7,-1)==='usercp';})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isUserLoggedIn',funcString,err);}},isOnRegSuccessPage:function(){try{var funcString="(function(){\nreturn false;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnRegSuccessPage',funcString,err);}},getSearchs:function(){try{var funcString="(function(){\nreturn\"[]\";})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getSearchs',funcString,err);}},getSearchKeyWords:function(){try{var funcString="(function(){\nreturn sQuery.trim(spApi.getParameter('search'))||false;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getSearchKeyWords',funcString,err);}},isCouponCodeApplied:function(){try{var funcString="(function(){\nreturn true;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isCouponCodeApplied',funcString,err);}},isOnCouponPage:function(){try{var funcString="(function(){\nreturn sQuery('.recount-box').exists();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCouponPage',funcString,err);}},isOnCategoryPage:function(){try{var funcString="(function(){\nreturn sQuery('.catalog-page').exists()||(sQuery('.static-page').exists()&&(sQuery('.preview-product').exists()||sQuery('.group-brands').exists()));})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCategoryPage',funcString,err);}},getCategories:function(){try{var funcString="(function(){\nfunction firstLetterToUppercase(str){return(str||'').toString().split(\/-| |\\\\n\/g).map(function(word){return word.charAt(0).toUpperCase()+word.slice(1).toLowerCase();}).join(' ');}\nvar categories=[];sQuery('.breadcrumb .breadcrumb-item').each(function(key,category){sQuery(category).text().trim()!==''?categories.push(firstLetterToUppercase(sQuery.trim(sQuery(category).text()))):'';});if(categories.length===0){var categorySplit=sQuery('.catalog h1:first').text().split(',')||[];sQuery(categorySplit).each(function(key,category){sQuery(category).text().trim()!==''?categories.push(firstLetterToUppercase(sQuery.trim(sQuery(category).text()))):'';});}\nif(categories.length===0){sQuery('.catalog .container h1:first').each(function(key,category){sQuery(category).text().trim()!==''?categories.push(firstLetterToUppercase(sQuery.trim(sQuery(category).text()))):'';});}\nif(categories.length===0){sQuery('.large-as-h2:first').each(function(key,category){sQuery(category).text().trim()!==''?categories.push(firstLetterToUppercase(sQuery.trim(sQuery(category).text()))):'';});}\nreturn categories.filter(function(value,index,item){return value!=='Holodilnik.ru';});})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCategories',funcString,err);}},setEmailToCookie:function(){try{var funcString="(function(){\nreturn false;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('setEmailToCookie',funcString,err);}},getLang:function(lang){try{var funcString="(function(){\nreturn'ru_RU';})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getLang',funcString,err);}},sliderSettings:function(){try{var funcString="(function(){\nreturn{isElementInSlider:function(element){return false;},getImageList:function(){var imageList=[];return imageList;},triggerClick:function(){var clickSelector='#rev_slider_1_1 .slidelink a';spApi.cstmClickHandler(clickSelector);},changeSlider:function(slide,order,logClass){if(logClass!=undefined){}}}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('sliderSettings',funcString,err);}},getCurrency:function(){try{var funcString="(function(){\nreturn'RUB';})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCurrency',funcString,err);}},triggerCartButton:function(){try{var funcString="(function(){\nvar ajaxListener=function(callback){var originalOpenFunction=XMLHttpRequest.prototype.open;if(typeof spApi.insTriggerCartButtonInitialized==='undefined'){XMLHttpRequest.prototype.open=function(method,url){originalOpenFunction.apply(this,arguments);this.addEventListener('readystatechange',function(){if(this.readyState===4&&this.status===200){if(typeof callback==='function'){try{callback(url,this.responseText,method);}catch(error){spApi.conLog('Something is crashed, Event:'+error);}}}});};spApi.insTriggerCartButtonInitialized=true;}};function documentTrigger(){setTimeout(function(){sQuery(document).trigger('changingCartCount');sQuery(document).trigger('cartAmountUpdated');},250);}\nfunction formPrice(str){str=(str||'').toString();var price=0;price=str.replace(\/[^0-9.,]\/g,'');if(price.slice(-3).indexOf(',')!==-1){price=parseFloat(str.replace(\/[^0-9,]\/g,'').replace(',','.'))||0;}else if(price.slice(-3).indexOf('.')!==-1){price=parseFloat(str.replace(\/[^0-9.]\/g,''))||0;}else{price=parseFloat(str.replace(\/[^0-9]\/g,''))||0;}\nreturn price;}\nspApi.wishlistClicked=false;sQuery('.add2cart2 a').off('click.insClick').on('click.insClick',function(){spApi.wishlistClicked=true;spApi.wishlistClosest=sQuery(this).closest('.preview-product');});function setProductStorage(product,flag){spApi.storeCartProductInformation(product,{count:parseInt(product.quantity),increase:flag});spApi.storageData('total-cart-amount',spApi.getTotalCartAmount());documentTrigger();}\nif(sQuery('.catalog-page').exists()||(sQuery('.static-page').exists()&&sQuery('.preview-product').exists())){setTimeout(function(){window.addEventListener('beforeunload',function(){spApi.localStorageSet('ins-last-order-id',spApi.getOrderId());});},250);}\nif(spApi.isOnAfterPaymentPage()){setTimeout(function(){var paidProductListStore={totalQuantity:0,productList:[]};spApi.storageData('total-cart-amount',0);spApi.storeCartProductStorage(paidProductListStore);sQuery(document).trigger('cartAmountUpdated');},3000);}\nif((spApi.hasParameter('orders\/new\/?step=final')||spApi.hasParameter('order\/?step=final'))&&(parseFloat(spApi.storageData('total-cart-amount'))||0)!==0){setTimeout(function(){var orderID=spApi.getOrderId();if(spApi.localStorageGet('ins-last-order-id')!==orderID&&orderID!=='0'&&orderID!==''){spApi.afterVisibility=true;}\nspApi.localStorageSet('ins-last-order-id',orderID);},1000);}\najaxListener(function(url){if(url.indexOf('ajax\/cart.php?prodI')!==-1&&spApi.isOnProductPage()){var product=spApi.getCurrentProduct();delete product.cats;product.time=spApi.getTime();setProductStorage(product,true);documentTrigger();}else if(url.indexOf('ajax\/cart.php?prodI')!==-1&&spApi.isOnCategoryPage()&&spApi.wishlistClicked){var html=spApi.wishlistClosest;var price=formPrice(sQuery('.price:first',html).text());var product={id:sQuery('.add2cart2 a',html).attr('data-product-id')||'',name:sQuery.trim(sQuery('.product-name [itemprop=\"name\"]',html).text()),price:price,originalPrice:formPrice(sQuery('.price_old:first',html).text())||price,img:(sQuery('.img-fluid',html).prop('src')||'').split('?')[0],url:spApi.getUrl(),quantity:1,time:spApi.getTime(),};setProductStorage(product,true);}});})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('triggerCartButton',funcString,err);}},getCartCount:function(){try{var funcString="(function(){\nvar count=0;if(spApi.isOnCartPage()){sQuery.each(spApi.getPaidProducts(),function(key,product){count+=product.quantity;});}else{count=parseInt((sQuery.parseJSON(spApi.storageData('ins-cart-product-list'))||{}).totalQuantity)||0;}\nreturn count;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCartCount',funcString,err);}},categorySettings:function(){try{var funcString="(function(){\nreturn{getCategoryList:function(){var categoryList=[];return categoryList;},triggerClick:function(){spApi.categoryClickHandler(\"#menu ul.navbar-nav > li > a\");},changeCategory:function(category,fromIndex,toIndex,logClass){if(fromIndex>toIndex){}else{}\nif(logClass!=undefined){}},getElementCategoryText:function(element){return sQuery(element).text();}}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('categorySettings',funcString,err);}},getLocale:function(){try{var funcString="(function(){\nreturn spApi.getLang();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getLocale',funcString,err);}},setCouponAsistant:function(couponSet,fromPurcha){},setProductCategory:function(){try{var currentProduct=spApi.getCurrentProduct();var category=sQuery.map(spApi.getProductCategories(),function(val,index){var str=val;return str;}).join("|");var p={cat:category,name:currentProduct.name,id:currentProduct.id};var encoded=spApi.storageData('prodCats');var prodCats=[];if(encoded){prodCats=JSON.parse(encoded);}
for(i in prodCats){if(prodCats[i].name==p.name){prodCats.splice(i,1);}}
prodCats.push(p);spApi.storageData('prodCats',sQuery.toJSON(prodCats),{expires:1,path:'/',domain:cookieDomain});}
catch(err){spApi.errLog(err,{logType:'setProductCategory',bugType:'product'});}},spRefId:"_spRefCode",urlencode:function(str){str=(str+'').toString();return encodeURIComponent(str).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/%20/g,'+');},getAppliedCode:function(campId){var couponCode='';var cookieData=JSON.parse(spApi.storageData('sp-noteTimer'));if(cookieData!=null&&cookieData['cId']!=undefined&&cookieData['cId']==campId){if(cookieData['code']!=undefined&&cookieData['couponApply']!=undefined&&cookieData['couponApply']=='applied'){if(cookieData['encoded']!=undefined&&cookieData['encoded']=='true'){couponCode=spApi.Base64.decode(cookieData['code']);}else{couponCode=cookieData['code'];}}}
return couponCode;},updateTotalCartAmount:function(price,increase){var totalAmount=Number(spApi.storageData('total-cart-amount'))||0;spApi.storageData('total-cart-amount',increase?(totalAmount+Number(price)):(totalAmount-Number(price)>0?(totalAmount-Number(price)):0),{expires:1});sQuery(document).trigger('cartAmountUpdated');},storeCartProductStorage:function(productList){var cartProductsStorageName='ins-cart-product-list';var twelveHoursAsMilliSeconds=60*60*12*1000;var date=new Date();date.setTime(date.getTime()+twelveHoursAsMilliSeconds);spApi.storageData(cartProductsStorageName,productList,{expires:date,domain:cookieDomain,path:'/'});},getCartProductStorage:function(){return spApi.cachedProductList||((sQuery.parseJSON(spApi.storageData('ins-cart-product-list'))||{}).productList)||[];},storeCartProductInformation:function(productInformation,quantityConfig){if(typeof productInformation==='undefined'&&productInformation.id===undefined){return;}
var cartProductsStorageName='ins-cart-product-list';var currentProductList=JSON.parse(spApi.storageData(cartProductsStorageName)||'{"totalQuantity": 0, "productList": []}');productInformation.quantity=productInformation.quantity||1;function adjustQuantityOfProduct(){var existingProduct=findMatchingProduct();if(Object.keys(existingProduct).length>0){if(typeof quantityConfig.increase!=='undefined'&&quantityConfig.increase){existingProduct.quantity+=Number(quantityConfig.count);productInformation=existingProduct;}else if(existingProduct.quantity>0&&typeof quantityConfig.increase!=='undefined'&&!quantityConfig.increase){existingProduct.quantity-=Number(quantityConfig.count);productInformation=existingProduct;}}else{productInformation.quantity=Number(quantityConfig.count);}}
function findMatchingProduct(){var foundProduct={};currentProductList.productList.map(function(product){if(product.id!==undefined&&product.id===productInformation.id){foundProduct=product;}});return foundProduct;}
function setTotalQuantity(){var totalQuantity=0;removeProductsWithoutQuantity();currentProductList.productList.forEach(function(product){if(product.id!==undefined){totalQuantity+=product.quantity;}});currentProductList.totalQuantity=totalQuantity;}
function removeProductsWithoutQuantity(){currentProductList.productList=currentProductList.productList.filter(function(product){return product.quantity>0;});}
adjustQuantityOfProduct();if(Object.keys(findMatchingProduct()).length===0){currentProductList.productList.push(productInformation);}
setTotalQuantity();spApi.storeCartProductStorage(currentProductList);sQuery(document).trigger('changingCartCount');},updateCartCount:function(count){var cartProductsStorageName='ins-cart-product-list';var currentCartProductList=JSON.parse(spApi.storageData(cartProductsStorageName)||'{}');currentCartProductList.totalQuantity=count;currentCartProductList.productList=spApi.getPaidProducts();spApi.storeCartProductStorage(currentCartProductList);sQuery(document).trigger('cartAmountUpdated');},updateCartCookies:function(){var pProd=spApi.getPaidProducts();var date=new Date();date.setTime(date.getTime()+(30*60*1000));spApi.storageData('paid-products',JSON.stringify(pProd),{expires:date,path:'/',domain:cookieDomain});spApi.storageData('total-cart-amount',spApi.getTotalCartAmount(),{expires:1});spApi.storageData('current-currency',spApi.getCurrency(),{expires:1});},stringToCurrency:function(currency){try{currency=currency.replace(/^\s+|\s+$/g,'').toUpperCase();var search=['TL','YTL','','EURO','$','DLAR','','','','','','EU','US','Z','',''];var change=['TRY','TRY','EUR','EUR','USD','USD','GBP','RUB','RUB','RUB','TRY','EUR','USD','PLN','JPY','RSD'];sQuery.each(search,function(key,value){currency=(search[key]==currency)?currency.replace(search[key],change[key]):currency;});return currency;}catch(err){spApi.errLog(err);}},setExchangeRate:function(fromCurrency,toCurrency,price){try{if(fromCurrency!=toCurrency&&fromCurrency!=''&&toCurrency!=''){price=(price!=null&&typeof(price)!="number")?price.replace(/[^0-9.,]/g,''):price;if(typeof spApi.webPushUtilities==='object'){spApi.webPushUtilities.unconvertedCurrentPrice=price;}
if(price!=null&&!isNaN(price)){if(spApi.supportedCurrencies[fromCurrency]!=undefined){if(spApi.supportedCurrencies[fromCurrency][toCurrency]!=undefined)
return(Math.round(spApi.supportedCurrencies[fromCurrency][toCurrency]*price*1000)/1000);}
if(spApi.supportedCurrencies[toCurrency]!=undefined){if(spApi.supportedCurrencies[toCurrency][fromCurrency]!=undefined)
return(Math.round((1/spApi.supportedCurrencies[toCurrency][fromCurrency])*price*1000)/1000);}}}
return price;}catch(err){spApi.errLog(err);}},getExchangeRate:function(fromCurrency,toCurrency,data,element){var checkAndSetExchangeRate=function(data,element,index){var baseObject=data;if(typeof index!=='undefined'){baseObject=data[index];}
if(element==='price'){baseObject['notConvertedPrice']=baseObject[element];}
baseObject[element]=spApi.setExchangeRate(fromCurrency,toCurrency,baseObject[element]);return baseObject};try{switch(typeof data){case'number':var convertedPrice=spApi.setExchangeRate(fromCurrency,toCurrency,data);break;case'string':var convertedPrice=(isNaN(data))?data:spApi.setExchangeRate(fromCurrency,toCurrency,parseFloat(data));break;case'object':if(data!=null){if(data.length===undefined){if(data.hasOwnProperty(element)){data=checkAndSetExchangeRate(data,element);}else if(element instanceof Array){element.forEach(function(element){data=checkAndSetExchangeRate(data,element);});}}else{for(var i=0;i<data.length;i++){if(data[i].hasOwnProperty(element)){data[i]=checkAndSetExchangeRate(data,element,i);}else if(element instanceof Array){element.forEach(function(element){data[i]=checkAndSetExchangeRate(data,element,i);});}}}}
var convertedPrice=data;break;default:var convertedPrice=data;}
return convertedPrice;}catch(err){spApi.errLog(err);}},writeConsoleLog:function(){try{if(typeof spApi.consoleLog==='object'){sQuery(spApi.consoleLog).each(function(id,text){spApi.logger('info',text);});}}catch(err){spApi.errLog(err,{logType:'writeConsoleLog',bugType:'product'});}},getCampSalesSesInfo:function(campId,objType,productType){try{campId=((productType=='20')&&(campId.toString().indexOf('c')==-1))?'c'+campId:campId;var cmp=spApi.storageData('sp-camp-'+campId);if(cmp==null||cmp==undefined){return'0';}else{var obj=JSON.parse(cmp);return(obj[objType]==undefined)?'0':obj[objType];}}catch(err){spApi.errLog(err);}},getBuilderIdFromVar:function(campId)
{var segments=JSON.parse(spApi.storageData('user-segments'));for(var i in segments){if(segments[i]==campId)return i;}
return false;},getVariationsByBuilderId:function(builderId){return(spApi.personalizationCamps[builderId]||{}).variations||[];},getCampaignRatio:function(variationId){return(spApi.getVariationsByBuilderId(spApi.getPersonalizationId(variationId)).filter(function(variation){return variation.varId===variationId;})[0]||{}).ratio||'';},getControlGroupSelectedElement:function(controlVarId){var firstVariationId=spApi.getFirstVariationIdOfBuilder(controlVarId);var locationConfig=spApi.notifies[firstVariationId].locationConfig;return locationConfig.selectedElement||(locationConfig.relativePosition||{}).element;},getFirstVariationIdOfBuilder:function(variationId){var builderId=spApi.getBuilderIdFromVar(variationId);return spApi.personalizationCamps[builderId].variations[0].varId;},getBuilderIdFromPersonalizations:function(campId)
{var builderID=false;sQuery.each(spApi.personalizationCamps,function(id,personalization){sQuery.each(personalization.variations,function(key,variation){if(variation.varId==campId){builderID=id;return false;}});if(builderID){return false;}});return builderID;},e:function(js)
{return eval(js);},concat:function(camps,objects)
{sQuery.each(objects,function(i,obj){camps.push(obj);});return camps;},isCurrentCampBM:function(builderID){return sQuery.grep(spApi.bannerManagementCamps,function(camp){return camp.builderID==builderID;}).length!==0;},getBMPersonalization:function(builderID){return sQuery.grep(spApi.bannerManagementCamps,function(camp){return camp.builderID==builderID;})[0];},isOnPageCampaign:function(campaignId){if(!spApi.notifies[campaignId]){return false;}
var locationConfig=spApi.notifies[campaignId].locationConfig;var gridActive=JSON.parse(locationConfig.gridIsActive||'false');return gridActive||sQuery.inArray(locationConfig.type,['0','1','3'])>-1;},getCampOfThePage:function(campaignList)
{try{var mobileCamps=[];var webCamps=[];var tabletCamps=[];spApi.conditionCheckList=[];function collectCampaignsOnList(platformSpecificCampaignList,campaign){platformSpecificCampaignList.forEach(function(list){list.push(campaign);});};sQuery.each(campaignList,function(index,campaign){if(spApi.isMobileCamp(campaign)){collectCampaignsOnList([mobileCamps],campaign);}else if(spApi.isTabletCamp(campaign)){collectCampaignsOnList([tabletCamps],campaign);}else if(spApi.isAllPagesCamp(campaign)){collectCampaignsOnList([webCamps,tabletCamps,mobileCamps],campaign);}else{collectCampaignsOnList([webCamps],campaign);}});if(spApi.deviceDetect('PC')){campaignList=webCamps;}else if(spApi.deviceDetect('Mobil')){campaignList=mobileCamps;}else if(spApi.deviceDetect('Tablet')){campaignList=tabletCamps;}
if(spApi.isMobileBrowser()){var isControlGroupAdaptive;var infoProductType='24';function isCustomCampaign(campaign){return campaign.id.indexOf('c')>-1;}
function campaignIsMultiDevice(campaign){return isCustomCampaign(campaign)||(campaign.productType==infoProductType&&(spApi.notifies[campaign.id].mode=='adaptive'||isControlGroupAdaptive));}
function campaignIsSegmentedAsMultiDevice(segmentString){return(segmentString.indexOf('Mobil')>-1||segmentString.indexOf('Tablet')>-1||segmentString.indexOf('spApi.deviceDetect("All")')>-1);}
sQuery.each(webCamps,function(index,webCamp){if(webCamp.platform=="tablet"||webCamp.platform=="mobile"){return;}
isControlGroupAdaptive=false;if(webCamp.productType=='24'&&spApi.isControlCamp(webCamp.id)){var personalizationId=spApi.getPersonalizationId(webCamp.id);var personalizationVariations=spApi.personalizationCamps[personalizationId].variations;sQuery.each(personalizationVariations,function(index,variation){if(variation.varId!=webCamp.id){var tmpCamp=spApi.getCamp(variation.varId).camp;if(tmpCamp.productType=='24'&&spApi.notifies[tmpCamp.id].mode=='adaptive'){isControlGroupAdaptive=true;}}});}
if(campaignIsMultiDevice(webCamp)){var segment=webCamp.showIn.segment||[];sQuery.each(segment,function(index,segmentId){if(segmentId!==null){var segmentString=spApi.rules[segmentId].test;if(campaignIsSegmentedAsMultiDevice(segmentString)&&spApi.e(spApi.rules[segmentId].test)){campaignList.push(webCamp);}}});}});}else{campaignList=webCamps;}
spApi.getPersonalizationCamp();var now=Math.round(new Date()/1000);activeCamp=false;spApi.activeCamps=[];sQuery.each(campaignList,function(index,camp){if(camp.invalid){return true;}
if(camp.productAlias==='notification-center'){return true;}
if((camp.productAlias||'').indexOf('journey')>-1&&[58,50].indexOf(parseInt(camp.productType))===-1){return true;}
if(camp.isTriggerable==1){return true;}
if(!spApi.checkVarSegment(camp)){return true;}
if(!spApi.isCookieSupportEnabled()){return true;}
camp.trigTimeCount=(typeof camp.trigTimeCount=="undefined")?0:camp.trigTimeCount;var dateChecked=(camp.activeDateStart<now&&now<camp.activeDateEnd)?true:false;var showThis=true;var hideThis=false;var isFreqRuleOk=false;var isFreqRuleExist=false;if(!dateChecked){return true;}
if(!hideThis&&camp.showIn)
{if(camp.showIn.segment!=undefined&&camp.showIn.segment[0]!=null){sQuery.each(camp.showIn.segment,function(i,id){showThis=true;rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){showThis=false;return false;}
if(!spApi.checkCampaignLanguage(camp)){showThis=false;}});}
if(camp.showIn.trigger!=undefined&&camp.showIn.trigger[0]!=null&&camp.trigTimeCount==0){var triggerStatus=false;sQuery.each(camp.showIn.trigger,function(i,id){rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){triggerStatus=triggerStatus||false;}else{triggerStatus=triggerStatus||true;}});showThis=showThis&&triggerStatus;if(!spApi.checkCampaignLanguage(camp)){showThis=false;}}
if(typeof camp.showIn[0]!="undefined"){sQuery.each(camp.showIn,function(i,id){showThis=true;rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){showThis=false;return false;}
if(!spApi.checkCampaignLanguage(camp)){showThis=false;}});}
if(isFreqRuleExist)
showThis=showThis&&isFreqRuleOk;}
if(camp&&camp.trigTimeCount>0)
{sQuery.each(camp.showIn.trigger,function(i,id){rule=spApi.rules[id];if(rule.test.indexOf("isRefContains")>-1){var param=rule.test.split("'");if(document.referrer.indexOf(param[1])){if(!sQuery.cookie("spref")){var date=new Date();date.setTime(date.getTime()+(5*60*60*1000));sQuery.cookie('spref',document.referrer,{expires:date,path:'/'});}
if(sQuery.cookie("spref").indexOf(param[1])){if(spApi.ruleControl(rule,camp)){var pref=sQuery.cookie('pref');if(!pref)
pref=0;pref=parseInt(pref)+1;sQuery.cookie("pref",pref,{expires:1,path:'/'});}}}
var pref=sQuery.cookie('pref');if(pref>camp.trigTimeCount){showThis=true;}else{showThis=false;}}else if(rule.test.indexOf("hasParameter")>-1||rule.test.indexOf("getParameter")>-1){if(spApi.ruleControl(rule,camp)){var pprm=sQuery.cookie('pprm');if(!pprm)
pprm=0;pprm=parseInt(pprm)+1;sQuery.cookie("pprm",pprm,{expires:1,path:'/'});if(pprm>camp.trigTimeCount&&spApi.e(rule.test)){showThis=true;}else{showThis=false}}else{showThis=false;}}else{if(spApi.ruleControl(rule,camp)){var prl=sQuery.cookie('prl');if(!prl)
prl=0;prl=parseInt(prl)+1;sQuery.cookie("prl",prl,{expires:1,path:'/'});if(prl>camp.trigTimeCount&&spApi.e(rule.test)){showThis=true;}else{showThis=false}}else{showThis=false;}}});}
if(camp.locationisActive==1&&spApi.isMobileBrowser()){hideThis=true;showThis=false;}else{var spNoteTimerCookie=sQuery.cookie('sp-noteTimer');var couponSessionGuard=sQuery.cookie('spNTStatus');if(spNoteTimerCookie&&!spApi.storageData('sp-noteTimer')){spApi.storageData('sp-noteTimer',spNoteTimerCookie,{expires:new Date(cookieData.expireDate),path:'/',domain:cookieDomain});}
if(couponSessionGuard&&!spApi.sessionStorageGet('spNTStatus')){spApi.sessionStorageSet('spNTStatus',couponSessionGuard);}
if(camp.productType!==20&&spApi.storageData('sp-noteTimer')!=null&&spApi.isOnPageCampaign(camp.id)){showThis=false;}
if(spApi.isAudienceProduct(camp.id)&&!spApi.storageData('sp-camp-'+camp.id)&&showThis){spApi.sendAdAudience(camp);}
if(camp.productType==40){if(showThis==true){var checkAudienceStatus=JSON.parse(spApi.storageData('sp-camp-'+camp.id));if(checkAudienceStatus==null){var adAudienceLSData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id,table:'campLogs'};spApi.updateCookie(adAudienceLSData,"customChannels");spApi.customChannelsSend({campId:camp.id});}else{spApi.logger('warning','Bu Custom Channels kampanyas iin Custom Tag kodu zaten altrld. LS Bilgisi: '+JSON.stringify(checkAudienceStatus),camp.id);}
return true;}}
var triggerIsActive='0';var showIfJoined='0';var infoSettings=spApi.notifies[camp.id];if(camp.productType==24){triggerIsActive=infoSettings.triggerIsActive;var campCookie=JSON.parse(spApi.storageData('sp-camp-'+camp.id))||{};if(typeof campCookie['closed']!=="undefined"&&triggerIsActive=='1'){showThis=false;}
if(triggerIsActive=='1'&&typeof campCookie['closed']=='undefined'&&typeof campCookie['joined']!=='undefined'&&infoSettings.triggerSettings.minimized==='false'){showThis=false;}
var feedSettings=infoSettings.predictiveFeedSettings;if(feedSettings!==null&&typeof feedSettings==='object'&&Object.keys(feedSettings).length>0){showIfJoined='1';}
var campShowingStatus=infoSettings.locationConfig.showAlways;if(campShowingStatus!=='undefined'&&campShowingStatus==='true'){showIfJoined='1';}else if(campShowingStatus==='false'){showIfJoined='0';}}
if(!spApi.checkDailyDisplay(camp)){showThis=false;}
if(showThis)
{if(spApi.checkConditionNeed(camp)&&spApi.storageData('sp-camp-'+camp.id)){return true;}
if(camp.productType==24){var locationConfig=spApi.notifies[camp.id].locationConfig;}
if((spApi.spCampCheckStatus(camp.id,'liked')||spApi.spCampCheckStatus(camp.id,'joined'))&&camp.productType!=20&&triggerIsActive!='1'&&showIfJoined!='1'){return true;}
if(camp.productType==24&&locationConfig.type=="2"){spApi.showInlineCampaign(camp);return true;}
if(camp.isVersus==1&&!spApi.isFirstVersus){if(spApi.sessionStorageGet('versus-closed-'+camp.id)!=='true'){spApi.isFirstVersus=true;spApi.showCamp(camp,0,true);}
return true;}else if(camp.isVersus==1&&spApi.isFirstVersus){spApi.logger('Multiple Versus camps skipping: ',camp);return true;}
if(camp.isSocialProof==1){spApi.showCamp(camp);return true;}
if(camp.productType==65){spApi.showCamp(camp);return true;}
if([58,50].indexOf(parseInt(camp.productType))>-1){spApi.logger('info','Active campaign : '+camp.id);spApi.showCamp(camp);return true;}
spApi.activeCamps.push(camp);if(sQuery.inArray(parseInt(camp.productType),spApi.paaProducts)>-1){return true;}
if(!activeCamp||parseInt(activeCamp.priority)>parseInt(camp.priority)){activeCamp=camp;}}}});if(!activeCamp)return false;spApi.activeCamp=activeCamp;spApi.logger('info','Active campaign : '+spApi.activeCamp.id);return spApi.activeCamp;}catch(err){spApi.errLog(err,{logType:'getCampOfThePage',bugType:'product',extraData:{param1:campaignList}});}},showInlineCampaign:function(camp){var selectedElement=spApi.notifies[camp.id].locationConfig.selectedElement;if(spApi.isControlCamp(camp.id)){selectedElement=spApi.getControlGroupSelectedElement(camp.id);}
spApi.logger('info','Campaign is waiting for reference element:',camp.id);sQuery(selectedElement).elementLoadComplete(function(){camp.invalid=true;spApi.logger('info','Active inline campaign is ',camp.id);spApi.showCamp(camp,0);},null,function(){spApi.logger('warning','Inline campaign reference element not found:',camp.id);});},showCamp:function(camp,viewType)
{try{if(!spApi.isCookieSupportEnabled()){return false;}
if(camp.isSocialProof!=1&&spApi.isControlCamp(camp.id)){var impressionLogCallback=function(){var logData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id,table:'campLogs'};spApi.updateCookie(logData);};if(spApi.checkConditionNeed(camp)){spApi.setConditionCallback(camp,impressionLogCallback);}else{impressionLogCallback();}
return;}
if(camp.productType==30){spApi.activeWebPushes.push(camp);spApi.setTriggerPushes(spApi.pmData);return false;}
var getCouponCode=function(inlineMode){var notifyType=inlineMode===true?'inline':'';var couponCodeKeyPrefix='sp-info-c-';pm({type:'getOtherCookies',data:{key:couponCodeKeyPrefix+camp.id},target:sQuery('#spWorker')[0].contentWindow,success:function(couponCode){if(couponCode==null){var couponCodeUrl=spApi.apiUrl+'ajax.php?'+couponSection;sQuery.ajax({type:"POST",url:couponCodeUrl,data:{referer:top.location.href,campId:camp.id,campType:'bounce',notifyType:notifyType},cache:false,contentType:'application/json',dataType:'jsonp',crossDomain:true});}else{sQuery('.insdrNotifyCoupon').find('.editable').text(couponCode);spApi.storeLog('campLogs',{type:'notify-coupon',campId:camp.id,referer:couponCode});}}});};if(!viewType)
viewType=0;if(!camp||disable_camp)
return;if(sQuery.inArray(parseInt(camp.productType),[24,58])>-1){viewType=1;}else if(sQuery.inArray(parseInt(camp.productType),spApi.paaProducts)>-1){viewType=null;}
if(viewType==1){if(false){}
else if(['65','24'].indexOf(camp.productType)>-1&&spApi.notifies[camp.id].locationConfig.frameless==='true'){(function(camp){var effectConfig=spApi.notifies[camp.id].effectConfig;var hasEffect=effectConfig&&effectConfig.open&&effectConfig.close;var gridPositionList={'top-left':'ins-pos-top-left','top-center':'ins-pos-top-center','top-right':'ins-pos-top-right','middle-left':'ins-pos-middle-left','middle-center':'ins-pos-middle-center','middle-right':'ins-pos-middle-right','bottom-left':'ins-pos-bottom-left','bottom-center':'ins-pos-bottom-center','bottom-right':'ins-pos-bottom-right'};var addFramelessCss=function(outerCss,innerCss){createStyleElement('ins-outer-stylesheet',outerCss);createStyleElement('ins-inner-stylesheet',innerCss);};var createStyleElement=function(className,content){var campClass=className+'-'+camp.id;if(sQuery('.'+campClass).length>0){sQuery('.'+campClass).remove();}
var element=document.createElement('style');element.type='text/css';element.className=className+' '+campClass;element.innerHTML=content;document.querySelector('head').appendChild(element);};var setJavascriptCode=function(jsCode){if(sQuery('.ins-camp-frameless-js-'+camp.id).length>0){spApi.eventManager().refresh();sQuery(document).trigger('framelessInited'+camp.id);return false;}
var script=document.createElement('script');script.type='text/javascript';script.innerHTML=jsCode;script.className='ins-camp-frameless-js ins-camp-frameless-js-'+camp.id;document.querySelector('head').appendChild(script);};var getPositionClass=function(){var locationConfig=spApi.notifies[camp.id].locationConfig;var xDirection=locationConfig.gridConfig.xDirection;var yDirection=locationConfig.gridConfig.yDirection;return gridPositionList[yDirection+'-'+xDirection];};var getOverlayElement=function(){return sQuery('#ins-frameless-overlay');};var getOverlaySettings=function(){var overlaySettings=spApi.notifies[camp.id].cssConfig;return{'overlay-close':overlaySettings['overlay-close'],'overlay-color':overlaySettings['overlay-color'],'overlay-opacity':overlaySettings['overlay-opacity'],'overlay-visibility':overlaySettings['overlay-visibility']};};var setOverlaySettings=function(){var overlaySettings=getOverlaySettings();var displayOverlay='block';var preventLandscapeElement=sQuery('.ins-prevent-landscape-variable');if(preventLandscapeElement.exists()&&window.innerWidth>window.innerHeight&&preventLandscapeElement.data('value')==='none'){displayOverlay='none';}
getOverlayElement().css({'display':displayOverlay,'opacity':overlaySettings['overlay-opacity'],'background-color':overlaySettings['overlay-color'],});};var showFramelessOverlay=function(campId){var overlaySettings=getOverlaySettings();if(overlaySettings['overlay-visibility']==='true'){if(getOverlayElement().length===0){sQuery('body').append('<div id="ins-frameless-overlay" close-on-click='+overlaySettings['overlay-close']+' data-camp-id='+campId+'></div>');}
setOverlaySettings();}};var openWithEffect=function(openEffect){var notificationContent=document.getElementsByClassName('ins-notification-content-'+camp.id)[0];sQuery(notificationContent).effective(openEffect);};var visibleCampaign=function(locationConfig,previewWrap,campaignData){if(typeof spApi.notifies[camp.id].locationConfig.socialProofCG!=='undefined'&&spApi.notifies[camp.id].locationConfig.socialProofCG==='true'){var logData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id,table:'campLogs'};spApi.updateCookie(logData);}else{sQuery(previewWrap).css({'display':'block','visibility':'visible'}).promise().done(function(){sQuery(document).trigger('framelessCampaignShown'+camp.id);spApi.triggerInspectorObserver(camp.id);setJavascriptCode(campaignData.javascriptCode);showFramelessOverlay(camp.id);if(typeof hasEffect!=='undefined'&&hasEffect){openWithEffect(effectConfig.open);}
spApi.bindAutoClose(camp,(function(){sQuery(document).trigger('closeCampaign'+camp.id);}));var logData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id,table:'campLogs'};spApi.updateCookie(logData);});}};var checkFirstTriggerStatus=function(notifySettings){var firstTrigger=false;var campCookie=spApi.storageData('sp-camp-'+camp.id);var triggerHide=false;if(campCookie!==null){campCookie=JSON.parse(campCookie);triggerHide=campCookie.triggerHide;}
if(triggerHide===false||triggerHide===undefined){if(notifySettings.triggerIsActive==='1'&&camp.trigTimeOut==='-1'){firstTrigger=true;}else{firstTrigger=false;}}else if(triggerHide=='1'){firstTrigger=false;}else if(triggerHide=='0'){firstTrigger=true;}
return firstTrigger;};var showFramelessCampaign=function(campaignData){var notifySettings=spApi.notifies[camp.id];var locationConfig=notifySettings.locationConfig;var isInlineTemplate=locationConfig.type=='2';var isRelativeTemplate=locationConfig.relativePositioning=='true';var isClosed=(JSON.parse(spApi.storageData('sp-camp-'+camp.id))||{}).closed;if(campaignData.outerCss==='Parse error'){spApi.logger('warning','Campaign css is not valid.',camp.id);return false;}
if((isInlineTemplate&&!sQuery(locationConfig.selectedElement).exists())||(isRelativeTemplate&&!sQuery(locationConfig.relativePosition.element).exists())){spApi.logger('warning','Inline campaign reference element not found:',camp.id);return false;}
var previewWrapClassSelector='.ins-preview-wrapper.ins-preview-wrapper-'+camp.id;if(sQuery(previewWrapClassSelector).exists()){spApi.logger('warning','Campaign is already exists on dom:',camp.id);return false;}
addFramelessCss(campaignData.outerCss,campaignData.innerCss);var previewWrap=document.createElement('div');previewWrap.className='ins-preview-wrapper ins-preview-wrapper-'+camp.id;var contentWrapper=document.createElement('div');contentWrapper.className='ins-content-wrapper ins-content-wrapper-'+camp.id;var manualPositionSettings=locationConfig.manualPositionConfig||{};if(manualPositionSettings.manualPositionIsActive==='true'){if(isInlineTemplate||isRelativeTemplate){previewWrap.style.setProperty('position','relative','important');previewWrap.style.setProperty('left',(manualPositionSettings.left-manualPositionSettings.right)+'px','important');previewWrap.style.setProperty('top',(manualPositionSettings.top-manualPositionSettings.bottom)+'px','important');}else{previewWrap.style.setProperty('margin-left',manualPositionSettings.left+'px','important');previewWrap.style.setProperty('margin-right',manualPositionSettings.right+'px','important');previewWrap.style.setProperty('margin-top',manualPositionSettings.top+'px','important');previewWrap.style.setProperty('margin-bottom',manualPositionSettings.bottom+'px','important');}}
var notificationContent=document.createElement('div');notificationContent.className='ins-notification-content ins-notification-content-'+camp.id;notificationContent.setAttribute('data-camp-id',camp.id);sQuery.each(spApi.notifies[camp.id].cssConfig,function(property,value){notificationContent.style.setProperty(property,value,'important');});previewWrap.style.setProperty('display','none');previewWrap.style.setProperty('visibility','hidden');previewWrap.appendChild(contentWrapper);contentWrapper.appendChild(notificationContent);notificationContent.innerHTML=campaignData.content;if(isInlineTemplate){spApi.showFramelessTemplate.inPage(locationConfig,previewWrap,notificationContent);}else if(locationConfig.gridIsActive=='true'){spApi.showFramelessTemplate.onPage(previewWrap,getPositionClass());}else if(isRelativeTemplate){spApi.showFramelessTemplate.relativePosition(locationConfig,previewWrap);}
var framelessEvent=document.createEvent('CustomEvent');framelessEvent.initCustomEvent('framelessReady',true,true,{campID:camp.id});document.dispatchEvent(framelessEvent);if(notifySettings.triggerIsActive=='1'){spApi.setTrigger(notifySettings.triggerSettings,function(){visibleCampaign(locationConfig,previewWrap,campaignData);});}
if(spApi.notifies[camp.id].waitForKKBData){esCountAnalytics(function(countAnalytics){window.socialProofVarId=camp.id;esLiveFeed(function(liveFeed){var socialProofData=spApi.notifies[camp.id].socialProofSettings;var minimum=socialProofData.min;var maximum=socialProofData.max;var random=socialProofData.random;var textArea=campaignData.content;var showSocialProofCamp=false;var lastPurchaseRequired=false;function createLastPurchaseData(lastPurchasedDate){if(typeof maximum==='undefined'||typeof minimum==='undefined'){return 0;}
var lastPurchase=new Date(lastPurchasedDate);var now=new Date();var diff=now-lastPurchase;var totalMinutes=Math.ceil((now.getTime()-lastPurchase.getTime())/(1000*60));var diffInDays=Math.floor(diff/86400000);var diffInHours=Math.floor((diff%86400000)/3600000);var diffInMinutes=Math.round(((diff%86400000)%3600000)/60000);if(totalMinutes<minimum['@lastPurchase']||totalMinutes>maximum['@lastPurchase']){return false;}
var purchaseString='';var dateTrans=typeof spApi.translations[camp.lang]!=='undefined'?spApi.translations[camp.lang].date:spApi.translations['en_US'].date;if(diffInDays>0){purchaseString+=diffInDays+' '+spApi.pluralForm.get(camp.lang,diffInDays,dateTrans.form1.day,(dateTrans.form2||[]).day,(dateTrans.form3||[]).day,(dateTrans.form4||[]).day).toLowerCase()+' ';}
if(diffInHours>0){purchaseString+=diffInHours+' '+spApi.pluralForm.get(camp.lang,diffInHours,dateTrans.form1.hour,(dateTrans.form2||[]).hour,(dateTrans.form3||[]).hour,(dateTrans.form4||[]).hour).toLowerCase()+' ';}
if(diffInMinutes>0){purchaseString+=diffInMinutes+' '+spApi.pluralForm.get(camp.lang,diffInMinutes,dateTrans.form1.minute,(dateTrans.form2||[]).minute,(dateTrans.form3||[]).minute,(dateTrans.form4||[]).minute).toLowerCase();}
if(purchaseString.legnth==0){return false;}
return purchaseString;};var kkbData={'@instantView':countAnalytics.instantView,'@dailyView':countAnalytics.dailyView,'@dailyPurchase':liveFeed.purchase.dailyPurchase,'@instantPurchase':liveFeed.purchase.instantPurchase,'@inBasketCount':liveFeed.inBasketCount,'@lastPurchase':createLastPurchaseData(liveFeed.lastPurchasedDate)};sQuery.each(spApi.notifies[camp.id]['kkbSettings'],function(key,value){if(key==='@lastPurchase'&&kkbData[key]!=false&&textArea.indexOf(key)>-1){textArea=textArea.replace(new RegExp(key,'g'),kkbData[key]);showSocialProofCamp=true;}
if(key==='@lastPurchase'&&kkbData[key]==false&&textArea.indexOf(key)>-1){lastPurchaseRequired=true;}
if(key!=='@lastPurchase'){if(textArea.indexOf(key)>-1&&kkbData[key]>0&&minimum[key]<=kkbData[key]){textArea=textArea.replace(new RegExp(key,'g'),kkbData[key]);showSocialProofCamp=true;}else if(textArea.indexOf(key)>-1&&minimum[key]>=kkbData[key]){showSocialProofCamp=false;}}});notificationContent.innerHTML=textArea;if(showSocialProofCamp&&!lastPurchaseRequired){if(spApi.checkConditionNeed(camp)){spApi.setConditionCallback(camp,function(){visibleCampaign(locationConfig,previewWrap,campaignData);});}else{visibleCampaign(locationConfig,previewWrap,campaignData);}}});},camp.id);}else{if(spApi.checkConditionNeed(camp)){if(checkFirstTriggerStatus(notifySettings)){spApi.setConditionCallback(camp,function(){spApi.showTrigger(camp.id,notifySettings.triggerSettings);});}else{spApi.setConditionCallback(camp,function(){visibleCampaign(locationConfig,previewWrap,campaignData);});}}else{if(checkFirstTriggerStatus(notifySettings)||(typeof notifySettings.triggerSettings==='object'&&notifySettings.triggerSettings.doNotShowAgain==='true'&&notifySettings.triggerIsActive==='1')){if(notifySettings.triggerSettings.showFirst==='true'){spApi.showTrigger(camp.id,notifySettings.triggerSettings);}else{visibleCampaign(locationConfig,previewWrap,campaignData);}}else if(notifySettings.triggerIsActive!=='1'&&!isClosed){visibleCampaign(locationConfig,previewWrap,campaignData);}}}
var bindFramelessCampaignCallback=function(type){sQuery.each(camp.callbacks[type],function(key,callback){spApi.campEventControl(type,callback);});};bindFramelessCampaignCallback('show');sQuery(document).on('framelessClose'+camp.id,function(){bindFramelessCampaignCallback('close');});spApi.framelessHelper().stickyElementListener(camp.id);};window['getFramelessData'+camp.id]=function(){};var getFramelessCampaignData=function(){sQuery.ajax({url:spApi.apiUrl+'ajax.php?t=getFramelessData',type:'GET',data:{campID:camp.id,genDate:spApi.genDate,productType:camp.productType},dataType:'jsonp',cache:true,async:spApi.isAjaxAsync,jsonpCallback:'getFramelessData'+camp.id,success:function(campaignData){setTimeout(function(){showFramelessCampaign(campaignData);},camp.trigTimeOut*1000);}});};var loadFramelessJS=function(){if(sQuery('#ins-frameless-js').length>0){getFramelessCampaignData();return;}
var script=document.createElement('script');script.setAttribute('id','ins-frameless-js');script.addEventListener('load',getFramelessCampaignData,false);document.getElementsByTagName('head')[0].appendChild(script);script.setAttribute('src',spApi.staticUrl+'js/frameless.min.js?v=1.3.9');};if(sQuery('.ins-frameless-css-'+camp.id).length>0){getFramelessCampaignData();}else{sQuery('.ins-frameless-css-'+camp.id).remove();var link=document.createElement('link');link.setAttribute('class','ins-frameless-css ins-frameless-css-'+camp.id);link.setAttribute('rel','stylesheet');link.setAttribute('type','text/css');link.setAttribute('media','screen');link.addEventListener('load',loadFramelessJS,false);document.getElementsByTagName('head')[0].appendChild(link);link.setAttribute('href',spApi.staticUrl+'css/frameless.css?v=0.9');}})(camp);}
else if(camp.productType==24&&spApi.notifies[camp.id].locationConfig.type=='2'){var notifySettings=spApi.notifies[camp.id];var couponStatus=spApi.notifies[camp.id].notifCpnStatus;var couponSection='t=getInfoCoupon';if(notifySettings.locationConfig.selectedElement=='html'||!(sQuery(notifySettings.locationConfig.selectedElement).length>0)){if(notifySettings.locationConfig.selectedElement=='html'){var errorData={name:"Inline mode positioning",message:"Selector is "+notifySettings.locationConfig.selectedElement+", campaign didn't show. Camp ID: "+camp.id}
var thisData={logType:'Inline Error'};spApi.errLog(errorData,thisData);}
return false;}
var insdrInlineDiv=sQuery('<div/>',{'class':'sp-inline-wrap sp-inline-wrap-'+camp.id+' sp-advanced-css-'+camp.id,'style':'visibility: hidden;'});var urlParams='';if(spApi.checkConditionNeed(camp)){urlParams+='&campType=bounce&notifyType=inline';}
var insdrInlineIframe=sQuery('<iframe/>',{'class':'sp-inline-iframe sp-inline-iframe-'+camp.id,'style':'display: block; visibility: hidden; width: 0px; height: 0px; border:none;','src':spApi.frameUrl+"?viewType=1&id="+camp.id+"&appType=24"+urlParams+"&version="+spApi.genDate,'frameBorder':'0'});var inlineNotificationFunctions={visibleNotification:function(element){if(!spApi.isControlCamp(camp.id)){sQuery('.sp-inline-wrap-'+camp.id).css({"display":"inline-block","visibility":"visible"});}
sQuery(element).css({"display":"block","visibility":"visible"}).promise().done(function(){spApi.triggerInspectorObserver(camp.id);var effectConfig=notifySettings.effectConfig;if(effectConfig instanceof Object&&typeof effectConfig.open!="undefined"){sQuery('.sp-inline-wrap-'+camp.id).effective(effectConfig.open);}
var logData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id,table:'campLogs'};spApi.updateCookie(logData);if(couponStatus=='1'&&spApi.checkConditionNeed(camp)){getCouponCode(true);}
spApi.bindAutoClose(camp);sQuery.each(camp.callbacks.show,function(key,callback){spApi.campEventControl('show',callback);});try{pm({target:sQuery('.sp-inline-iframe-'+camp.id)[0].contentWindow,type:'startCountdown'});}catch(err){spApi.errLog(err,{logType:'startCountdown',bugType:'partner',extraData:{campId:camp.id,element:element}});}});},showNotification:function(){if(sQuery('.sp-inline-wrap-'+camp.id).length>0){sQuery('.sp-inline-wrap-'+camp.id).remove();}
var insertAction=notifySettings.locationConfig.insertAction;var selectedElement=notifySettings.locationConfig.selectedElement;if(insertAction=='after'){sQuery(selectedElement).after(insdrInlineDiv);}
else if(insertAction=='before'){sQuery(selectedElement).before(insdrInlineDiv);}
else if(insertAction=='insert-end'){sQuery(selectedElement).append(insdrInlineDiv);}
else if(insertAction=='insert-beginning'){sQuery(selectedElement).prepend(insdrInlineDiv);}
sQuery('.sp-inline-wrap-'+camp.id).append(insdrInlineIframe);sQuery(insdrInlineIframe).on('load',function(){sQuery('.sp-inline-iframe-'+camp.id).pm(function(){if(sQuery('.swiper-slide-active .element-coupon').length>0){var couponCode=sQuery.cookie('sp-info-c-'+campId)
if(!couponCode||couponCode==='undefined'||couponCode==='null'){return false;}}
return inlineConfig;},function(data){if(!data){spApi.conLog('Campaign won\'t be shown because "data" is false campId:'+camp.id);return false;}
sQuery('body').append('<style>'+'.sp-inline-wrap { position: relative; top: initial; left: initial; z-index: 9999999; display: initial; }'+'</style>');if(data.adaptiveSettings!=null&&typeof data.adaptiveSettings.outerCss!=='undefined'){sQuery('body').append('<style id="insider-outer-css">'+
data.adaptiveSettings.outerCss+'.insider-ios-fixed { position: absolute !important; top: 0 !important; margin-top: 10px !important; }'+'</style>');sQuery('.sp-inline-wrap-'+camp.id).addClass('inline-resolution');}
if(camp.productType==24){sQuery('.sp-inline-wrap-'+camp.id).css({'margin-left':data.locationConfig.left+'px','margin-top':data.locationConfig.top+'px','box-shadow':data.cssConfig.shadow,'border-radius':data.cssConfig.borderRadius,'border-style':data.cssConfig.borderStyle,'border-width':data.cssConfig.borderWidth,'border-color':data.cssConfig.borderColor,'display':'none'});sQuery('.sp-inline-iframe-'+camp.id).css({'width':data.width-(parseFloat(data.cssConfig.borderWidth)*2),'height':data.height-(parseFloat(data.cssConfig.borderWidth)*2),'visibility':'hidden','display':'none','border-radius':data.cssConfig.borderRadius});pm({target:sQuery('.sp-inline-iframe-'+camp.id)[0].contentWindow,type:'initView'});}
if(spApi.checkConditionNeed(camp)){spApi.setConditionCallback(camp,function(){inlineNotificationFunctions.visibleNotification('.sp-inline-iframe-'+camp.id);});}else{inlineNotificationFunctions.visibleNotification('.sp-inline-iframe-'+camp.id);}});});}};setTimeout(function(){inlineNotificationFunctions.showNotification();},camp.trigTimeOut*1000);}}}catch(err){spApi.errLog(err,{logType:'showCamp',bugType:'product',extraData:{param1:camp,param2:viewType}});}},loadInfoCss:function(){if(sQuery('#insStyleCss').length===0){var styleLink="<link id='insStyleCss' rel='stylesheet' href='//holodilnik.api.useinsider.com/css/ins-style.css?v=0.1' type='text/css' media='screen'>";if(sQuery("head link[rel='stylesheet']")[0]){sQuery("head link[rel='stylesheet']").last().after(styleLink);}else{sQuery('head').append(styleLink);}}},showFramelessTemplate:{onPage:function(previewWrap,positionClass){previewWrap.className+=' '+positionClass;document.body.appendChild(previewWrap);},relativePosition:function(locationConfig,previewWrap){var selectedElement=sQuery(locationConfig.relativePosition.element);var $previewContainer=sQuery(previewWrap);var templateMargin=15;function calculatePosition(){var elementPosition={x:selectedElement.offset().left,y:selectedElement.offset().top};var relativePosition={x:parseInt(locationConfig.relativePosition.position.x),y:parseInt(locationConfig.relativePosition.position.y)};var left=elementPosition.x-relativePosition.x;var top=elementPosition.y-relativePosition.y;if(relativePosition.y==0){top=selectedElement.height()+elementPosition.y;}
return{left:left-templateMargin,top:top-templateMargin};}
function calculatePositionForMobileResolution(){$previewContainer.css('top',calculatePosition().top);}
if(!spApi.isMobileBrowser()){var calculatedPosition=calculatePosition();$previewContainer.css({left:calculatedPosition.left,top:calculatedPosition.top,position:'absolute'});}
function reCalculateAndPosition(){if(spApi.isMobileBrowser()){calculatePositionForMobileResolution();}else{var calculatedPosition=calculatePosition();$previewContainer.css({left:calculatedPosition.left,top:calculatedPosition.top});}}
sQuery(window).unbind('resize.insFrameless scroll.insFrameless').on('resize.insFrameless scroll.insFrameless',function(){reCalculateAndPosition();});sQuery('body').append($previewContainer);if(spApi.isMobileBrowser()){calculatePositionForMobileResolution();}},inPage:function(locationConfig,previewWrap,notificationContent){var $selectedElement=sQuery(locationConfig.selectedElement);var $notificationContainer=sQuery(notificationContent);var $previewContainer=sQuery(previewWrap);$notificationContainer.css({'position':'relative','top':'initial','left':'initial','margin-left':locationConfig.left,'margin-top':locationConfig.top,'display':'inline-block'});$notificationContainer.addClass('inline-resolution');switch(locationConfig.insertAction){case'before':$selectedElement.before($previewContainer);break;case'after':$selectedElement.after($previewContainer);break;case'insert-end':$selectedElement.append($previewContainer);break;case'insert-beginning':$selectedElement.prepend($previewContainer);break;default:break;}}},checkConditionNeed:function(camp){if(typeof camp=='undefined'||camp==null){return false;}
if(typeof camp.isBounce!=='undefined'&&camp.isBounce=='1'){return true;}
if(typeof camp.conditionNeeds!=='undefined'&&((typeof camp.conditionNeeds.bounce!=='undefined'&&camp.conditionNeeds.bounce=='1')||(typeof camp.conditionNeeds.scroll!=='undefined'&&camp.conditionNeeds.scroll=='1'))){return true;}
return false;},getTime:function(){return Math.round(new Date()/1000);},getUTCTime:function(){var now=new Date();var time=now.getTime();var offset=now.getTimezoneOffset()*60000;return Math.round((time-offset)/1000);},isRefContains:function(data)
{var res=document.referrer.indexOf(data)>-1;return res;},hasText:function(selectedText,comparedText){try{if(typeof selectedText!=="undefined"&&selectedText!==null){return selectedText.indexOf(comparedText)>-1?true:false;}else{return false;}}catch(err){spApi.errLog(err,{logType:'hasText',bugType:'partner',extraData:{param1:selectedText,param2:comparedText}});}},hasParameter:function(name,exactMatch)
{try{if(typeof exactMatch==="undefined")
exactMatch=false;try{var uri=decodeURI(window.location.href);}catch(err){var uri=unescape(window.location.href);}
if(exactMatch==false){name=decodeURI(name.replace(/[\[\]\/\?]/g,"\\$&"));var regex=new RegExp(name);var results=regex.exec(uri);if(results==null){return false}else
return true;}else if(exactMatch==true){var pageUrl=window.location.href.replace('www.','');if(pageUrl==name){return true;}else{return false;}}}catch(err){spApi.errLog(err,{logType:'hasParameter',bugType:'product',extraData:{param1:name,param2:exactMatch}});}},checkCampaignLanguage:function(camp){if(camp.lang=='all_ALL'||sQuery.inArray(camp.productType,[32,39,47])>-1){return true;}
return spApi.getLang()==camp.lang;},addZeroToUtcHours:function(hour){if(hour<10){hour="0"+hour;}
return hour;},checkDailyDisplay:function(camp){try{var currentDate=new Date();var currentTime=spApi.addZeroToUtcHours(currentDate.getHours())+':'+currentDate.getMinutes();var utcCurrentDay=spApi.getUTCDayString(currentDate.getUTCDay());var dailyDisplay=camp.dailyDisplay;if(typeof dailyDisplay==='undefined'||!dailyDisplay.length>0){return true;}
dailyDisplay=JSON.parse(dailyDisplay);if(typeof dailyDisplay==='object'){if(dailyDisplay.end<=dailyDisplay.start){endTime=dailyDisplay.end.split(':');dailyDisplay.end=(parseInt(endTime[0])+24)+':'+endTime[1];}
if(sQuery.inArray('all',dailyDisplay.days)>-1||sQuery.inArray(utcCurrentDay,dailyDisplay.days)>-1){return currentTime>dailyDisplay.start&&currentTime<dailyDisplay.end;}}
return false;}catch(err){spApi.errLog(err,{logType:'dailyDisplay',bugType:'product'});return false;}},getUTCDayString:function(dayIndex){var weekDay=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return weekDay[dayIndex];},deviceDetect:function(targetDevice){if(targetDevice=='All')return true;var userAgent=navigator.userAgent.toLowerCase();var isMobile=(/iphone|ipod|android|blackberry|opera mini|opera mobi|skyfire|maemo|windows phone|palm|iemobile|symbian|symbianos|fennec/i.test(userAgent));var isTablet=(/(?!.*tablet pc)(ipad|android|sch-i800|playbook|tablet|kindle|gt-p1000|sgh-t849|shw-m180s|a510|a511|a100|dell streak|silk)/i).test(userAgent);if(userAgent.toLowerCase().indexOf('android')>-1){isTablet=isTablet&&userAgent.indexOf('mobile')==-1;isMobile=isMobile&&userAgent.indexOf('mobile')!=-1;}
var device='PC';if(isMobile){device='Mobil';}else if(isTablet){device='Tablet';}
return device==targetDevice;},isOnPanel:function(){try{return window.self!==window.top;}catch(err){spApi.errLog(err,{logType:'isOnPanel',bugType:'partner',extraData:{}});}},getParameter:function(name)
{name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&#]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(window.location.href);if(results==null){return"";}else{try{var unfilteredValue=decodeURIComponent(results[1].replace(/\+/g," "));return unfilteredValue.replace(/<[^>]+>/ig,"");}catch(err){spApi.errLog(err);return unescape(results[1].replace(/\+/g," "));}}},isParameter:function(name)
{var parameter=spApi.getParameter(name);return(parameter!="")?true:false;},getUserData:function(dataType)
{try{if(dataType=="gender"){if(JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="erkek"){return"male";}else if(JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="kadn"||JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="kadin"){return"female";}else{return JSON.parse(localStorage.getItem('spUserData'))[dataType];}}else{return JSON.parse(localStorage.getItem('spUserData'))[dataType];}}catch(err){spApi.errLog(err,{logType:'getUserData',bugType:'product',extraData:{param1:dataType}});}},setSessionStorage:function(storageName,storeValue)
{spApi.sessionStorageSet(storageName,JSON.stringify(storeValue));},getSessionStorage:function(storageName)
{try{return JSON.parse(spApi.sessionStorageGet(storageName))}catch(err){spApi.errLog(err);spApi.setSessionStorage(storageName,'');return[];}},getJourneyCamp:function(journeyId){return spApi.journeyCamps.filter(function(journeyCamp){return journeyCamp.id==journeyId;})[0];},updateCookie:function(data,type){try{type=typeof type!=='undefined'?type:"general";var campId;if(data.campId)
campId=data.campId;var cookieExpireDate=14;if(typeof campId!=='undefined'){var controlCamp=spApi.getCamp(campId);if(typeof controlCamp.camp!=='undefined'){cookieExpireDate=parseInt(controlCamp.camp.cookieTime);}else if(typeof spApi.webPushes[campId]!=='undefined'){cookieExpireDate=parseInt(spApi.webPushes[campId].cookieTime);}else if(data.key.indexOf('ins-wp')>-1&&!spApi.hasParameter('journeyId')){var ONE_DAY_AS_MILLISECONDS=86400000;cookieExpireDate=(new Date().setHours(0,0,0,0)+ONE_DAY_AS_MILLISECONDS-new Date().getTime())/ONE_DAY_AS_MILLISECONDS;}}
if(data.key.indexOf('ins-journey-camp')>-1){cookieExpireDate=spApi.getJourneyCamp(data.obj.journeyId).cookieTime;}
var isLocalstorage=false;var localStorageList=['sp-camp','ins-insight','sp-goal','user-segments','paid-products','ins-wp','prodCats','ins-journey-camp','ins-fbm'];sQuery.each(localStorageList,function(index,keyName){if(data.key.indexOf(keyName)>-1){isLocalstorage=true;}});c=(isLocalstorage&&spApi.storageData(data.key)!=null)?spApi.storageData(data.key):sQuery.cookie(data.key);if(data.key.indexOf('sp-camp-')>-1&&spApi.salesSesId!=spApi.Base64.encode('0')){if(c==null){data.obj.salesSesId=spApi.Base64.decode(spApi.salesSesId);data.obj.salesSesTime=spApi.getTime();}}
newC=data.obj;if(data.key=='user-segments'){var cookieExpireDate=new Date();cookieExpireDate.setTime(cookieExpireDate.getTime()+(60*60*1000));}
if(data.obj['step1-displayed']){var camp=spApi.getCamp(campId).camp||{};var now=new Date();var campaignStorage=spApi.getStorageValue(data.key);var currentSalesLogDuration=campaignStorage?campaignStorage.salesLogDuration:new Date().setMinutes(now.getMinutes()+30);var currentSalesLogDurationTime=new Date(currentSalesLogDuration);if(!campaignStorage||!campaignStorage.salesLogDuration){data.obj.viDa=spApi.getTime();if(camp.sessionBasedGoal==="0"){data.obj.salesLogDuration=now.setHours(now.getHours()+parseInt(camp.saLogDuration));}}
if(camp.sessionBasedGoal==="1"){if(now.getHours()===0&&currentSalesLogDurationTime.getHours()===0&&currentSalesLogDurationTime.getMinutes()<now.getMinutes()){data.obj.salesLogDuration=now.setMinutes(now.getMinutes()-30);}else if(!currentSalesLogDuration||!spApi.isOnAfterPaymentPage()&&currentSalesLogDuration>now.getTime()){data.obj.isSessionBasedSalesLogDuration='true';data.obj.salesLogDuration=now.setMinutes(now.getMinutes()+30);spApi.setSessionBasedSalesLogDurationEvent();}}}else if(data.obj['joined']||data.obj['liked']){data.obj.joDa=spApi.getTime();}else if(data.obj['closed']){data.obj.clDa=spApi.getTime();}
if(c){if(data.key=='sp-notes'){sQuery.cookie(data.key,c,{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{oldC=JSON.parse(c);newC=sQuery.extend(true,oldC,newC);if(!isLocalstorage){sQuery.cookie(data.key,sQuery.toJSON(newC),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{spApi.storageData(data.key,sQuery.toJSON(newC),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}}}else{if(data.key=='sp-notes'){sQuery.cookie(data.key,data.obj,{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{if(!isLocalstorage){sQuery.cookie(data.key,sQuery.toJSON(data.obj),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{spApi.storageData(data.key,sQuery.toJSON(data.obj),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}}}
if(type!="AB"&&data.key!='sp-notes'&&type!="nolog"){newC.table=data.table;this.worker.check(JSON.parse(c),newC,campId);}
if(typeof campId!=='undefined'){spApi.triggerInspectorLogs(JSON.stringify({type:Object.keys(data.obj)[0],'campId':campId.toString()}));}}catch(err){spApi.errLog(err,{logType:'updateCookie',bugType:'product',extraData:{param1:data,param2:type}});}},isAudienceProduct:function(campId){var paaProductIds=['32','39','40','47'];return typeof campId!=='undefined'&&typeof spApi.getCamp(campId).camp!=='undefined'&&paaProductIds.indexOf(spApi.getCamp(campId).camp.productType)>-1;},setCookie:function(data,callback){this.worker.cookie(data,callback);},isFreqRule:function(rule){try{return rule.test.indexOf("getMinutes")<0?false:true;}
catch(err){spApi.errLog(err);return false;}},validateEmail:function(email,limit){if(!email){return false;}
if(!limit){var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;}else{var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{3,4})?$/;}
if(emailReg.test(email)){return true;}
return false;},reformatDate:function(date,withTimeString){try{date=date||'';if(!date||date.length<10)
return date;date=date.toString();var mappedText=date;if(date.replace(/[0-9]/g,"").length===0){if(date.length==10){date=parseInt(date*1000);}
var date=new Date(parseInt(date));mappedText=date.getFullYear()+'-'+("00"+(date.getMonth()+1)).substr(-2,2)+'-'+("00"+date.getDate()).substr(-2,2);if(withTimeString){mappedText=mappedText+' '+("00"+date.getHours()).substr(-2,2)+':'+("00"+date.getMinutes()).substr(-2,2)+':'+("00"+date.getSeconds()).substr(-2,2);}}
else{date=date.replace(/[^0-9]/g,"-");mappedText=date;var splitDate=date.split('-');if(splitDate.length!==3)
return'';if(splitDate[0].length<4){mappedText=splitDate[2]+'-'+splitDate[1]+'-'+splitDate[0];}}
return mappedText;}catch(err){spApi.errLog(err,{logType:'reformatDate',bugType:'product'});}},hashCode:function(str){var hash=0;if(str.length===0){return hash;}
for(var i=0;i<str.length;i++){var char=str.charCodeAt(i);hash=((hash<<5)-hash)+char;hash=hash&hash;}
return Math.abs(hash);},widgets:{autoComplete:function(formSelector,customStorage,readOnly){var storageName=typeof customStorage==='undefined'?'insAutoComplete':customStorage;if(spApi.localStorageGet(storageName)!==null&&readOnly!==true){var getFormDatas=JSON.parse(spApi.localStorageGet(storageName));if(typeof getFormDatas!=='object')getFormDatas=JSON.parse(getFormDatas)||'[]';sQuery.each(getFormDatas,function(i,item){var _name='',_id='',_class='';if(item._name!=""){_name='[name="'+item._name+'"]';}else if(item._id!=""){_id='#'+item._id;}else if(item._class!=""){_class='.'+item._class;}
sQuery(_name+_id+_class,formSelector).val(item._value);});}
var formDatas=JSON.parse(spApi.localStorageGet(storageName))||[];if(typeof formDatas!=='object')formDatas=JSON.parse(formDatas)||'[]';sQuery.each(sQuery(':input',formSelector),function(i,item){if(sQuery(item).prop('tagName').toLowerCase()=='input'&&sQuery(item).attr('type')!="password"){sQuery(item).on('keyup focusout click focus blur change',function(){setData(formDatas,item);});}else if(sQuery(item).prop('tagName').toLowerCase()=='select'){sQuery(item).change(function(){setData(formDatas,item);});}else if(sQuery(item).prop('tagName').toLowerCase()=='textarea'){sQuery(item).on('keyup focusout click focus blur change',function(){setData(formDatas,item);});}});function setData(formDatas,input){var add=true;sQuery.each(formDatas,function(i,v){if((sQuery(input).attr('id')||"")==v._id&&(sQuery(input).attr('class')||"")==v._class&&(sQuery(input).attr('name')||"")==v._name){add=false;v._value=sQuery(input).val();}});if(add){formDatas.push({_name:sQuery(input).attr('name')||"",_id:sQuery(input).attr('id')||"",_class:sQuery(input).attr('class')||"",_value:sQuery(input).val()||""});}
spApi.localStorageSet(storageName,JSON.stringify(formDatas),{expire:15,path:'/',domain:partner_site.host});}},stickyBasket:function(data){if(typeof data!="object"||typeof data=="undefined")return false;sQuery('body').prepend('<div id="insdrBasket" style="left:'+data.mainWrapperPos+'px;margin-left:10px;position:fixed;"><p id="stickyCount">'+data.basketCount+'</p></div>')
sQuery('#insdrBasket').css(data.stickyBasketStyles);sQuery('#stickyCount').css(data.stickCountStyles);function isScrolledIntoView(basketIdentf){var $elem=basketIdentf;var $window=sQuery(window);var docViewTop=$window.scrollTop();var docViewBottom=docViewTop+$window.height();var elemTop=$elem.offset().top*2;var elemBottom=elemTop+$elem.height();return((elemBottom<=docViewBottom)&&(elemTop>=docViewTop));}
sQuery(window).scroll(function(){if(!isScrolledIntoView(data.basketIdentifier)){sQuery('#insdrBasket').show();}
else{sQuery('#insdrBasket').hide();}});},countdown:function(targetDate,currentTime){if('undefined'==typeof targetDate)return spApi.logger('info','invalid date');var timestampDifference=function(date1,date2){var difference=date1.getTime()-date2.getTime();var yearDifference=Math.floor(difference/1000/60/60/24/365);difference-=yearDifference*1000*60*60*24*365
var monthDifference=Math.floor(difference/1000/60/60/24/30);difference-=monthDifference*1000*60*60*24*30
difference=date1.getTime()-date2.getTime();var daysDifference=Math.floor(difference/1000/60/60/24);difference-=daysDifference*1000*60*60*24
var hoursDifference=Math.floor(difference/1000/60/60);difference-=hoursDifference*1000*60*60
var minutesDifference=Math.floor(difference/1000/60);difference-=minutesDifference*1000*60
var secondsDifference=Math.floor(difference/1000);return arr={days:("00"+daysDifference).substr(-2,2),hours:("00"+hoursDifference).substr(-2,2),minutes:("00"+minutesDifference).substr(-2,2),seconds:("00"+secondsDifference).substr(-2,2)};};var countdownFrom=function(targetDate){var timestamp=new Date(targetDate*1000);targetDate=new Date(timestamp.getFullYear(),timestamp.getMonth(),timestamp.getDate(),timestamp.getHours(),timestamp.getMinutes(),timestamp.getSeconds());return timestampDifference(targetDate,new Date());};var countdownTo=function(targetDate,currentTime){var condition=typeof targetDate.days=='undefined'&&typeof targetDate.hours=='undefined'&&typeof targetDate.minutes=='undefined'&&typeof targetDate.seconds=='undefined';if(condition)return spApi.logger('info','invalid parameters sent');targetDate={year:(targetDate||'').year||0,month:(targetDate||'').month||0,days:(targetDate||'').days||0,hours:(targetDate||'').hours||0,minutes:(targetDate||'').minutes||0,seconds:(targetDate||'').seconds||0};currentTime=currentTime||new Date();targetDate=new Date(currentTime.getFullYear()+targetDate.year,currentTime.getMonth()+targetDate.month,currentTime.getDate()+targetDate.days,currentTime.getHours()+targetDate.hours,currentTime.getMinutes()+targetDate.minutes,currentTime.getSeconds()+targetDate.seconds);return timestampDifference(targetDate,new Date());};if(typeof targetDate=='object'){return countdownTo(targetDate,currentTime);}
else{return countdownFrom(targetDate);}},scroll:function(scroll){if(typeof scroll=='undefined')return spApi.logger('info','Parameter error!');if(scroll.addPixel=='undefined')scroll['addPixel']=0;scroll['scrollTop']=sQuery(scroll.scrollElement).offset().top+scroll.addPixel;spApi.getCamp(scroll.campId).show(function(){sQuery('.sp-advanced-css-'+scroll.campId+' iframe').pm(function(data){sQuery(data.scroll.clickElement).live('click',function(){sQuery(window).pm(function(data){sQuery('html,body').animate({'scrollTop':data.scroll.scrollTop},'swing');},undefined,{scroll:data.scroll});});},undefined,{scroll:scroll});});}},spCampCheckStatus:function(id,condition){try{if(typeof(id)=='undefined'||id=='undefined')return false;var c=spApi.storageData('sp-camp-'+id);var id=id.toString();if(!c||id=='undefined')
return false;else{var controlCamp=spApi.getCamp(id);c=JSON.parse(c);var status=(condition=="liked")?(c["liked"]||c["closed"]):(c[condition]==true?true:false);if(condition=="liked"||condition=="joined"){tempId=id.toString();if(tempId.indexOf('c')<0){controlCamp=controlCamp.camp;var closeLimitStatus=false;var joinLimitStatus=false;if(c["joDa"]!=undefined){joinLimitStatus=joinLimitStatus=c["joDa"]+controlCamp.joinControlLimit*60*60>spApi.getTime();}
if(c["clDa"]!=undefined){closeLimitStatus=c["clDa"]+controlCamp.closeControlLimit*60*60>spApi.getTime();}
status=status&&(closeLimitStatus||joinLimitStatus);}}else if(condition=="closed"&&c["clDa"]!=undefined){status=status&&c["clDa"]>spApi.getTime()-controlCamp.closeControlLimit*60*60;}
if(typeof status==='string'){return status=="";}else{return status==true;}}}catch(err){spApi.errLog(err,{logType:'spCampCheckStatus',bugType:'product',extraData:{param1:id,param2:condition}});}},getStandardLogData:function(){var data={originalPrice:spApi.getExchangeRate(spApi.preferredCurrency,spApi.storageData('current-currency'),spApi.storageData('total-cart-amount'),'price'),originalCurrency:(spApi.storageData('current-currency')!=null)?spApi.storageData('current-currency'):'',convertedCurrency:spApi.preferredCurrency,convertedPrice:(spApi.storageData('total-cart-amount')!=null)?spApi.storageData('total-cart-amount'):'',sessionId:spApi.salesSesId};return data;},setSaLog:function(id,condition,sendLog){if(sendLog!==false&&window.spSalesOk==1)return;window.spSalesOk=1;var orderID=(spApi.getOrderId()!=undefined&&spApi.getOrderId()!=null&&spApi.getOrderId()!='')?spApi.getOrderId():'ins_unknown_'+Math.random().toString(36).substr(2,5)+'_'+spApi.getTime();var salesOrderId=sQuery.cookie("salesOrderId");if(salesOrderId!=null&&salesOrderId==orderID){return;}else{sQuery.cookie("salesOrderId",orderID,{path:'/',domain:cookieDomain});}
var cookies=spApi.allStorageData();var joinSalesEnable=false;var joinDate=false;var viewDate=false;var bSP=1333411200;var lastJoinDate=lastViewDate=bSP;var logObj=new Object();var lastCookieForCatch='';sQuery.each(cookies,function(i,obj){var cookieKey=obj.key;var value=unescape(obj.value);try{if(cookieKey.indexOf("sp-camp")!=-1){if(value.indexOf("joined")!=-1||value.indexOf("liked")==-1||value.indexOf("step1-displayed")!=-1){lastCookieForCatch=value;var logType='bounce-sales';var cookieContent=JSON.parse(value);if(value.indexOf("joined")!=-1||value.indexOf("liked")!=-1){logType='sales';joinSalesEnable=true;joinDate=typeof cookieContent.joDa!=='undefined'?cookieContent.joDa:bSP;}else if(joinSalesEnable){return;}else{viewDate=bSP;if(cookieContent!=null&&cookieContent.viDa!=='undefined'){viewDate=cookieContent.viDa;}}
if(joinSalesEnable&&joinDate>=lastJoinDate){lastJoinDate=joinDate;logObj=setLogVariable(cookieKey,cookieContent,logType);}else if(!joinSalesEnable&&viewDate>=lastViewDate){lastViewDate=viewDate;logObj=setLogVariable(cookieKey,cookieContent,logType);}}}}catch(err){spApi.errLog(err,{logType:'setSaLog',bugType:'product',extraData:{param1:lastCookieForCatch}});}});if(typeof spApi.setInsightSalesLog==='function'){spApi.setInsightSalesLog(orderID);}
function setLogVariable(cookie,cookieContent,logType){var logObj=new Object();id=cookie.split("-");if(id[2].indexOf("c")>=0){logObj.id=Number(id[2].replace("c",""));logObj.productType="custom";logObj.salesProductType=20;logObj.table='customLogs'}else{logObj.id=Number(id[2]);logObj.productType="other";logObj.salesProductType=logObj.productType;logObj.table='campLogs'}
logObj.type="";logObj.coupon=cookieContent.c;logObj.amount=spApi.storageData('total-cart-amount');logObj.products=spApi.storageData('paid-products');logObj.logType=logType;return logObj;}
if(sendLog===false)return logObj;try{sQuery.each(spApi.personalizationCamps,function(key,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varIdKey,variation){if(typeof variation=='undefined'){return;}
if(spApi.spCampCheckStatus(variation.varId,"step1-displayed")){var campaignStorage=spApi.getStorageValue('sp-camp-'+variation.varId);if(typeof spApi.getCamp(variation.varId).camp!=='undefined'&&typeof spApi.getCamp(variation.varId).camp.saLogDuration!=='undefined'){var campSaLogDuration=campaignStorage.salesLogDuration;}else{var campSaLogDuration=new Date().setHours(336);}
if(campSaLogDuration>spApi.getTime()*1000){var variationSalesProductType=spApi.getCamp(variation.varId).camp.productType=='20'?'custom':'other';var logParams={campId:variation.varId,referer:encodeURIComponent(logObj.amount),ref:window.document.referrer,url:window.document.URL,productType:variationSalesProductType,multivariateGroup:key,orderId:orderID,paidProducts:logObj.products,sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(variation.varId,'salesSesId',spApi.getCamp(variation.varId).camp.productType),salesSesTime:spApi.getCampSalesSesInfo(variation.varId,'salesSesTime',spApi.getCamp(variation.varId).camp.productType)+'-'+spApi.getTime(),appliedCode:spApi.getAppliedCode(variation.varId),salesType:'variation-sales',table:variationSalesProductType==='custom'?'customLogs':'campLogs'};logParams=sQuery.extend(logParams,spApi.getStandardLogData());spApi.worker.send('sales-log',logParams);}}});});}catch(e){spApi.errLog(e,{logType:'setLogVariable (variation-sales) ',bugType:'product'});spApi.conLog('personalizationCamps log error');spApi.conLog(e);}
if(id){var saleCampId=(logObj.productType=="custom")?('c'+logObj.id):(logObj.id);var campaignStorage=spApi.getStorageValue('sp-camp-'+saleCampId);if(typeof spApi.getCamp(saleCampId).camp!=='undefined'&&typeof spApi.getCamp(saleCampId).camp.saLogDuration!=='undefined'){var campSaLogDuration=campaignStorage.salesLogDuration;}else{var campSaLogDuration=new Date().setHours(336);}
if((logObj.logType!='sales'&&logObj.logType!='bounce-sales')||campSaLogDuration>spApi.getTime()*1000){var logParams={campId:logObj.id,referer:logObj.amount||'0',ref:window.document.referrer,url:window.document.URL,productType:logObj.productType,paidProducts:logObj.products,sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logObj.id,'salesSesId',logObj.salesProductType),salesSesTime:spApi.getCampSalesSesInfo(logObj.id,'salesSesTime',logObj.salesProductType)+'-'+spApi.getTime(),appliedCode:spApi.getAppliedCode(logObj.id),orderId:orderID,salesType:logObj.logType+logObj.type,table:logObj.table};logParams=sQuery.extend(logParams,spApi.getStandardLogData());this.worker.send('sales-log',logParams);}}
spApi.setESData();var logParams={type:'sa-co',orderId:orderID,paidProducts:(spApi.storageData('paid-products')!=null)?spApi.storageData('paid-products'):'',sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logObj.id,'salesSesId',logObj.salesProductType),salesSesTime:spApi.getCampSalesSesInfo(logObj.id,'salesSesTime',logObj.salesProductType)+'-'+spApi.getTime(),referer:spApi.storageData('total-cart-amount')||'0',ref:window.document.referrer,campId:0,table:'campLogs'};var paaGroup=spApi.storageData('paaGroup');if(['ins-roi-experiment-impression','ins-roi-control-impression'].indexOf(paaGroup)!==-1){logParams.paaRoiSalesLogType=paaGroup==='ins-roi-experiment-impression'?'ins-roi-experiment-sale':'ins-roi-control-sale';}
logParams=sQuery.extend(logParams,spApi.getStandardLogData());this.worker.send('do-logging',logParams);return logObj;},isMobileBrowser:function(){(function(a){sQuery.browser.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);if((/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||sQuery.browser.mobile)){if(typeof window.isMobileBrowser=='undefined'){spApi.consoleLog.push('API is steady for mobile devices.');window.isMobileBrowser=true;}
return true;}else{return false;}},isAndroid:function(){return navigator.userAgent.toLowerCase().indexOf('android')>-1;},getAndroidVersion:function(){var match=navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/);return match?match[1]:-1;},isMobileCamp:function(campaign){var status=false;if(typeof campaign!='undefined'){if(campaign.platform==='mobile'&&!spApi.deviceDetect('Tablet')){status=true;}else if(spApi.isMobileBrowser()){status=(campaign.productType=='30')?true:status;}}
return status;},isTabletCamp:function(campaign){return campaign.platform==='tablet';},isAllPagesCamp:function(campaign){return campaign.platform==='all';},showNotes:function(data,fromJoin,fromPurcha){},noteTimer:function(data){},gaSend:function(l,caller){try{if(this.gaServiceIsActive=='0'){return false;}
if(!l.campId==undefined){return false;}
l.campId=l.campId.toString();var campID=0;var campName='';var gaCamp={};var gaEvents={};var dataSending=false;var productType=0;var productAlias='';if(l.campId.indexOf('c')>-1||l.productType=='custom'){if(l.campId.indexOf('c')<0){l.campId='c'+l.campId}
var cCamps=this.customizationCamps;sQuery.each(cCamps,function(i,c){if(l.campId==c.id){campID=c.id;campName=spApi.decryptCampName(c.campName);gaCamp=c;productAlias='-'+(c.productAlias&&c.productAlias.toString().replace(/-/g,''));gaEvents=c.gaEvents||{};}});}
else{var cCamps=this.camps;sQuery.each(cCamps,function(i,c){if(l.campId==c.id){campID=c.id;campName=spApi.decryptCampName(c.campName);productType=c.productType;gaCamp=c;productAlias='-'+(c.productAlias&&c.productAlias.toString().replace(/-/g,''));gaEvents=c.gaEvents||{};}});}
var logType=l.logType||l.type||l.salesType;if(l.productType==='goalBuilder'&&logType==='join'){return false;}
var eventCategory='INSIDER';var eventAction=campName;var eventLabel='';var eventValue=0;if(this.gaNonInteraction=='1'){var nonInteraction=true;}
else{var nonInteraction=false;}
if(logType=='impression'||logType=='camp-step1'){if(gaEvents['impression']!='1'){return false;}
eventAction+='-impressions'+productAlias;dataSending=true;}
else if(logType=='camp-join'||logType=='join'||logType==='joined'){if(gaEvents['join']!='1'){return false;}
eventAction+='-joins'+productAlias;if(typeof l.extra!=="undefined"&&typeof l.extra.joinText!=="undefined"&&l.extra.joinText!==""){eventAction+=' - '+l.extra.joinText;}
dataSending=true;}
else if(logType=='closed'||logType=='camp-step1-close'){if(gaEvents['close']!='1'){return false;}
eventAction+='-close'+productAlias;dataSending=true;}
else if(logType=='variation-sales'){if(gaEvents["sales"]!='1'){return false;}
var orderId=this.getOrderId()||'NaN';var amount=spApi.storageData('total-cart-amount')||0;eventAction+='-sales';eventLabel=orderId;eventValue=amount;dataSending=true;}
else if(logType=='sales'||logType=='bounce-sales'){if(gaEvents["sales"]!='1'){return false;}
var orderId=this.getOrderId()||'NaN';var amount=spApi.storageData('total-cart-amount')||0;eventAction+='-sales';eventLabel=orderId;eventValue=amount;dataSending=true;}
else if(logType=='goal'){var goalKey="goal-"+l.goalId;if(gaEvents[goalKey]==undefined&&gaEvents[goalKey]!='1'){return false;}
var goalName=spApi.personalizationCamps[l.builderId]['goalBuilderList'][l.goalId]['goalName'];eventAction+='-'+goalName;dataSending=true;}
else if(logType=='sendAdAudience'){dataSending=true;}
else if(logType==='ccp'&&productType!=='39'){eventAction+=' - Action Id: '+l.actionId;eventLabel='(builder ID: '+spApi.getBuilderIdFromPersonalizations(campID)+')';dataSending=true;}
eventValue=String(eventValue).replace(',','.');eventValue=Math.round(eventValue)||0;if(this.gaIsActiveCustom=='1'){if(window._gaq){_gaq.push(['_setCustomVar',this.gaCustomVar,'Insider',campID,2]);}}
if(dataSending==false){if(this.gaIsActiveCustom=='1'){if(window._gaq){_gaq.push(['_trackEvent',eventCategory,eventAction,'customVarEvent',eventValue,nonInteraction]);}}
return false;}
if(eventLabel==''){var builderId=spApi.getBuilderIdFromVar(campID);if(builderId!==false){eventLabel='(builder ID: '+builderId+')';}}
var campaignRatio=spApi.getCampaignRatio(campID);if(campaignRatio!==false){eventLabel+=' - Variation Ratio: '+campaignRatio+'%';}
sQuery(document).trigger('ins:ga:event:sent',{hitType:'event',eventCategory:eventCategory,eventAction:eventAction,eventLabel:eventLabel,eventValue:eventValue,nonInteraction:nonInteraction});if(spApi.gaDataLayerIsActive=='1'){if(spApi.gaDataLayerSettings['eventName']==""){return false;}
if(spApi.gaDataLayerSettings['eventCategory']==""){return false;}
if(spApi.gaDataLayerSettings['eventAction']==""){return false;}
dataLayerObject={event:spApi.gaDataLayerSettings['eventName']};dataLayerObject[spApi.gaDataLayerSettings['eventCategory']]=eventCategory;dataLayerObject[spApi.gaDataLayerSettings['eventAction']]=eventAction;if(spApi.gaDataLayerSettings['eventLabel']!=""){dataLayerObject[spApi.gaDataLayerSettings['eventLabel']]=eventLabel;}
if(spApi.gaDataLayerSettings['eventValue']!=""){dataLayerObject[spApi.gaDataLayerSettings['eventValue']]=eventValue;}
window.dataLayer=window.dataLayer||[];dataLayer.push(dataLayerObject);spApi.logger('info','dataLayer ile analytics logu atld.',campID);return true;}
var sameTracking=false;try{if(window.ga&&window._gaq&&typeof ga.getAll!="undefined"&&typeof _gat!="undefined"&&ga.getAll()[0].get('trackingId')==_gat._getTrackerByName()._getAccount()){sameTracking=true;}}catch(e){}
function gaSender(tracker,gaType){if(typeof tracker!=='string'){return;}
gaType=gaType||'ga';var gaData={'hitType':'event','eventCategory':eventCategory,'eventAction':eventAction,'eventLabel':eventLabel,'eventValue':eventValue,'nonInteraction':nonInteraction};var sendDebugLogsFor=function(type,success){if(typeof success==='boolean'){var debugText=type+(success?' objesiyle analytics logu atld.':' is not defined, we did not push to ga.');spApi.logger('info',debugText,campID);}}
if(gaType==='ga'&&typeof window.ga!=='undefined'){sendDebugLogsFor(gaType,true);return window.ga(tracker,gaData);}
if(gaType==='gua'&&typeof window.gua!=='undefined'){sendDebugLogsFor(gaType,true);return window.gua(tracker,gaData);}
if(gaType==='UDM'&&typeof window.UDM!=='undefined'&&typeof window.UDM._universalMgaq==='function'){sendDebugLogsFor(gaType,true);return window.UDM._universalMgaq(['send','event',eventCategory,eventAction,eventLabel,{'nonInteraction':1}]);}
return sendDebugLogsFor(gaType,false);}
if(window.ga){gaSender('send');}
if(window._gaq&&sameTracking==false){spApi.logger('info','_gaq objesiyle analytics logu atld.',campID);_gaq.push(['_trackEvent',eventCategory,eventAction,eventLabel,eventValue,nonInteraction]);}}catch(err){spApi.errLog(err);}},customChannelsSend:function(l){try{if(typeof l.campId==='undefined'){return false;}
if(typeof l.data==='undefined'){var personalizationId=spApi.getPersonalizationId(l.campId);l.data=spApi.decryptCampName(spApi.personalizationCamps[personalizationId].name);}
var data=spApi.customChannelsTag[l.campId];var elem=sQuery('head');if(data.tagType=='Body')
elem=sQuery('body');elem.append(data.tagCode);spApi.logger('info','Custom Tag added successfully. campId: '+l.campId+' ['+l.data+']');return true;}catch(err){spApi.errLog(err,{logType:'customChannelsSend',bugType:'partner',extraData:{message:'Please check your custom tag in Custom Channels.'}});return false;}},getGAStyleSesId:function(){var id=sQuery.cookie('ins-gaSSId');try{spApi.logger('info','set gaStyleSession id ');var sessionInit=false;var expDate=new Date();expDate.setTime(expDate.getTime()+(30*60*1000));var cookieSettings={expires:expDate,path:'/',domain:cookieDomain};var isSessionExpired=!id;if(!isSessionExpired){var oldSession=/.+_(.*)/.exec(id);if(oldSession&&oldSession.length==2){isSessionExpired=(new Date(oldSession[1]*1000)).getUTCDate()!=(new Date()).getUTCDate();}}
if(isSessionExpired){spApi.logger('info','update gaStyleSession id !');sessionInit=true;function guid(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return s4()+s4()+'-'+s4()+'-'+s4()+'-'+s4()+'-'+s4()+s4()+s4();}
id=guid()+'_'+spApi.getTime();spApi.logInsight();}
if(typeof spApi.sessionInit==='undefined'){spApi.sessionInit=sessionInit;}
sQuery.cookie('ins-gaSSId',id,cookieSettings);}catch(err){spApi.errLog(err,{logType:'getGAStyleSesId',bugType:'partner'});}
return id;},logInsight:function(){try{var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;if(key.indexOf("ins-insight-")!=-1){var logData={key:sQuery.trim(key),obj:sQuery.toJSON(null)};spApi.updateCookie(logData,'nolog');}});}catch(err){spApi.errLog(err,{logType:'logInsight',bugType:'partner'});}},cartCatCount:function(_cat){try{if(!spApi.isOnCartPage())return;var success=false;var count=0;var products=spApi.getPaidProducts()||[];var prodCats=JSON.parse(spApi.storageData('prodCats'))||[];if(typeof products=="undefined"||typeof prodCats=="undefined"||products.length==0||prodCats.length==0)return count;sQuery.each(products,function(i,product){success=false;sQuery.each(prodCats,function(j,cat){if(sQuery.trim(decodeURIComponent(cat.name))==sQuery.trim(product.name)&&cat.cat.toLowerCase().indexOf(_cat.toLowerCase())!=-1){success=true;return false;}});if(success)count++;});return count;}catch(err){spApi.errLog(err,{logType:'cartCatCount',bugType:'partner',extraData:{param1:_cat}});}},events:{camp:null,checkEventDuplicate:function(callback,type){var check=false;if(typeof callback!="undefined"&&typeof this.camp!="undefined"){check=true;var eventCallbacks=this.camp.callbacks[type];sQuery.each(eventCallbacks,function(i,func){if(typeof func==='function'&&typeof callback==='function'&&func.toString()==callback.toString()){check=false;}});}
return check;},setCamp:function(campId){var _camp=null;sQuery.each(spApi.camps,function(key,camp){if(camp.id==campId){_camp=camp;}});return _camp;},show:function(callback){if(this.checkEventDuplicate(callback,'show'))
this.setCamp(this.camp.id).callbacks.show.push(callback);return this;},load:function(callback){if(this.checkEventDuplicate(callback,'load'))
this.setCamp(this.camp.id).callbacks.load.push(callback);return this;},liked:function(callback){if(this.checkEventDuplicate(callback,'liked'))
this.setCamp(this.camp.id).callbacks.liked.push(callback);return this;},close:function(callback){if(this.checkEventDuplicate(callback,'close'))
this.setCamp(this.camp.id).callbacks.close.push(callback);return this;},setPosition:function(options){if(typeof options!="undefined"&&typeof this.camp!="undefined")
this.setCamp(this.camp.id).position=options;return this;},setData:function(params){}},getCamp:function(campId){if(typeof this.sortCamp=="undefined"){this.sortCamp={};var me=this;sQuery.each(spApi.camps.concat(spApi.customizationCamps),function(key,camp){me.sortCamp[camp.id]=camp;});}
spApi.events.camp=this.sortCamp[campId];return spApi.events;},setApiInitConditions:function(){try{if(spApi.apiInitConfig.inited){spApi.logger('warning','setApiInitConditions method has already executed');return false;}
var singlePageDesktopActive=0;var singlePageMobileActive=0;var mobileApiDelay=0;var desktopApiDelay=0;spApi.apiInitConfig.inited=true;var apiInitConfig=function(){if(spApi.apiInitConfig.mobile instanceof Object&&spApi.isMobileBrowser()){return spApi.apiInitConfig.mobile;}else if(spApi.apiInitConfig.desktop instanceof Object&&!spApi.isMobileBrowser()){return spApi.apiInitConfig.desktop;}else if(spApi.apiInitConfig.conditions instanceof Array){return spApi.apiInitConfig;}else if(!spApi.apiInitConfig.mobile&&!spApi.apiInitConfig.desktop){return{conditions:[{listenUrlChange:true}]};}}();var InitConditionsManager=function(apiInitConfig){this.CHECK_TYPE_EXISTS='exists';this.CHECK_TYPE_NOT_EXISTS='not exists';this.CHECK_TYPE_REMOVED='removed';this.CHECK_TYPE_CONTAINS='contains';this.CHECK_TYPE_NOT_CONTAINS='not contains';this.CHECK_TYPE_IS='is';this.CHECK_TYPE_IS_NOT='is not';this.CHECK_TYPE_CLICK='click';this.CLICK_LISTENER_ELEMENT_CLASS='ins-init-condition-tracking';this.CLICK_CHECK_ELEMENT_CLASS='ins-init-condition-clicked';this.singlePageApiDelay=this.apiDelayByPlatform();this.referenceElement=sQuery(apiInitConfig.referenceElement||'body')[0]||document;this.lastUrl=location.href;this.urlChanged=false;this.conditions=apiInitConfig.conditions;this.clickListenerInited=false;return this;};InitConditionsManager.prototype.init=function(){if(this.conditions.length===0||!this.singlePageActive()){return;}
if(window.MutationObserver&&this.referenceElement){setTimeout(function(){var observer=new MutationObserver(this.mutationCallback.bind(this));observer.observe(this.referenceElement,{childList:true,subtree:true});}.bind(this),0);}else{this.referenceElement.addEventListener('DOMSubtreeModified',this.mutationCallback);}};InitConditionsManager.prototype.singlePageActive=function(){return(singlePageMobileActive&&spApi.isMobileBrowser())||(singlePageDesktopActive&&!spApi.isMobileBrowser());};InitConditionsManager.prototype.apiDelayByPlatform=function(){if(spApi.isMobileBrowser()){return mobileApiDelay;}
return desktopApiDelay;};InitConditionsManager.prototype.mutationCallback=spApi.debounce(function(){var initFlag=false;if(this.lastUrl!==location.href){this.lastUrl=location.href;this.urlChanged=true;}
if(this.conditions.length>0){sQuery.each(this.conditions,function(index,condition){condition.status=condition.status||{};if(condition.listenUrlChange&&!this.urlChanged){return;}
if(condition.url&&this.checkUrlCondition(condition.url)&&condition.element){condition.status.url=true;if(this.checkElementCondition(condition.element)){condition.status.element=true;this.reInitApi('Condition group is true:',condition);}
return false;}else if(condition.url&&this.urlChanged){initFlag=this.checkUrlCondition(condition.url);}else if(condition.element&&!condition.url){initFlag=this.checkElementCondition(condition.element);}else if(condition.listenUrlChange&&this.urlChanged){condition.status.urlChanged=true;initFlag=true;}
if(initFlag){if(condition.url){condition.status.url=true;}else if(condition.element){condition.status.element=true;}
this.reInitApi('Condition group is true:',condition);return false;}}.bind(this));}else if(this.urlChanged){this.reInitApi('Url has been changed');}},(apiInitConfig.mutationDelay||100));InitConditionsManager.prototype.reInitApi=function(log,condition){condition=condition||{};spApi.logger('info',log+':'+JSON.stringify(condition));this.urlChanged=false;spApi.debounce(spApi.reInitOnChange,condition.delay||this.singlePageApiDelay)();};InitConditionsManager.prototype.checkUrlCondition=function(condition){var initFlag=false;if(typeof condition==='string'){condition=[condition];}
var conditions=condition||[];sQuery.each(conditions,function(index,condition){if(typeof condition==='string'){initFlag=this.checkUrl(condition,this.CHECK_TYPE_CONTAINS);}else if(condition instanceof Object){initFlag=this.checkUrl(condition.keyword,condition.checkType||this.CHECK_TYPE_CONTAINS);}
if(!initFlag){return false;}}.bind(this));return initFlag;};InitConditionsManager.prototype.checkUrl=function(keyword,checkType){if(checkType===this.CHECK_TYPE_IS){return keyword===location.href;}else if(checkType===this.CHECK_TYPE_IS_NOT){return keyword!==location.href;}else if(checkType===this.CHECK_TYPE_CONTAINS){return location.href.indexOf(keyword)!==-1;}else if(checkType===this.CHECK_TYPE_NOT_CONTAINS){return location.href.indexOf(keyword)===-1;}
spApi.logger('warning','Unsupported checkType:'+checkType);return false;};InitConditionsManager.prototype.checkElementCondition=function(condition){if(typeof condition==='string'){condition=[{selector:condition,checkType:this.CHECK_TYPE_EXISTS}];}
var conditions=condition||[];sQuery.each(conditions,function(index,condition){if(typeof condition==='string'){condition={selector:condition,checkType:this.CHECK_TYPE_EXISTS};conditions[index]=condition;}
if(condition instanceof Object){if(this.checkElement(condition)){condition.status=true;}}}.bind(this));var conditionStatusCount=conditions.filter(function(condition){return condition.status;}).length;if(conditionStatusCount===conditions.length){conditions=conditions.map(function(condition){condition.status=false;});return true;}
return false;};InitConditionsManager.prototype.checkElement=function(condition){var checkType=condition.checkType||this.CHECK_TYPE_EXISTS;var selector=condition.selector;if(checkType===this.CHECK_TYPE_EXISTS){var encodedSelector=btoa(condition);var elementAttributeValue=sQuery(selector).attr('ins-init-condition')||'';if(sQuery(selector).exists()&&elementAttributeValue.indexOf(encodedSelector)===-1){sQuery(selector).attr('ins-init-condition',elementAttributeValue+'#'+encodedSelector);return true;}
return false;}else if(checkType===this.CHECK_TYPE_NOT_EXISTS){return!sQuery(selector).exists();}else if(checkType===this.CHECK_TYPE_CLICK){sQuery(selector).addClass(this.CLICK_LISTENER_ELEMENT_CLASS);this.listenClickEvents();if(sQuery(selector).hasClass(this.CLICK_CHECK_ELEMENT_CLASS)){sQuery(selector).removeClass(this.CLICK_CHECK_ELEMENT_CLASS);return true;}
return false;}else if(checkType===this.CHECK_TYPE_REMOVED){if(sQuery(selector).exists()){condition.showed=true;return false;}else if(condition.showed){condition.showed=false;return true;}
return false;}
spApi.logger('warning','Unsupported checkType:'+checkType);return false;};InitConditionsManager.prototype.listenClickEvents=function(){if(this.clickListenerInited===true){return;}
this.clickListenerInited=true;sQuery(document).on('clickedElement',function(event,element){if(!sQuery(element).hasClass(this.CLICK_LISTENER_ELEMENT_CLASS)){return;}
sQuery(element).addClass(this.CLICK_CHECK_ELEMENT_CLASS);this.mutationCallback();}.bind(this));};new InitConditionsManager(apiInitConfig).init();}catch(error){spApi.errLog(error,{logType:'setApiInitConditions',bugType:'product'});}},reInitOnChangeCallbacks:[],reInitOnChange:function(){try{sQuery(window).trigger('resetTimeOnSite');spApi.reInitOnChangeCallbacks.forEach(function(callback){callback()});if(sQuery.fancybox){var sliderCampList=[];var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;var value=unescape(obj.value);if(key.indexOf('sp-camp-')==-1)return;if(typeof spApi.notifies[key.match(/\d+/g)[0]]=="undefined")return;if(spApi.notifies[key.match(/\d+/g)[0]].category!="7")return;if(value.indexOf('hideSlider')!=-1)return;sliderCampList.push(key.match(/\d+/g)[0]);});spApi.isFirstVersus=false;sQuery.fancybox.close();sQuery('.sp-inner-notification').remove();sQuery('.sp-inline-wrap').remove();sQuery('.ins-preview-wrapper').remove();sQuery(window).unbind('scroll.insFrameless');sQuery(window).unbind('resize.insFrameless');clearInterval(spApi.cartInterval);sQuery.each(sliderCampList,function(key,campId){var campCookie=JSON.parse(spApi.storageData('sp-camp-'+campId));if(campCookie!=null){delete campCookie.hideSlider;spApi.storageData('sp-camp-'+campId,JSON.stringify(campCookie),{expires:14,path:'/',domain:cookieDomain});}});}
spApi.conLog('init');spApi.clearCustomCamps();spApi.clearElementLoadComplete();spApi.resetCampaignsSettings();spApi.personalizationSetStatus=false;spApi.sessionInit=undefined;spApi.activeBannerManagementCamps=[];spApi.showedCampaignList=[];spApi.hitSend=false;spApi.isWebPushInitialized=false;(spApi.cartAbandonmentEmail||{}).providerIndex=0;sQuery(document).trigger('resetInspector.insider');spApi.resetSystemRulesCallLimits();spApi.init(false);spApi.executedCallbacks=[];}catch(err){spApi.errLog(err,{logType:'reinitOnParameterChange',bugType:'partner',extraData:{paramer:location.href}});}},clearElementLoadComplete:function(){spApi.logger('info','ElementLoadComplete is clearing.');spApi.elementLoadCompleteConfig.mutableList.forEach(function(mutableObject){clearTimeout(mutableObject.notFoundCallbackTimeout);});if(typeof spApi.elementLoadCompleteConfig.disconnect==='function'){spApi.elementLoadCompleteConfig.disconnect();}
document.body.removeEventListener('DOMSubtreeModified',spApi.elementLoadCompleteConfig.mutationCallback);spApi.elementLoadCompleteConfig.mutableList=[];spApi.elementLoadCompleteConfig.inited=false;},resetCampaignsSettings:function(){spApi.logger('info','Campaigns are converting to valid.');spApi.camps.forEach(function(camp){camp.invalid=undefined;});},isTargetingReady:function(camp){var builderId=spApi.getBuilderIdFromVar(camp.id);return camp.isTest!=1||(camp.isTest==1&&builderId in spApi.getCampBuilderCandidates());},waitElementWithInterval:function(config){var elementWaitInterval=setInterval(function(){if(sQuery(config.selector).exists()){config.callback(sQuery(config.selector));clearInterval(elementWaitInterval);elementWaitInterval=false;}},100);setTimeout(function(){if(elementWaitInterval){spApi.logger('warning','Selector not found.'+config.selector);clearInterval(elementWaitInterval);if(typeof config.notFoundCallback==='function'){config.notFoundCallback();}}},config.timeout);},setSessionBasedSalesLogDurationEvent:function(){spApi.eventManager(document).on('click',spApi.debounce(function(){spApi.allStorageData().forEach(function(campaign){if(campaign.key.indexOf('sp-camp')>-1&&JSON.parse(campaign.value).isSessionBasedSalesLogDuration==='true'&&!spApi.isGoalConversionDurationExpired(campaign.key.split('-').pop())){var storageData=JSON.parse(campaign.value);var salesLogDuration=new Date();storageData.salesLogDuration=salesLogDuration.setMinutes(salesLogDuration.getMinutes()+30);spApi.storageData(campaign.key,JSON.stringify(storageData));}});},100))},getStorageValue:function(key){return spApi.storageData(key)?JSON.parse(spApi.storageData(key)):false;},isGoalConversionDurationExpired:function(variationId){var salesLogDuration=spApi.getStorageValue('sp-camp-'+variationId).salesLogDuration;return salesLogDuration<spApi.getTime()*1000;},customizationLog:function(){spApi.logger('warning','We removed this function from API, please remove this function from campaign.');},getPersonalizationCamp:function(){if(!spApi.personalizationSetStatus){spApi.personalizationSetStatus=true;}else{return;}
spApi.userSegments=spApi.storageData("user-segments")==null?{}:sQuery.parseJSON(spApi.storageData("user-segments"));var newSegmentList=new Object();sQuery.each(spApi.personalizationCamps,function(prsnlztnId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
if(spApi.userSegments[prsnlztnId]==undefined||typeof spApi.userSegments[prsnlztnId]=='undefined'){try{var isSegmentValid=true;var prsnlztnStatus=false;if(prsnlztn.segment!=undefined&&prsnlztn.segment!=null&&prsnlztn.segment.length>0){if(!spApi.e(spApi.rules[prsnlztn.segment[0]].test)){isSegmentValid=false;}else{delete spApi.userSegments[prsnlztnId];}}}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok1-'+prsnlztnId,bugType:'partner',extraData:{param1:JSON.stringify(prsnlztn)}});}
var totalRatio=0;var randomRatio=parseInt(Math.random()*100);var displayedVar=false;if(isSegmentValid){sQuery.each(prsnlztn.variations,function(key,variation){try{if(variation!=null&&variation.varId){if(!spApi.spCampCheckStatus(variation.varId,"step1-displayed")){oldRatio=Number(totalRatio);totalRatio+=Number(variation.ratio);if(!displayedVar&&oldRatio<=randomRatio&&randomRatio<totalRatio){spApi.userSegments[prsnlztnId]=variation.varId;newSegmentList[prsnlztnId]={id:variation.varId,ratio:"o:"+oldRatio+" r:"+randomRatio+" t:"+totalRatio+" var ratio:"+variation.ratio};return true;}}else{spApi.userSegments[prsnlztnId]=variation.varId;newSegmentList[prsnlztnId]={id:variation.varId,ratio:"already shown. var ratio:"+variation.ratio};return false;}}}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok2-'+prsnlztnId,bugType:'partner',extraData:{param1:JSON.stringify(variation)}});}});}}});try{var data={key:'user-segments',obj:spApi.userSegments};var tempSegment=JSON.stringify(spApi.userSegments);if(spApi.checkCampBuilderTest()){var variationCandidates=spApi.getCampBuilderCandidates();var testBuilderId=spApi.getObjectFirstKey(variationCandidates);if(spApi.userSegments[testBuilderId]&&data.obj[testBuilderId]){spApi.userSegments[testBuilderId]=data.obj[testBuilderId]=variationCandidates[testBuilderId];}}
if(spApi.checkCampTest()){data.obj=spApi.userSegments={};}
spApi.updateCookie(data,"nolog");}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok3',bugType:'partner',extraData:{param1:JSON.stringify(tempSegment)}});}},getPersonalizationId:function(id){var variationCampId;try{sQuery.each(spApi.personalizationCamps,function(campId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varKey,variation){if(variation.varId==id){variationCampId=campId;}});});return variationCampId;}catch(err){spApi.errLog(err,{logType:'getPersonalizationId',bugType:'partner',extraData:{param1:id}});}},isControlCamp:function(id){var cgStatus=false;sQuery.each(spApi.personalizationCamps,function(campId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varKey,variation){if(typeof prsnlztn=='undefined'){return;}
if(variation.varId==id&&variation.type=="cg"){cgStatus=true;}});});return cgStatus;},checkVarSegment:function(variation){var status=true;sQuery.each(spApi.personalizationCamps,function(prsnlztnId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(key,vari){if(typeof prsnlztn=='undefined'){return;}
if(vari&&vari.varId==variation['id']){if(spApi.userSegments[prsnlztnId]==variation['id']){status=true;return true;}else{status=false;return false;}}});});return status;},addGoalTracking:function(){},checkCampBuilderTest:function()
{if(!panelEdit){return(!spApi.hasParameter('insExitTestMode')&&(spApi.hasParameter('campBuilderTest')||document.referrer.indexOf("campBuilderTest")>-1||sQuery.cookie('variationCandidate')!=null))?true:false;}
return false;},getCampBuilderCandidates:function()
{try{var referrerUrl=decodeURIComponent(document.referrer);var vc=sQuery.cookie("variationCandidate");var segment=(vc=="undefined"||vc==null)?{}:sQuery.parseJSON(sQuery.cookie("variationCandidate"));if(spApi.checkCampBuilderTest()&&spApi.hasParameter('insBuild'))
segment=sQuery.parseJSON('{"'+spApi.Base64.decode(spApi.getParameter('insBuild'))+'":"'+spApi.Base64.decode(spApi.getParameter('insVar'))+'"}');else if(spApi.checkCampBuilderTest()&&referrerUrl.indexOf("insBuild")>-1)
segment=sQuery.parseJSON('{"'+spApi.Base64.decode(spApi.getParameterFromUrl(referrerUrl,'insBuild'))+'":"'+spApi.Base64.decode(spApi.getParameterFromUrl(referrerUrl,'insVar'))+'"}');return segment;}catch(err){spApi.errLog(err,{logType:'getCampBuilderCandidates',bugType:'product'});}},setCampBuilderTest:function()
{if(spApi.checkCampBuilderTest()){sQuery.cookie("variationCandidate",JSON.stringify(spApi.getCampBuilderCandidates()),{path:'/',domain:cookieDomain});}
spApi.showCampBuilderTestInfo()},getObjectFirstKey:function(obj)
{for(var i in obj)
return i;return 0;},getObjectValue:function(obj)
{return Object.keys(obj).map(function(e){return obj[e];})[0];},showCampBuilderTestInfo:function()
{if(spApi.checkCampBuilderTest()||spApi.checkCampTest()){try{var inspectorInterval=setInterval(function(){sQuery('#spWorker').pm(function(){return sQuery.cookie('testInfo');},function(info){if(info!=null){clearInterval(inspectorInterval);info=spApi.Base64.decode(info);spApi.showTestInfoHtml(info);}});},1000);}catch(err){spApi.errLog(err,{logType:'showCampBuilderTestInfo',bugType:'product'});}}},checkPersonalizationTestByVariation:function(builderID,variationID){var candidateCookie=sQuery.cookie('variationCandidate');var variationCandidate=candidateCookie===null?{}:JSON.parse(candidateCookie);var testBuilder=typeof variationCandidate[builderID]!=='undefined';var testVariation=testBuilder&&(variationCandidate[builderID]===variationID);return spApi.checkCampBuilderTest()&&testVariation;},showTestInfoHtml:function(info)
{var inspectorId='insInspectorJs';if(!sQuery('#'+inspectorId).exists()){var script=document.createElement('script');script.type='text/javascript';script.async='async';script.id=inspectorId;script.src='//api.useinsider.com/js/inspector/inspector.js?v=0.0.6';document.head.appendChild(script);}},checkCampTest:function()
{if(document.referrer.indexOf(".panel.")==-1){return(spApi.hasParameter('campTest')||document.referrer.indexOf("campTest")>-1||sQuery.cookie('campCandidate')!=null)?true:false;}
return false;},getCampCandidate:function()
{try{var camp=sQuery.cookie("campCandidate");if(spApi.checkCampTest()&&spApi.hasParameter('camp'))
camp=spApi.Base64.decode(spApi.getParameter('camp'));else if(spApi.checkCampTest()&&document.referrer.indexOf("camp")>-1)
camp=spApi.Base64.decode(spApi.getParameterFromUrl(document.referrer,'camp'));return camp;}catch(err){spApi.errLog(err,{logType:'getCampCandidate',bugType:'product'});}},setCampTest:function()
{if(spApi.checkCampTest()){sQuery.cookie("campCandidate",spApi.getCampCandidate(),{path:'/',domain:cookieDomain});spApi.showCampBuilderTestInfo();}},triggerInspectorObserver:function(campId){if(spApi.showedCampaignList instanceof Array===false){spApi.showedCampaignList=[];}
if(spApi.showedCampaignList.indexOf(spApi.Base64.encode(campId))===-1){spApi.showedCampaignList.push(spApi.Base64.encode(campId));}
sQuery(document).trigger('inspectorCampaignShowed.insider');},triggerInspectorLogs:function(data){if(spApi.showedCampaignLogs instanceof Array===false){spApi.showedCampaignLogs=[];}
var encodedLogData=spApi.Base64.encode(data);if(spApi.showedCampaignLogs.indexOf(encodedLogData)===-1){spApi.showedCampaignLogs.push(encodedLogData);}
sQuery(document).trigger('inspectorCampaignLog.insider');},isTestModeOnJourney:function(journeyId){var testBuilderId=spApi.getObjectFirstKey(spApi.getCampBuilderCandidates());return spApi.getJourneyCamp(journeyId).builderIds.indexOf(testBuilderId)>-1;},eventManager:function(elementTarget){var trigger=function(eventStackId,event){event.stopImmediatePropagation();spApi.eventStack[eventStackId].callback();};return{on:function(eventType,delegatedElement,callback,multipleListenerOption){if(!elementTarget){spApi.logger('Specify element to set event on');return false;}
var bubbleOption=false;if(arguments.length===3){bubbleOption=true;if(typeof delegatedElement==='function'){multipleListenerOption=callback;callback=delegatedElement;}}else if(arguments.length===2){callback=delegatedElement;delegatedElement='';}
if(typeof callback!=='function'){spApi.logger('Callback must be a function.');return false;}
var eventStackId=spApi.hashCode(callback.toString());spApi.eventStack[eventStackId]={id:eventStackId,type:eventType,element:delegatedElement,captureElement:elementTarget,callback:callback,listenerOption:multipleListenerOption};var setListenerOnAll=function(){sQuery(elementTarget).on(eventType,delegatedElement,function(event){trigger(eventStackId,event);});sQuery(delegatedElement).on(eventType,function(event){trigger(eventStackId,event);});};var setListenerOnHead=function(){sQuery(elementTarget).on(eventType,delegatedElement,function(event){trigger(eventStackId,event);});};var setListenerOnCurrentElement=function(){sQuery(elementTarget).on(eventType,function(event){trigger(eventStackId,event);});};if(multipleListenerOption){setListenerOnAll();}else if(bubbleOption){setListenerOnHead();}else{setListenerOnCurrentElement();}},triggerEvent:function(type,delegatedElement,manualEventCallback){for(var stackId in spApi.eventStack){if(spApi.eventStack.hasOwnProperty(stackId)){var currentEvent=spApi.eventStack[stackId];var specifiedElement=delegatedElement||'';if(currentEvent.type===type&&currentEvent.captureElement===elementTarget&&currentEvent.element===specifiedElement){currentEvent.callback();(manualEventCallback||function(){}).call();}}}},refresh:function(){for(var stackId in spApi.eventStack){if(spApi.eventStack.hasOwnProperty(stackId)){var currentEvent=spApi.eventStack[stackId];spApi.eventManager(currentEvent.captureElement).on(currentEvent.type,currentEvent.element,currentEvent.callback,currentEvent.listenerOption);}}
spApi.logger('All Events has been refreshed');}}},framelessHelper:function(){var stickyElementListener=function(campId){var locationConfig=spApi.notifies[campId].locationConfig;if(locationConfig.isSticky!=='true'){return;}
sQuery(document).off('scroll.framelessHelper'+campId).on('scroll.framelessHelper'+campId,function(){var $templateWrapper=sQuery('.ins-notification-content-'+campId);var staticTop=sQuery('.ins-preview-wrapper-'+campId).offset().top;if(sQuery(window).scrollTop()>staticTop){$templateWrapper.css({position:'fixed',top:parseInt(locationConfig.stickyOffset)||0,right:0,left:0,'z-index':'2147483647'});}else{$templateWrapper.css({position:'',top:'',right:'',left:'','z-index':''});}});}
return{stickyElementListener:stickyElementListener}},updateVisitedProducts:function(products){var storageProducts=spApi.getAllVisitedProducts();storageProducts[spApi.getLang()||'default']=products;spApi.storageData('insiderVersusData',JSON.stringify(sQuery.extend({},storageProducts)),{expires:100});},getVisitedProducts:function(){var products=(JSON.parse(spApi.storageData('insiderVersusData'))||[])[spApi.getLang()||'default']||[];products=products.filter(function(product){return product.id!==spApi.getCurrentProduct().id;});return products;},getAllVisitedProducts:function(){return JSON.parse(spApi.storageData('insiderVersusData'))||[];},appendProductToVisitedList:function(product){var products=spApi.deleteProductFromVisitedList(product.id);products.push(product);if(products.length>12){products.shift();}
spApi.updateVisitedProducts(products);},deleteProductFromVisitedList:function(productId){var products=spApi.getVisitedProducts();products=sQuery.grep(products,function(product){return product.id!=productId;});spApi.updateVisitedProducts(products);return products;},populateVersusWeb:function(){var product=spApi.getCurrentProduct();if(typeof product.id!=='undefined'&&product.id!=''&&typeof product.img!=='undefined'&&product.img!=''){spApi.appendProductToVisitedList(product);}},setESData:function(pagetype){if(document.referrer.indexOf(document.location.host)<0){spApi.sessionStorageSet('ins-session-source',document.referrer);}
Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),e=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=e.length;return function(n){if("object"!=typeof n&&("function"!=typeof n||null===n))throw new TypeError("Object.keys called on non-object");var c,l,p=[];for(c in n)t.call(n,c)&&p.push(c);if(r)for(l=0;o>l;l++)t.call(n,e[l])&&p.push(e[l]);return p}}());setPreviousCategory();var type="other";var stat;spApi.worker.ping(function(){sendHitApiRequests(function(requestResult){collectClientData(requestResult);});});function collectClientData(hitApiRequestsSent){try{var spUData={};spUData.spUID=spApi.storageData('spUID');if(spApi.isUserLoggedIn()){spUData.spPersonalData=sQuery.cookie('insUserData');spUData.member=true;}
if(typeof spApiUserData!="undefined"){if(JSON.stringify(spApiUserData)!=spApi.localStorageGet("spApiUserData")){spApi.localStorageSet("spApiUserData",JSON.stringify(spApiUserData));spUData.spApiUserData=spApiUserData;}}
if(hitApiRequestsSent===false){sendHitApiRequests();}}catch(err){spApi.errLog(err);}}
function sendHitApiRequests(callback){if(typeof spUData==='undefined'){var spUData={};var spUID=spApi.storageData('spUID');if(!spUID){if(typeof callback!=='undefined'){callback(false);}
return false;}
if(spApi.isUserLoggedIn()){spUData.spPersonalData=sQuery.cookie("insUserData");spUData.member=true;}
spUData.spUID=spUID;}
if(spApi.isOnAfterPaymentPage()||pagetype=="success"||spApi.isOnCartPage()){type=spApi.isOnCartPage()==true?"cart":"success";stat=new cartStat(type,spUData);var productIds=[];var socialProofPayload=sQuery.extend(true,{},stat);stat.p.forEach(function(product){productIds.push({id:product.id});});socialProofPayload.p=productIds;sQuery.ajax({url:'//socialproof.api.useinsider.com',data:{s:socialProofPayload,partnerName:"holodilnik",t:"setKksData",dataType:type},type:"post",dataType:"jsonp",async:true,success:function(){}});}else if(spApi.isOnCategoryPage()){setCategoryData(spApi.getCategories());type="category";stat=new othersStat(type,spUData);}else if(spApi.isOnProductPage()){setCategoryData(spApi.getProductCategories());type="productDetail";stat=new productDetailStat(type,spUData);}else if(spApi.isOnRegSuccessPage()){type="register";stat=new registerSuccessStat(type,spUData);spApi.sessionStorageRemoveItem("isRegSuccess");}else if(spApi.isOnMainPage()){type="main";stat=new mainPage(type,spUData);}else{stat=new othersStat(type,spUData);}
try{(function(){!function(e,t){return e.insiderTimeMe=t()}(this,function(){var e={startStopTimes:{},idleTimeoutMs:3e4,currentIdleTimeMs:0,checkStateRateMs:250,active:!1,idle:!1,currentPageName:"default-page-name",timeElapsedCallbacks:[],userLeftCallbacks:[],userReturnCallbacks:[],startTimer:function(t){if(t||(t=e.currentPageName),void 0===e.startStopTimes[t])e.startStopTimes[t]=[];else{var i=e.startStopTimes[t],n=i[i.length-1];if(void 0!==n&&void 0===n.stopTime)return}e.startStopTimes[t].push({startTime:new Date,stopTime:void 0}),e.active=!0},stopAllTimers:function(){for(var t=Object.keys(e.startStopTimes),i=0;i<t.length;i++)e.stopTimer(t[i])},stopTimer:function(t){t||(t=e.currentPageName);var i=e.startStopTimes[t];void 0!==i&&0!==i.length&&(void 0===i[i.length-1].stopTime&&(i[i.length-1].stopTime=new Date),e.active=!1)},getTimeOnCurrentPageInSeconds:function(){return e.getTimeOnPageInSeconds(e.currentPageName)},getTimeOnPageInSeconds:function(t){var i=e.getTimeOnPageInMilliseconds(t);return void 0===i?void 0:e.getTimeOnPageInMilliseconds(t)/1e3},getTimeOnPageInMilliseconds:function(t){var i=0,n=e.startStopTimes[t];if(void 0!==n){for(var a=0,r=0;r<n.length;r++){var s=n[r].startTime,o=n[r].stopTime;void 0===o&&(o=new Date);var d=o-s;a+=d}return i=Number(a)}},setIdleDurationInSeconds:function(t){var i=parseFloat(t);if(isNaN(i)!==!1)throw{name:"InvalidDurationException",message:"An invalid duration time ("+t+") was provided."};return e.idleTimeoutMs=1e3*t,this},setCurrentPageName:function(t){return e.currentPageName=t,this},resetIdleCountdown:function(){e.idle&&e.triggerUserHasReturned(),e.idle=!1,e.currentIdleTimeMs=0},triggerUserHasReturned:function(){if(!e.active)for(var t=0;t<this.userReturnCallbacks.length;t++){var i=this.userReturnCallbacks[t],n=i.numberOfTimesToInvoke;(isNaN(n)||void 0===n||n>0)&&(i.numberOfTimesToInvoke-=1,i.callback())}e.startTimer()},triggerUserHasLeftPage:function(){if(e.active)for(var t=0;t<this.userLeftCallbacks.length;t++){var i=this.userLeftCallbacks[t],n=i.numberOfTimesToInvoke;(isNaN(n)||void 0===n||n>0)&&(i.numberOfTimesToInvoke-=1,i.callback())}e.stopAllTimers()},checkState:function(){for(var t=0;t<e.timeElapsedCallbacks.length;t++)e.timeElapsedCallbacks[t].pending&&e.getTimeOnCurrentPageInSeconds()>e.timeElapsedCallbacks[t].timeInSeconds&&(e.timeElapsedCallbacks[t].callback(),e.timeElapsedCallbacks[t].pending=!1);e.idle===!1&&e.currentIdleTimeMs>e.idleTimeoutMs?(e.idle=!0,e.triggerUserHasLeftPage()):e.currentIdleTimeMs+=e.checkStateRateMs},visibilityChangeEventName:void 0,hiddenPropName:void 0,listenForVisibilityEvents:function(){"undefined"!=typeof document.hidden?(e.hiddenPropName="hidden",e.visibilityChangeEventName="visibilitychange"):"undefined"!=typeof document.mozHidden?(e.hiddenPropName="mozHidden",e.visibilityChangeEventName="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(e.hiddenPropName="msHidden",e.visibilityChangeEventName="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(e.hiddenPropName="webkitHidden",e.visibilityChangeEventName="webkitvisibilitychange"),document.addEventListener(e.visibilityChangeEventName,function(){document[e.hiddenPropName]?e.triggerUserHasLeftPage():e.triggerUserHasReturned()},!1),window.addEventListener("blur",function(){e.triggerUserHasLeftPage()}),window.addEventListener("focus",function(){e.triggerUserHasReturned()}),document.addEventListener("mousemove",function(){e.resetIdleCountdown()}),document.addEventListener("keyup",function(){e.resetIdleCountdown()}),document.addEventListener("touchstart",function(){e.resetIdleCountdown()}),window.addEventListener("scroll",function(){e.resetIdleCountdown()}),setInterval(function(){e.checkState()},e.checkStateRateMs)},initialize:function(t){var i=e.idleTimeoutMs||30,n=e.currentPageName||"default-page-name";t&&(i=t.idleTimeoutInSeconds||i,n=t.currentPageName||n),e.setIdleDurationInSeconds(i).setCurrentPageName(n).listenForVisibilityEvents(),e.startTimer()}};return e})}).call(this);(function(self){var hitApiUrl='https://hit.api.useinsider.com/hit';var unificationApiUrl='https://unification.useinsider.com/api/identity/v1/get';var recommendationApiUrl='mail-recommendation.api';var hitEvent={};self.construct=function(){insiderTimeMe.initialize({currentPageName:spApi.genDate,idleTimeoutInSeconds:300});hitEvent.version='1.0';hitEvent.partner_name=self.getPartnerName();self.sessionId=spApi.getGAStyleSesId();self.initSession=spApi.sessionInit===true;self.method='post';self.actionStoragePrefix='ins-lte-action-';self.requestHash=self.generateRequestHash(10);self.unifyUserFromReferrer();self.unifyUser(function(){self.sendRequest('pageView');self.sendRequest('user');self.sendLTEActions();self.sendTimeOnSiteRequest();});};self.unifyUserFromReferrer=function(){if(document.referrer.indexOf(recommendationApiUrl)>-1){var unifiedSpUID=spApi.getParameterFromUrl(document.referrer,'unifiedSpUID');if(unifiedSpUID.length>5&&unifiedSpUID!=='NA'){self.updateSpUID(unifiedSpUID);}}};self.unifyUser=function(callback){try{var unificationData=self.getUnificationData();var payload=JSON.stringify(unificationData);if(self.method!=='get'&&Object.keys(unificationData.identifiers).length>0&&self.hashedPayload()!==spApi.storageData('insUnificationUserDataHash')){var request={url:unificationApiUrl,async:true,crossDomain:true,type:self.method,contentType:'application/json',data:payload};if(request.type==='get'){request.data={data:spApi.Base64.encode(payload)};request.dataType='jsonp';function OK(){};request.jsonpCallback='OK';}
spApi.logger('info','Unification request event sent.');sQuery.ajax(request).success(function(userId){if(self.isUserIdValid(userId)){self.updateSpUID(userId);spApi.storageData('insUnificationUserDataHash',self.hashedPayload(),{expires:365});spApi.logger('info','The user is unified and the new userId is set as '+userId);spApi.unificationEventSucceed=true;loadPredictiveData(function(){if(typeof callback!=='undefined'){callback();}});}else if(typeof callback!=='undefined'){callback();}});}else{if(typeof callback!=='undefined'){callback();}}}catch(err){spApi.errLog(err,{logType:'Unification Api Request Error',bugType:'product',extraData:err});}};self.hashedPayload=function(){return spApi.hashCode(JSON.stringify(self.getUnificationData()));};self.getUnificationData=function(){var userData=self.getObjectUserData(self.getUserData());var identifiers=self.getCustomIdentifiers(userData.custom_identifiers);var unificationPayload={'partner':self.getPartnerName(),'insider_id':self.getUserId(),'identifiers':identifiers};if(spApi.validateEmail(userData.email)){unificationPayload.identifiers['em']=userData.email;}
if(userData.phone_number){unificationPayload.identifiers['pn']=userData.phone_number}
return unificationPayload;};self.getCustomIdentifiers=function(identifiers){identifiers=(identifiers||'').toString()==='[object Object]'?identifiers:{};return Object.keys(identifiers).reduce(function(accumulator,identifier){accumulator['c_'+identifier]=identifiers[identifier];return accumulator;},{});};self.isUserIdValid=function(userId){return typeof userId==='string'&&userId!=='';};self.getUserEmailHash=function(){try{var insiderObject=self.getUserData().insider_object;var insUserData=spApi.localStorageGet('insUserData')||sQuery.cookie('insUserData');if(insiderObject||insUserData){var email=(insiderObject||JSON.parse(insUserData)).email||'';if(spApi.validateEmail(email)){return spApi.Base64.encode(email);}}}catch(err){}
return false;};self.getUserData=function(){var userData={};userData['spApiUserData']=typeof window.spApiUserData!=='undefined'&&((typeof window.spApiUserData[0]!=='undefined'&&window.spApiUserData[0])||window.spApiUserData);userData['insider_object']=typeof insider_object!=='undefined'&&typeof insider_object.user!=='undefined'&&insider_object.user;return userData;};self.getObjectUserData=function(userData){return userData['insider_object']||userData['spApiUserData'];};self.sendWaitingTimeOnSiteRequest=function(){try{if(spApi.insiderTimeOnSiteInterval){var timeOnSiteData=JSON.parse(spApi.storageData('insiderTimeOnSiteData'));if(timeOnSiteData){timeOnSiteData.payload.time_on_site=spApi.timeOnSite;clearInterval(spApi.insiderTimeOnSiteInterval);spApi.insiderTimeOnSiteInterval=null;self.ajaxRequest(timeOnSiteData.payload);}
spApi.storageData('insiderTimeOnSiteData',null);spApi.timeOnSite=0;}}catch(err){spApi.errLog(err,{logType:'Hit API Request for ('+eventName+') event on a single page web application.',bugType:'product',extraData:err});}};self.sendTimeOnSiteRequest=function(){self.sendWaitingTimeOnSiteRequest();if(stat.pt!='productDetail'){return;}
var payload={};var eventName='timeOnSite';try{if(!spApi.insiderTimeOnSiteInterval){spApi.insiderTimeOnSiteInterval=setInterval(function(){spApi.timeOnSite=insiderTimeMe.getTimeOnCurrentPageInSeconds();},1000);}
payload=self.prepareRequestPayload(eventName);spApi.storageData('insiderTimeOnSiteData',{payload:payload});if(typeof spApi._bindedEvents.beforeunload==='undefined'){window.addEventListener('beforeunload',function(event){payload.time_on_site=insiderTimeMe.getTimeOnCurrentPageInSeconds();if(typeof event.target!=='undefined'&&typeof event.target.activeElement!=='undefined'&&typeof event.target.activeElement.nodeName!=='undefined'&&event.target.activeElement.nodeName.toLowerCase()==='body'){self.ajaxRequest(payload);return event.true;}else{spApi.storageData('previousPageTimeOnSitePayload',JSON.stringify(payload));}
spApi._bindedEvents.beforeunload=true;});}}catch(err){spApi.errLog(err,{logType:'Hit API Request for ('+eventName+') event',bugType:'product',extraData:err});}};self.timeOnSite=function(eventName){var payload={'user_id':self.getUserId(),'event':eventName,'init_session':self.initSession,'session_id':self.sessionId,'date':Math.round(Date.now()/1000),'referrer':stat.r,'source':spApi.sessionStorageGet('ins-session-source')||document.location.host,'current_url':stat.c,'page_type':stat.pt,'product':{'id':stat.p.id,'category':stat.p.category,'imgUrl':stat.p.img,'name':decodeURIComponent(stat.p.name),'url':stat.p.url}};self.setPayloadKeyword(payload);self.setPayloadLocation(payload);return payload;};self.setPayloadKeyword=function(payload){var searchQuery=spApi.getSearchKeyWords();if(typeof searchQuery==='string'&&searchQuery.length>0){payload.search_query=searchQuery;}};self.setPayloadLocation=function(payload){var userLocation=JSON.parse(spApi.storageData('userLocation'))||'';if(userLocation){if(userLocation.city){payload.city=userLocation.city;}
if(userLocation.country){payload.country=userLocation.country;}}};self.getUserId=function(){return spApi.storageData('spUID');};self.getPartnerName=function(){return'holodilnik';};self.sendRequest=function(eventName){try{var payload=self.prepareRequestPayload(eventName);if(self.isValidRequest(eventName,payload)){return self.ajaxRequest(payload);}
spApi.logger('info','Hit event '+eventName+' is already sent.');}catch(err){spApi.errLog(err,{logType:'Hit API Request for ('+eventName+') event',bugType:'product',extraData:err});}};self.isValidRequest=function(event,payload){var copiedPayload=sQuery.extend(true,{},payload);delete copiedPayload.date;var hashCodedIdentifier=spApi.hashCode(JSON.stringify(copiedPayload));if(copiedPayload.event==='pageView'){if(spApi.sentHitPayloads['pageView'][copiedPayload.page_type]!==hashCodedIdentifier){spApi.sentHitPayloads['pageView'][copiedPayload.page_type]=hashCodedIdentifier;return true}}else{if(spApi.sentHitPayloads[event]!==hashCodedIdentifier){spApi.sentHitPayloads[event]=hashCodedIdentifier;return true;}}
return false;};self.prepareRequestPayload=function(eventName){var payload=self[eventName](eventName);var mergePayloadWithHitEvent=sQuery.extend({},hitEvent,payload);return mergePayloadWithHitEvent;};self.checkPayload=function(payload){var requiredFields=['event','version','partner_name','user_id'];if(Object.keys(payload).length<=requiredFields.length)
return false;for(var i=0;i<requiredFields.length;i++){if(!spApi.isset(payload[requiredFields[i]])){return false;}}
return true;};self.ajaxRequest=function(payload){if(!self.checkPayload(payload))
return false;if(payload.event==='user'){var sendUserEvent=function(){sQuery('#spWorker').pm(function(data){return{id:sQuery.cookie('insdrSubsId'),date:sQuery.cookie('insdrSubsIdCreateDate')};},function(subscriptionData){var subsId=subscriptionData.id;var subsIdExists=(subsId!==null&&subsId.length>0);payload.contact=typeof payload.email==='string'||subsIdExists||typeof payload.email_hash==='string';if(subscriptionData.date===null&&subsIdExists){payload.webpush_token=subsId;payload.webpush_optin=true;payload.webpush_language=spApi.getLang();payload.device_type=spApi.isMobileBrowser()?'MOBILE BROWSER':'WEB BROWSER';}
if(!self.checkHashValues(payload)||self.isUnknownUser(payload)){return false;}
self.doRequest(payload);},payload);};if(spApi.workerFrame.ready){sendUserEvent();}else{sQuery(document).on('workerFrameReady',sendUserEvent);}}else{self.doRequest(payload);}};self.doRequest=function(payload){var request={url:hitApiUrl,async:true,crossDomain:true,type:self.method,data:spApi.Base64.encode(JSON.stringify(payload))};if(request.type==='get'){request.data={jsonp:true,data:spApi.Base64.encode(JSON.stringify(payload))};request.dataType='jsonp';function OK(){};request.jsonpCallback='OK';}
sQuery.ajax(request).success(function(){spApi.logger('info','Hit Api - event details: \n'+JSON.stringify(payload));});};self.pageView=function(eventName){var getProducts=function(){var products=[];stat.p.forEach(function(p){pData={'id':p.id,'category':p.category,'imgUrl':p.img,'name':decodeURIComponent(p.name),'url':p.url,'price':{'value':parseFloat(p.price)||0,'currency':spApi.preferredCurrency},'displayedPrice':{'value':parseFloat(p.notConvertedPrice)||parseFloat(p.price)||0,'currency':spApi.getCurrency()||spApi.preferredCurrency}};if(p.originalPrice&&!isNaN(parseFloat(p.originalPrice))){p.originalPrice=parseFloat(p.originalPrice);pData.price.originalValue=parseFloat(spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,p.originalPrice));pData.displayedPrice.originalValue=p.originalPrice;}
products.push(pData);});return products;};var payload={'user_id':self.getUserId(),'event':eventName,'init_session':self.initSession,'session_id':self.sessionId,'date':Math.round(Date.now()/1000),'referrer':stat.r,'source':spApi.sessionStorageGet('ins-session-source')||document.location.host,'current_url':stat.c,'cart_amount':stat.ca,'page_type':stat.pt,'language':spApi.getLang(),'previousPageTimeOnSite':JSON.parse(spApi.storageData('previousPageTimeOnSitePayload')),'locale':spApi.getLocale(),'request_hash':self.requestHash};spApi.storageData('previousPageTimeOnSitePayload',null);if(payload.page_type==='productDetail'){p=spApi.getCurrentProduct();payload.product={'id':p.id||"",'imgUrl':p.img,'category':p.cats,'name':decodeURIComponent(p.name),'url':p.url,'price':{'value':parseFloat(p.price)||0,'currency':spApi.preferredCurrency},'displayedPrice':{'value':parseFloat(p.notConvertedPrice)||parseFloat(p.price)||0,'currency':spApi.getCurrency()||spApi.preferredCurrency},'productAttributes':self.populateProductAttributes()};if(p.originalPrice&&!isNaN(parseFloat(p.originalPrice))){p.originalPrice=parseFloat(p.originalPrice);payload.product.price.originalValue=parseFloat(spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,p.originalPrice));payload.product.displayedPrice.originalValue=p.originalPrice;}
if(typeof stat.p.updateDate!=='undefined'&&!isNaN(stat.p.updateDate)){payload.product.updateDate=Math.floor(stat.p.updateDate/1000);}
if(typeof stat.p.startDate!=='undefined'&&!isNaN(stat.p.startDate)){payload.product.startDate=Math.floor(stat.p.startDate/1000);}
if(typeof stat.p.endDate!=='undefined'&&!isNaN(stat.p.endDate)){payload.product.endDate=Math.floor(stat.p.endDate/1000);}
if(typeof stat.p.parentItemId==='string'||typeof stat.p.parentItemId==='number'){payload.product.parentItemId=stat.p.parentItemId;}
if(Array.isArray(stat.p.variants)&&stat.p.variants.length>0){payload.product.variants=stat.p.variants;}
if(typeof stat.p.quantity!=='undefined'&&!isNaN(stat.p.quantity)){payload.product.quantity=stat.p.quantity;}
payload.product=self.getOptionalProductValues(payload.product,p);}else if(payload.page_type==='success'){payload.personalizations=[];Object.keys(localStorage).forEach(function(key){if(key.indexOf('sp-camp-')>-1){var campId=key.replace('sp-camp-','');if(spApi.spCampCheckStatus(campId,'joined')){payload.personalizations.push(spApi.getPersonalizationId(campId));}}});payload.products=getProducts();payload.order_id=spApi.getOrderId();}else if(payload.page_type==='cart'){payload.products=getProducts();}else if(payload.page_type==='category'){payload.category=spApi.getCategories();}
self.setPayloadKeyword(payload);self.setPayloadLocation(payload);if(payload.event==='pageView'&&payload.page_type==='productDetail'&&spApi.isPageTranslatedWithGoogleTranslate()){delete payload.product.name;delete payload.product.category;delete payload.product.productAttributes;}
return payload;};self.getOptionalProductValues=function(productPayload,product){var optionalKeys=['description','color','gtin','identifier_exists','brand'];optionalKeys.forEach(function(key){if(product.hasOwnProperty(key)){productPayload[key]=product[key];}});return productPayload;};self.user=function(eventName){var payload={'user_id':self.getUserId(),'event':eventName,'custom_attributes':{}};if(spApi.coeff.passed==true){payload.last_updated_l2p=new Date().toISOString();}
var emailHash=self.getUserEmailHash();if(emailHash){payload.email_hash=emailHash;}
payload=self.populateInsiderObject(payload);payload=self.populateCustomUserAttributes(payload);payload=self.filterPayload(payload);if(spApi.shouldInitializeWebPush()){spApi.getWebPushOfThePage();}
return payload;};self.sendLTEActions=function(){sQuery.each(spApi.engageActionList,function(actionId,action){self.processLTEActions(actionId,action);});};self.processLTEActions=function(actionId,action){var actionType=action.action_type;switch(actionType){case'Click':self.setClickActionEvent(action.settings.selector,actionId);break;case'Pageview':if(self.checkPageViewAction(action.settings)&&self.validateLTEStorageValue(actionId)){self.setStorageAndSendLTEEvent(self.getLTEPayload(actionId),actionId);}
break;}};self.checkPageViewAction=function(setting){var url=window.location.href;if((setting.condition==='contains'&&url.indexOf(setting.selector)>-1)||(setting.condition==='simple'&&url.indexOf(setting.selector)===0)||(setting.condition==='exact'&&url===setting.selector)){return true;}
return false;};self.setClickActionEvent=function(actionSelector,actionId){var eventName='click.lteAction'+actionId;sQuery(actionSelector).off(eventName).on(eventName,function(){if(self.validateLTEStorageValue(actionId)){self.setStorageAndSendLTEEvent(self.getLTEPayload(actionId),actionId);}});};self.getLTEPayload=function(actionId){return{version:'1.0',partner_name:'holodilnik',event:'ccp',event_type:'action_'+actionId,session_id:self.sessionId,user_id:self.getUserId(),date:spApi.getTime()}};self.setStorageAndSendLTEEvent=function(payload,actionId){spApi.storageData(self.actionStoragePrefix+actionId,self.sessionId,{domain:partner_site.host,expires:1,path:'/'});self.doRequest(payload);};self.validateLTEStorageValue=function(actionId){var storageValue=spApi.storageData(self.actionStoragePrefix+actionId);if(storageValue!==self.sessionId){return true;}
return false;};self.compareAttributeEquality=function(firstAttribute,secondAttribute){return firstAttribute.toString()===secondAttribute.toString();};self.populateCustomUserAttributes=function(payload){var listenerApiRequestBody={userId:self.getUserId(),partnerName:self.getPartnerName(),customAttributes:[]};var attributes=spApi.customUserAttributes||[];var storageCustomUserAttributesKey='insCustomAttributes';if(attributes.length===0)
return payload;var localCustomAttributes=JSON.parse(spApi.storageData(storageCustomUserAttributesKey))||{};attributes.forEach(function(attr){var attributeType=attr.attributeType.toLowerCase().toString();var attributeName=attr.attributeName.toLowerCase().toString();var newAttributeValue=spApi.e(attr.attributeJs);if((attributeType!=='url'&&typeof newAttributeValue!==attributeType)||(attributeType==='url'&&!(/^(http|https):\/\/[^ "]+$/.test(newAttributeValue)))){spApi.logger('warning','Wrong attribute type for "'+attributeName+'" in Custom User Attribute.');return false;}
payload.custom_attributes[attributeName]=localCustomAttributes[attributeName]=newAttributeValue;});spApi.storageData(storageCustomUserAttributesKey,localCustomAttributes,{expires:365});return payload;};self.insertLastBrowsedItems=function(payload){if(spApi.isOnProductPage()||spApi.isOnAfterPaymentPage()){var lastBrowsedItems=spApi.UCDBrowsedItems.collect();if(lastBrowsedItems){sQuery.extend(payload.custom_attributes,lastBrowsedItems);}}
return payload;};self.populateProductAttributes=function(){return spApi.productAttributes.reduce(function(productAttributes,attribute){var attributeJs=spApi.e(attribute.attributeJs);var attributeType=attribute.attributeType.toLowerCase();if((attributeType==='date'&&new Date(attributeJs).toString()!=='Invalid Date')||attributeType==='image'){attributeType='string';}
if(typeof attributeJs===attributeType){productAttributes[attribute.attributeName]=attributeJs;}
return productAttributes;},{});};self.populateInsiderObject=function(payload){var userData=self.getUserData();var objectUserData=self.getObjectUserData(userData);if(typeof objectUserData!=='object')
return payload;payload.name=objectUserData.name;payload.surname=objectUserData.surname;payload.age=objectUserData.age;payload.birthday=spApi.reformatDate(objectUserData.birthday);payload.email=objectUserData.email;payload.email_optin=objectUserData.email_optin;payload.email_sha256=objectUserData.email_sha256;payload.gdpr_optin=objectUserData.gdpr_optin;payload.gender=self.reformatGender(objectUserData.gender);payload.city=objectUserData.city;payload.language=objectUserData.language;payload.country=objectUserData.country;payload.phone_number=objectUserData.phone_number;payload.sms_optin=objectUserData.sms_optin;payload.customer_id=objectUserData.user_id;payload.username=objectUserData.username;payload.facebook_id=objectUserData.facebook_id;if(userData['spApiUserData']&&userData['insider_object']){payload.custom_attributes.spApiUserData=userData['spApiUserData'];}
return payload;};self.filterPayload=function(payload){var invalidValues=['undefined','unknown','null','object','array','empty','/>',''];var removeInvalidFields=function(key,value,isCustomAttribute){if((typeof value==='string'&&invalidValues.indexOf(value.toLowerCase())>-1)||value==null){spApi.logger('info','Hit Api - user event: "'+key+'" field is removed from payload since the value is "'+payload[key]+'".');if(!isCustomAttribute){delete payload[key];}else{delete payload.custom_attributes[key];}}
if(typeof key==='undefined'||key===null||(typeof key==='string'&&!sQuery.trim(key))){spApi.logger('info','Hit Api - user event: "'+key+'" field is removed from payload since the value is '+payload[key]+'.');if(!isCustomAttribute){delete payload[key];}else{delete payload.custom_attributes[key];}}};sQuery.each(payload,function(key,item){removeInvalidFields(key,item);});sQuery.each(payload.custom_attributes,function(key,item){removeInvalidFields(key,item,true);});if(Object.keys(payload.custom_attributes||{}).length===0){delete payload.custom_attributes;}
return payload;};self.checkHashValues=function(payload){var payloadHash=spApi.hashCode(JSON.stringify(payload));var insUserInfoHash=spApi.storageData('insUserInfoHash')!==null&&spApi.storageData('insUserInfoHash');if(payloadHash==insUserInfoHash)
return false;spApi.storageData('insUserInfoHash',payloadHash,{expires:365});return payload;};self.isUnknownUser=function(payload){return payload.contact===false&&Object.keys(payload.custom_attributes||{}).length===0;};self.updateSpUID=function(userId){if(!self.isUserIdValid(userId))return false;spApi.storageData('spUID',userId,{expires:spApi.getPrototype('uidExpireDate')});return true;};self.reformatGender=function(genderText){if(!genderText)
return'';var mappedText;genderText=genderText.toLowerCase();genderTextFirst=genderText.charAt(0);switch(genderTextFirst){case'm':mappedText='m';break;case'f':mappedText='f';break;case'k':mappedText='f';break;case'e':mappedText='m';break;default:mappedText=genderText;break;}
if(genderText=='bay'){mappedText='m';}else if(genderText=='bayan'){mappedText='f';}
return mappedText;};self.generateRequestHash=function(length){var random=function(){return Math.random().toString(36).substr(2)};return(Math.round(Date.now()/1000)).toString()+(random()+random()).substr(0,length);};if(spApi.hitSend===false){spApi.hitSend='inprogress';self.construct();spApi.hitSend=true;}})({});}catch(err){spApi.errLog(err,{logType:'Hit API Request',bugType:'product',extraData:{}});}
if(typeof callback!=='undefined'){callback(true);}}
function getGeneralStats(pageType,spUData){try{this.r=document.referrer;this.pt=pageType;this.c=window.location.href;if(pageType=="category"){this.ctg=spApi.getCategories();}
this.spu=spUData;var staticCartAmount=(spApi.storageData('total-cart-amount')==null)?0:spApi.storageData('total-cart-amount');this.ca=(spApi.isOnCartPage())?spApi.getTotalCartAmount():staticCartAmount;}catch(err){spApi.errLog(err);}}
function productDetailStat(pageType,spUData){try{getGeneralStats.call(this,pageType,spUData);var currentP=spApi.getCurrentProduct();this.p={"name":currentP.name,"category":currentP.cats,"img":currentP.img,"url":currentP.url,"b":"","id":(currentP.id||""),"rcm":"","pr":{"v":parseFloat(currentP.price),"c":spApi.preferredCurrency||"TRY"}};if(typeof currentP.quantity!=='undefined'){this.p.quantity=currentP.quantity;}
if(typeof currentP.updateDate!=='undefined'){this.p.updateDate=currentP.updateDate;}
if(typeof currentP.startDate!=='undefined'){this.p.startDate=currentP.startDate;}
if(typeof currentP.endDate!=='undefined'){this.p.endDate=currentP.endDate;}
if(typeof currentP.variants!=='undefined'){this.p.variants=currentP.variants;}
if(typeof currentP.parentItemId!=='undefined'){this.p.parentItemId=currentP.parentItemId;}}catch(err){spApi.errLog(err);}}
function cartStat(pageType,spUData){getGeneralStats.call(this,pageType,spUData);if(spApi.storageData('paid-products')==null){spApi.updateCartCookies();}
this.p=JSON.parse(spApi.storageData('paid-products')||'[]');}
function registerSuccessStat(pageType,spUData){getGeneralStats.call(this,pageType,spUData);}
function mainPage(pageType,spUData){getGeneralStats.call(this,pageType,spUData);}
function othersStat(pageType,spUData){getGeneralStats.call(this,pageType,spUData);}
function setCategoryData(categories){try{var allCats=[];if(spApi.sessionStorageGet('paCat')){allCats=JSON.parse(spApi.sessionStorageGet('paCat'));}
allCats.push(categories[0]);var jsonFormat=JSON.stringify(categories);var allCatsFormat=JSON.stringify(allCats);if(!spApi.sessionStorageGet('sFirstCat')){spApi.sessionStorageSet('sFirstCat',jsonFormat);}
spApi.sessionStorageSet('sLastCat',jsonFormat);spApi.sessionStorageSet('paCat',allCatsFormat);if(!localStorage.getItem('pFirstCat')){localStorage.setItem('pFirstCat',jsonFormat);}
localStorage.setItem('pLastCat',jsonFormat);localStorage.setItem('paCat',allCatsFormat);}
catch(e){spApi.errLog(e);}}
function setPreviousCategory(){if(!spApi.sessionStorageGet('psaCat')&&localStorage.getItem('paCat')&&!spApi.sessionStorageGet('psControl')){spApi.sessionStorageSet('psaCat',localStorage.getItem('paCat'));localStorage.removeItem('paCat');}
spApi.sessionStorageSet('psControl','1');}}};Object.setPrototypeOf=Object.setPrototypeOf||function(obj,proto){obj.__proto__=proto;return obj;};Object.setPrototypeOf(spApi,{uidExpireDate:365,eventStack:{},elementLoadCompleteConfig:{inited:false,autoExpireActivated:1,infinite:false,timeout:60*1000,mutableList:[]},apiInitConfig:{},allCamps:spApi.concat(spApi.concat(spApi.camps.concat(spApi.customizationCamps),spApi.webPushes),spApi.customSegments),currencyFormatRules:[],logTables:{"campLogs":"c","customLogs":"cu","mailRecommendationLogs":"mrl","customSegmentsLogs":"cs","goalBuilderLogs":"gb","insightLogs":"il","insightSalesLogs":"isl","webPushLogs":"w","webPushSalesLogs":"wps","journeyBuilderLogs":"jb","facebookMessengerLogs":"fb","facebookMessengerSalesLogs":"fbs"},systemRules:["categorySettings","getCartCount","getCategories","getCurrency","getCurrentProduct","getLang","getLocale","getOrderId","getPaidProducts","getProductCategories","getSearchKeyWords","getSearchs","getTotalCartAmount","isCouponCodeApplied","isOnAfterPaymentPage","isOnCartPage","isOnCategoryPage","isOnCouponPage","isOnMainPage","isOnProductPage","isOnRegSuccessPage","isUserLoggedIn","rsvpLocate","setEmailToCookie","sliderSettings","spAddToCart","triggerCartButton","useCouponButton"]});spApi.getPrototype=function(key){return spApi.__proto__[key];};spApi.objKeys=function(obj){return Object.keys(obj).length>0}
spApi.localStorageGet=function(storageName){try{return localStorage[storageName]||null;}catch(e){return null;}};spApi.localStorageSet=function(storageName,storeValue){try{return localStorage[storageName]=storeValue;}catch(e){return null;}};spApi.localStorageRemoveItem=function(storageName){try{return delete localStorage[storageName];}catch(e){return null;}};spApi.sessionStorageGet=function(storageName){try{return sessionStorage[storageName]||null;}catch(e){return null;}};spApi.sessionStorageSet=function(storageName,storeValue){try{return sessionStorage[storageName]=storeValue;}catch(e){return null;}};spApi.sessionStorageRemoveItem=function(storageName){try{return delete sessionStorage[storageName];}catch(e){return null;}};setEmailToCookie=function(name,value,expire,domain){if(spApi.validateEmail(value)){if(expire===undefined)
expire=365;if(domain===undefined)
domain=cookieDomain;sQuery.cookie(name,value,{expires:expire,path:'/',domain:domain});}};var setUserDataToCookie=(function(userData){if(userData==false||typeof(userData)=='undefined'){return false;}
var cookieName='insUserData';var save=function(createUserData){createUserData=JSON.stringify(createUserData);sQuery.cookie(cookieName,createUserData,{expires:360,path:'/',domain:cookieDomain});spApi.localStorageSet(cookieName,createUserData);}
var createUserData={};sQuery(userData.Login.button).live('click',function(){if(!spApi.validateEmail(sQuery(userData.Login.email).val()))return;if(sQuery.cookie(cookieName)!==null){var cookieContent=JSON.parse(sQuery.cookie(cookieName));createUserData=cookieContent;}
createUserData.email=sQuery(userData.Login.email).val();save(createUserData);});sQuery(userData.Register.button).live('click',function(){if(!spApi.validateEmail(sQuery(userData.Register.email).val())){return;}
createUserData.email=sQuery(userData.Register.email).val();createUserData.city=sQuery(userData.Register.city).val();createUserData.region=sQuery(userData.Register.region).val();createUserData.name=sQuery(userData.Register.name).val();save(createUserData);spApi.sessionStorageSet('isRegSuccess',1);});})(spApi.setEmailToCookie());spApi.timeOut=function(call,time){return setTimeout(function(){try{call();}catch(err){spApi.errLog(err,{logType:'setTimeout Error',bugType:'partner',extraData:{time:time,callback:call.toString()}});}},time);};spApi.interval=function(call,time){return setInterval(function(){try{call();}catch(err){spApi.errLog(err,{logType:'setInterval Error',bugType:'partner',extraData:{time:time,callback:call.toString()}});}},time);};spApi.ruleControl=function(rule,camp){try{rule.test=rule.test.replace(/setTimeout/g,'spApi.timeOut');rule.test=rule.test.replace(/setInterval/g,'spApi.interval');if(camp.isTest=="1"){var variationCandidates=spApi.getCampBuilderCandidates();var testBuilderId=spApi.getObjectFirstKey(variationCandidates);if(variationCandidates[testBuilderId]==camp.id||(camp.productType==="58"&&spApi.isTestModeOnJourney(spApi.getJourneyId(camp.id)))){return spApi.e(rule.test)===true;}
var testCampId=spApi.getCampCandidate();if(testCampId==camp.id){return spApi.e(rule.test)===true;}
return false;}else{return spApi.e(rule.test)===true;}}catch(err){var extraData={campaignName:spApi.decryptCampName(camp.campName),campaignId:camp.id};if(rule){extraData.ruleName=rule.name;extraData.ruleId=rule.id;extraData.ruleContent=rule.test}else{extraData.rule="undefined rule";}
spApi.errLog(err,{logType:'Rule Error',bugType:'partner',extraData:extraData});return false;}};spApi.campEventControl=function(eventName,callback){try{callback();}catch(err){spApi.errLog(err,{logType:'Campaign Event Error',bugType:'partner',extraData:{event:eventName,callback:callback.toString()}});}};spApi.isPageTranslatedWithGoogleTranslate=function(){var html=sQuery('html');return html.hasClass('translated-ltr')||html.hasClass('translated-rtl');};spApi.debugModeOpen=function(){if(spApi.debugMode){spApi.logger('info','Debug Mode Active');return true;}
spApi.debugMode=true;sQuery.cookie('spDebugMode',1,{expires:1,path:'/',domain:cookieDomain});spApi.logger('info','Debug Mode Active');};spApi.debugModeClose=function(){spApi.debugMode=false;sQuery.cookie('spDebugMode',null,{expires:1,path:'/',domain:cookieDomain});spApi.logger('info','Debug Mode Passive');};spApi.debugModeIsOpen=function(){return(spApi.debugMode||sQuery.cookie('spDebugMode')!==null)||false;};spApi.conLog=function(){if(spApi.debugModeIsOpen()&&typeof console.log!=='undefined'){console.log.apply(console,arguments);}};spApi.sentHitPayloads={pageView:{}};spApi.logger=function(type,message,campID){try{message=spApi.Base64.encode(message);if(typeof spApi.apiLogs==="undefined"){spApi.apiLogs={'camps':{},'general':[]};}
if(typeof campID!=="undefined"){if(typeof spApi.apiLogs.camps[campID]==="undefined"){spApi.apiLogs.camps[campID]=[];}
var logObject={'campID':campID,'type':type,'message':message,'time':new Date().getTime()};spApi.apiLogs.camps[campID].push(logObject)}
else{var logObject={'campID':campID,'type':type,'message':message,'time':new Date().getTime()};spApi.apiLogs.general.push(logObject)}
if(spApi.debugModeIsOpen()){if(type=='info'&&typeof console.info!=='undefined'){if(typeof campID==="undefined"){console.info(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.info(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}
else if(type=='warning'&&typeof console.warn!=='undefined'){if(typeof campID==="undefined"){console.warn(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.warn(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}
else if(type=='error'&&typeof console.error!=='undefined'){if(typeof campID==="undefined"){console.error(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.error(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}}}
catch(e){spApi.errLog(e);}
return true;};spApi.getLogs=function(campID){if(typeof spApi.apiLogs==="undefined"||spApi.apiLogs.length<1){return{};}
var logs={'camps':{},'general':[]};sQuery.each(spApi.apiLogs.camps,function(i,l){logs.camps[i]=[];sQuery.each(l,function(k,val){var logObject=sQuery.extend(true,{},val);logObject.message=spApi.Base64.decode(logObject.message);logs.camps[i].push(logObject);});});sQuery.each(spApi.apiLogs.general,function(i,val){var logObject=sQuery.extend(true,{},val);logObject.message=spApi.Base64.decode(logObject.message);logs.general.push(logObject);});if(typeof campID!=="undefined"){if(typeof spApi.apiLogs.camps[campID]!=="undefined"){return logs.camps[campID];}
return false;}
return logs;}
if(spApi.debugModeIsOpen()){spApi.logger('info','Debug Mode Active');}
spApi.setCampTest();spApi.setCampBuilderTest();spApi.kkbPluralForm=function(data){spApi.getCamp(data.campId).show(function(){var dailyView=Number(sQuery('.sp-inner-'+data.campId+' .dailyview').text());var pluralForm=function(n,form1,form2,form3){var n=(Math.sqrt(n*n))%100;var n1=n%10;if(n>10&&n<20)return form3;if(n1>1&&n1<5)return form2;if(n1==1)return form1;return form3;};var replaceText=pluralForm(dailyView,data.form1,data.form2,data.form3);var newContent=sQuery('.sp-inner-'+data.campId).html().replace(data.defaultForm+' ',replaceText+' ').replace(data.defaultForm+' ',replaceText+' ');sQuery('.sp-inner-'+data.campId).html(newContent);});};function processAnalyticsResult(data){if(data&&typeof data.count!="undefined")
{return data.count;}
return 0;}
sQuery.fn.extend({pm:function(pmFunction,success,data){return this.each(function(){if(sQuery(this).is('iframe')){pm({target:sQuery(this)[0].contentWindow,type:'sQueryPM',data:{data:JSON.stringify(data),callback:encodeURI(pmFunction)},success:function(data){if(Boolean(success)){try{success(data);}catch(err){spApi.errLog(err,{logType:'PM Success Error (from window)',bugType:'partner',extraData:{params:JSON.stringify(data)||"",callback:String(success)}});}}}});}});}});pm.bind('storeLog',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
spApi.storeLog(data.table,data.logData);});pm.bind('sQueryPM',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
var result=null;try{result=spApi.e('('+decodeURI(data.callback)+')('+data.data+')');}catch(err){spApi.errLog(err,{logType:'PM Error (from window)',bugType:'partner',extraData:{campId:data.campId,params:JSON.stringify(data.data)||"",callback:String(decodeURI(data.callback))}});}
return result;});spApi.localStorageRemoveItem('insUserData');sQuery.cookie('insUserData',null,{expires:-1,path:'/',domain:partner_site.host});sQuery.cookie('insUserData',null,{expires:-1,path:'/',domain:'.'+partner_site.host});pm.bind('set-cookie',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
spApi.updateCookie(data);});pm.bind('get-cookie',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
var c=sQuery.cookie(data.key)!=null?sQuery.cookie(data.key):spApi.storageData(data.key);if(c){c=JSON.parse(c);return{err:null,response:c};}else{return{err:true,response:false};}});pm.bind('campEventTrigger',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
if(typeof data.campId==="undefined"||typeof data.callbackType==="undefined"){return false;}
var camp=spApi.getCamp(data.campId).camp;sQuery.each(camp.callbacks[data.callbackType],function(key,callback){spApi.campEventControl(data.callbackType,callback);});});pm.bind("set-coupon-assistant",function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
spApi.setCouponAsistant(data.couponSet,data.fromPurcha);});pm.bind('startNoteTimer',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
return spApi.noteTimer(data);});pm.bind('gaSend',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
return spApi.gaSend(data);});if(typeof spApi.worker=="undefined"&&(spApi.optOutRequestExists()||!spApi.isOptOut())){function insCreateUID(){var idStrLen=32;var spUID=(Math.floor((Math.random()*25))+10);spUID+=(new Date()).getTime();do{spUID+=(Math.floor((Math.random()*15))).toString(36);if(spUID.length==23)
spUID+=".";}while(spUID.length<idStrLen);return spUID;}
var dimensionControl=false;WorkerFrame=function(){sQuery(document).on('userLocationSet',function(){spApi.worker.userIP('setUserIp',{userLocation:spApi.storageData('userLocation')});});spApi.workerFrame=this;};WorkerFrame.prototype.initializeUserId=function(){if(!spApi.storageData('spUID')){spApi.storageData('spUID',insCreateUID(),{expires:spApi.getPrototype('uidExpireDate')});}else{spApi.storageData('spUID',spApi.storageData('spUID'),{expires:spApi.getPrototype('uidExpireDate')});}};WorkerFrame.prototype.ping=function(callback){spApi.executedCallbacks=[];try{spApi.workerFrame=this;var intervalId=setInterval(function(){if(sQuery('#spWorker').length>0){pm({target:sQuery('#spWorker')[0].contentWindow,type:'are-you-ready',data:{no:"data",noLog:window.noLog},success:function(data){if(!dimensionControl){spApi.gaDimensionQ=data.dimensionResults;spApi.logger('info','Worker is ready');dimensionControl=true;}
this._window=sQuery('#spWorker')[0].contentWindow;spApi.workerFrame.ready=true;sQuery(document).trigger('workerFrameReady');spApi.salesSesId=spApi.Base64.encode(spApi.getGAStyleSesId());spApi.setCampSalesSesId();clearInterval(intervalId);if(callback&&spApi.executedCallbacks.indexOf(callback.toString())===-1){spApi.executedCallbacks.push(callback.toString());callback();}}.bind(this)});}}.bind(this),10);}catch(err){}};WorkerFrame.prototype.send=function(type,data,callback){spApi.workerFrame=this;if(this.ready){if(data.type=='joined'){spApi.gaSend(data);}
else{data.userID=spApi.storageData('spUID');var checkLogKey=true;if(typeof data.type==='undefined'||typeof data.campId==='undefined'||data.goalType==='productCategorySuccess'||data.goalType==='productSuccess'){checkLogKey=false;}
var timestamp=Math.floor(new Date().getTime()/1000);var logKey=data.type+'-'+timestamp+'-'+data.campId;if(typeof spApi.logsStack[logKey]==='undefined'||checkLogKey===false){spApi.logsStack[logKey]='1';if(data.table){spApi.storeLog(data.table,data);}
spApi.logger('info','Worker ile '+data.type+' logu atld.',data.campId);if(data.type=='impression'||data.type=='join'||data.type=='camp-step1'||data.salesType=='sales'||data.salesType=='bounce-sales'||data.salesType=='variation-sales'||data.type=='closed'||data.type=='camp-step1-close'){spApi.gaSend(data);}
spApi.triggerInspectorLogs(JSON.stringify(data));}}}else{setTimeout(function(){spApi.workerFrame.send(type,data,callback);},1000)}};WorkerFrame.prototype.asyncPM=function(type,data,callback){spApi.workerFrame=this;if(this.ready){pm({target:this._window,type:type,data:data,success:callback});}else{setTimeout(function(){spApi.workerFrame.asyncPM(type,data,callback);},500);}};WorkerFrame.prototype.asyncFunc=function(func){spApi.workerFrame=this;if(this.ready){func();}else{setTimeout(function(){func();},500);}};WorkerFrame.prototype.userIP=function(type,data,callback){spApi.workerFrame=this;if(this.ready){pm({target:this._window,type:type,data:data,success:function(data){}});}else{setTimeout(function(){spApi.workerFrame.userIP(type,data,callback);},1000)}}
WorkerFrame.prototype.sendCook=function(type,data,callback){spApi.workerFrame=this;if(this.ready){pm({target:this._window,type:type,data:data,success:function(data){}});}else{setTimeout(function(){spApi.workerFrame.send(type,data,callback);},1000)}};WorkerFrame.prototype.check=function(o,n,campId,callback){try{if(!campId)
return;else if(o==undefined&&n==undefined)
return;spApi.workerFrame=this;var logType=[];sQuery.each(n,function(key,value){if(value==true){if(o==undefined||(o&&!o[key])){if(key=='step1-displayed'){logType.push('camp-step1');}else if(key=='step1-closed'){logType.push('camp-step1-close');}else if(key=='closedCouponTimer'){logType.push('closedCouponTimer');}else if(key=='couponAppliedTimer'){logType.push('couponAppliedTimer');}else if(key=='closed'){}else{logType.push(key);}}}});sQuery.each(logType,function(key,value){spApi.workerFrame.send('do-logging',{type:value,campId:campId,table:n.table},callback);});}catch(err){}};WorkerFrame.prototype.cookie=function(capsule,callback){spApi.workerFrame=this;spApi.workerFrame.sendCook(capsule.dataC.type,{data:capsule.dataC.cookie,key:capsule.dataC.key});};spApi.worker=new WorkerFrame();spApi.worker.ping();spApi.loaded=true;}
if(spApi.isBrowserSupportEnabled()){function parseLocationData(data){}
function parseWeatherData(data){}
function parsePredictiveData(data){}
function parseCustomDataSet(data){}
window.insiderPermissionLogCallback=function(){};var isExternalServicesEnabled='1';var _flushPredictiveData=function(){var optionalSegmentList=["4f7e23125af862734df3851897a247bc"];var predictiveData=JSON.parse(spApi.storageData('predictiveData'));var newKeyExists=false;optionalSegmentList.forEach(function(segmentKey){if(typeof predictiveData[segmentKey]==='undefined'){newKeyExists=true;}});if(newKeyExists){return true;}
return false;};function loadUserLocation(){if(!isExternalServicesEnabled){return false;}
try{sQuery.ajax({url:'https://location.api.useinsider.com/?pId=10000309',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseLocationData",success:function(data){var geoData={geoId:'',city:'',country:'',cName:'',request:'',latitude:'',longitude:''};if(spApi.objKeys(data)){geoData.geoId=data.cityNameId;geoData.city=data.cityName;geoData.country=data.countryCode;geoData.cName=data.countrName;geoData.request=data.ip;geoData.latitude=data.latitude;geoData.longitude=data.longitude;spApi.storageData('userLocation',geoData,{expires:1});}else{spApi.storageData('userLocation',geoData,{expires:1});}
sQuery(document).trigger('userLocationSet');}});}catch(err){spApi.errLog(err);}}
function loadPredictiveData(callback){try{if(setPredictiveData&&(!spApi.storageData('predictiveData')||spApi.unificationEventSucceed||_flushPredictiveData())&&typeof window.predictiveSet==='undefined'&&isExternalServicesEnabled){window.predictiveSet=true;sQuery.ajax({url:'//segment.api.useinsider.com/v4/segments/'
+spApi.storageData('spUID')
+'?partnerid=10000309&jsonp=true&fields=4f7e23125af862734df3851897a247bc',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parsePredictiveData",success:function(data){var expireDate=1;if(typeof data['7150f35da56481f6c770e419137185f3']!=='undefined'){var date=new Date();expireDate=new Date(date.setTime(date.getTime()+data['7150f35da56481f6c770e419137185f3']));}
spApi.storageData('predictiveData',data,{expires:expireDate});if(typeof callback!=='undefined'){callback();}}});}}catch(err){spApi.errLog(err);}}
function getDataset(segmentList){var loopCounter=Math.floor(segmentList.length/30);var segmentListForDataList=[];for(var i=0;i<=loopCounter;i++){segmentListForDataList[i]=segmentList.slice(i*30,(i+1)*30);var callbackName='insParseCustomDataSet'+i;window[callbackName]=function(data){};sQuery.ajax({url:spApi.apiUrl+'customDataSegmentation.php',type:'POST',data:{segmentList:JSON.stringify(segmentListForDataList[i]),callback:callbackName,counter:i},dataType:'jsonp',async:spApi.isAjaxAsync,jsonpCallback:callbackName,success:function(dataset){if(dataset.success){sQuery.each(dataset.success,function(segmentName,result){sQuery.each(segmentListForDataList[dataset.counter],function(index,segment){if(segmentName===segment.sn){var key='customDataSet-'+segmentName;var data={status:result,cookie:segment.cv};localStorage.setItem(key,JSON.stringify(data));}});});}}});}}
function loadCustomDataSet(customDataset){try{var segmentList=[];sQuery.each(customDataset,function(index,rule){if(typeof rule!=='undefined'){var regex=/checkCustomDataset\(([^)]+)\)/g
var matches=[];var match=regex.exec(rule.test.replace(/[^()-_,\w\s]/gi,''));while(match!=null){matches.push(match[1]);match=regex.exec(rule.test.replace(/[^()-_,\w\s]/gi,''));}
sQuery.each(matches,function(index,ruleTest){var ruleMatch=ruleTest.split(',');if(typeof ruleMatch['1']!=='undefined'){var cookieKey=ruleMatch['0'];var segmentName=ruleMatch['1'].trim();if(typeof rule.isProcessed!=='undefined'&&rule.isProcessed){var cookieValue=sQuery.cookie(cookieKey);var key='customDataSet-'+segmentName;var customSet=JSON.parse(localStorage.getItem(key));if(!customSet||typeof customSet=='number'||(typeof customSet=='object'&&customSet.cookie!=cookieValue)){if(cookieValue){var data={cv:cookieValue,sn:segmentName};segmentList.push(data);}else{var data={status:0,cookie:cookieValue};localStorage.setItem(key,JSON.stringify(data));}}else if(!cookieValue&&customSet.status){var data={status:0,cookie:cookieValue};localStorage.setItem(key,JSON.stringify(data));}}}});}});if(segmentList.length){getDataset(segmentList);}}catch(err){spApi.errLog(err,{logType:'loadCustomDataSet',bugType:'product',extraData:{customDataset:customDataset}});}}
try{var now=new Date();var customDataset=[];var setPredictiveData=false;if(!spApi.isSiteUrlCheckFailed()){sQuery.each(spApi.rules,function(i,val){rule=spApi.rules[i];if(rule.test.indexOf("Predictive")>-1||rule.test.indexOf("BehavioralSegments")>-1||rule.test.indexOf("checkAdAudience")>-1||rule.test.indexOf("checkCrmAttributeData")>-1){var localStorageValue=JSON.parse(localStorage.getItem('predictiveData'));if(localStorageValue!==null&&typeof localStorageValue.expireDate!=='undefined'){if(localStorageValue.expireDate>(new Date()).getTime()){spApi.storageData('predictiveData',localStorageValue,{expires:(new Date(localStorageValue.expireDate))});}else{setPredictiveData=true;}}else{if(!spApi.storageData('predictiveData')||_flushPredictiveData()){setPredictiveData=true;}}}
if(rule.test.indexOf("CustomDataset")>-1){customDataset[rule.id]=rule;}});}
if(customDataset.length){loadCustomDataSet(customDataset);}
var userLocationData='';if(true){userLocationData=JSON.parse(spApi.storageData('userLocation'));if(!userLocationData){loadUserLocation();}}
var callDataFunctions=function(){loadPredictiveData();};if(true&&spApi.localStorageGet('insdrSV')==sQuery.cookie('insdrSV')){spApi.init();callDataFunctions();}else{spApi.logger('info','Partner storage mismatch, waiting for worker...');var insStorageInterval=setInterval(function(){if(spApi.worker.ready){pm({target:sQuery('#spWorker')[0].contentWindow,type:'storageData',data:{action:'read'},success:function(storageData){try{spApi.logger('info','Waiting for worker to making partner data syncronized');sQuery.each(storageData,function(property,value){spApi.localStorageSet(property,value);});spApi.localStorageSet('insdrSV',sQuery.cookie('insdrSV'));spApi.init();callDataFunctions();spApi.logger('info','API initialized');}catch(error){spApi.errLog(error);}}});clearInterval(insStorageInterval);}},100);}}catch(err){spApi.errLog(err);}
function setLocalStorage(storageName,storeValue){localStorage.setItem(storageName,JSON.stringify(storeValue));}
function getLocalStorage(storageName){try{return JSON.parse(localStorage.getItem(storageName))}catch(err){setLocalStorage(storageName,'');return[];}}
var isLocalStorageExist=function(storageName){var val=getLocalStorage(storageName);if(val!==null&&val!='\"\"'&&val!='')
return true;else
return false;}
function spGetTime(){return Math.round(new Date()/1000+3600);}
try{var uVDate=[];if(isLocalStorageExist('userDateV'))
uVDate=getLocalStorage('userDateV');if(uVDate.length==0||spGetTime()-uVDate[uVDate.length-1]>1800){uVDate.push(spGetTime());setLocalStorage('userDateV',uVDate);}
if(spApi.isOnAfterPaymentPage()){var userpaids=[];var paid={};if(spApi.storageData("paid-products")!=null&&spApi.storageData("paid-products").length>0){if(isLocalStorageExist('userpaids')){userpaids=getLocalStorage('userpaids');paid=sQuery.merge(JSON.parse(spApi.storageData("paid-products")),userpaids);}else{paid=JSON.parse(spApi.storageData("paid-products"));}
setLocalStorage('userpaids',paid);}}
if(spApi.isUserLoggedIn()){if(!isLocalStorageExist('loggedinUser'))
setLocalStorage('loggedinUser',1);}}catch(err){spApi.errLog(err);}}
else{spApi.consoleLog.push("Not supporting Internet Explorer 10 or below.");}}
spApi.loadScript('//api.useinsider.com/js/squery.min.js',insiderMain);(function(){var i=setInterval(function(){if(document.body){var workerFrame=document.createElement('iframe');workerFrame.style.display='none';workerFrame.id='spWorker';if(document.location.host.indexOf('aws-saaturbouat.singaporeair.com')>-1){workerFrame.src='https://aws-saaturbouat.singaporeair.com/assets/worker.html';}else{workerFrame.src='https://holodilnik.api.useinsider.com/worker.html';}
document.body.appendChild(workerFrame);clearInterval(i);}});setTimeout(function(){clearInterval(i)},5000);})();}else{var errorTwice="Warning : API is integrated more than once";(spApi.consoleLog==undefined)?spApi.consoleLog=[errorTwice]:spApi.consoleLog.push(errorTwice);}(function(){window.API_VERSION_holodilnik='v2.7.2';})();